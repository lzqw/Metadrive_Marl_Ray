{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.26666666666666666, "crash_rate_min": 0.26666666666666666, "crash_rate_max": 0.26666666666666666, "out_of_road_rate_mean": 0.26666666666666666, "out_of_road_rate_min": 0.26666666666666666, "out_of_road_rate_max": 0.26666666666666666, "max_step_rate_mean": 0.4666666666666667, "max_step_rate_min": 0.4666666666666667, "max_step_rate_max": 0.4666666666666667, "velocity_mean": 0.2219081278621617, "velocity_min": 0.2219081278621617, "velocity_max": 0.2219081278621617, "steering_mean": -0.0062101722308537935, "steering_min": -0.0062101722308537935, "steering_max": -0.0062101722308537935, "step_reward_mean": 0.013048714024531552, "step_reward_min": 0.013048714024531552, "step_reward_max": 0.013048714024531552, "acceleration_mean": 0.002432469541631058, "acceleration_min": 0.002432469541631058, "acceleration_max": 0.002432469541631058, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 765.6666666666666, "episode_length_min": 765.6666666666666, "episode_length_max": 765.6666666666666, "episode_reward_mean": 9.990965371449658, "episode_reward_min": 9.990965371449658, "episode_reward_max": 9.990965371449658, "num_neighbours_mean": 0.0, "num_neighbours_min": 0.0, "num_neighbours_max": 0.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 30.0, "num_active_agents_min": 30, "num_active_agents_max": 30, "environment_reward_total_mean": 299.72896114348976, "environment_reward_total_min": 299.72896114348976, "environment_reward_total_max": 299.72896114348976}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.2, "cur_lr": 0.00030000000000000003, "total_loss": 1.6639732400421052, "policy_loss": -0.011085579478078419, "vf_loss": 1.673315712010695, "vf_explained_var": -0.23745477769109938, "kl": 0.008715501128075023, "entropy": 2.864473351902432, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 225.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 2000, "num_env_steps_trained": 2000, "num_agent_steps_sampled": 46217, "num_agent_steps_trained": 46217}, "sampler_results": {"episode_reward_max": 139.83347340167586, "episode_reward_min": 139.83347340167586, "episode_reward_mean": 139.83347340167586, "episode_len_mean": 1900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -7.912237366697235}, "policy_reward_max": {"default": 14.569949605875324}, "policy_reward_mean": {"default": 4.661115780055867}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.26666666666666666, "crash_rate_min": 0.26666666666666666, "crash_rate_max": 0.26666666666666666, "out_of_road_rate_mean": 0.26666666666666666, "out_of_road_rate_min": 0.26666666666666666, "out_of_road_rate_max": 0.26666666666666666, "max_step_rate_mean": 0.4666666666666667, "max_step_rate_min": 0.4666666666666667, "max_step_rate_max": 0.4666666666666667, "velocity_mean": 0.2219081278621617, "velocity_min": 0.2219081278621617, "velocity_max": 0.2219081278621617, "steering_mean": -0.0062101722308537935, "steering_min": -0.0062101722308537935, "steering_max": -0.0062101722308537935, "step_reward_mean": 0.013048714024531552, "step_reward_min": 0.013048714024531552, "step_reward_max": 0.013048714024531552, "acceleration_mean": 0.002432469541631058, "acceleration_min": 0.002432469541631058, "acceleration_max": 0.002432469541631058, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 765.6666666666666, "episode_length_min": 765.6666666666666, "episode_length_max": 765.6666666666666, "episode_reward_mean": 9.990965371449658, "episode_reward_min": 9.990965371449658, "episode_reward_max": 9.990965371449658, "num_neighbours_mean": 0.0, "num_neighbours_min": 0.0, "num_neighbours_max": 0.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 30.0, "num_active_agents_min": 30, "num_active_agents_max": 30, "environment_reward_total_mean": 299.72896114348976, "environment_reward_total_min": 299.72896114348976, "environment_reward_total_max": 299.72896114348976}, "hist_stats": {"episode_reward": [139.83347340167586], "episode_lengths": [1900], "policy_default_reward": [13.8853432239571, 13.443010102751401, 12.0444251434711, 13.87115008790701, -6.239092003986695, -1.5291608396282754, -1.3428491120959567, 13.978102932330021, 4.122191766870392, 0.3892440227590317, 13.226427315808273, -3.4297304739415226, 12.887308365764275, -1.745863816116069, -6.079715306831688, -3.9151931619463705, 12.3119998287867, 11.990342187365538, 14.350919788456862, 14.569949605875324, -2.315286962671328, -3.4546484777068187, 12.540231162712889, -0.6126634782132321, -7.912237366697235, 13.299390155554036, -0.154823221922344, -2.6763836976123825, 11.070197205272569, -6.739111574596605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5295345024249962, "mean_inference_ms": 0.8778292080690002, "mean_action_processing_ms": 1.0626470965185741, "mean_env_wait_ms": 8.53867604695577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034093856811523438, "StateBufferConnector_ms": 0.0028848648071289062, "ViewRequirementAgentConnector_ms": 0.07319450378417969}}, "episode_reward_max": 139.83347340167586, "episode_reward_min": 139.83347340167586, "episode_reward_mean": 4.661115780055867, "episode_len_mean": 1900.0, "episodes_this_iter": 1, "policy_reward_min": {"default": -7.912237366697235}, "policy_reward_max": {"default": 14.569949605875324}, "policy_reward_mean": {"default": 4.661115780055867}, "hist_stats": {"episode_reward": [139.83347340167586], "episode_lengths": [1900], "policy_default_reward": [13.8853432239571, 13.443010102751401, 12.0444251434711, 13.87115008790701, -6.239092003986695, -1.5291608396282754, -1.3428491120959567, 13.978102932330021, 4.122191766870392, 0.3892440227590317, 13.226427315808273, -3.4297304739415226, 12.887308365764275, -1.745863816116069, -6.079715306831688, -3.9151931619463705, 12.3119998287867, 11.990342187365538, 14.350919788456862, 14.569949605875324, -2.315286962671328, -3.4546484777068187, 12.540231162712889, -0.6126634782132321, -7.912237366697235, 13.299390155554036, -0.154823221922344, -2.6763836976123825, 11.070197205272569, -6.739111574596605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5295345024249962, "mean_inference_ms": 0.8778292080690002, "mean_action_processing_ms": 1.0626470965185741, "mean_env_wait_ms": 8.53867604695577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034093856811523438, "StateBufferConnector_ms": 0.0028848648071289062, "ViewRequirementAgentConnector_ms": 0.07319450378417969}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46217, "num_agent_steps_trained": 46217, "num_env_steps_sampled": 2000, "num_env_steps_trained": 2000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 65.90115624735546, "num_env_steps_trained_throughput_per_sec": 65.90115624735546, "timesteps_total": 2000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 46217, "timers": {"training_iteration_time_ms": 30348.454, "sample_time_ms": 26804.577, "load_time_ms": 24.075, "load_throughput": 83073.62, "learn_time_ms": 3517.26, "learn_throughput": 568.624, "synch_weights_time_ms": 1.609}, "counters": {"num_env_steps_sampled": 2000, "num_env_steps_trained": 2000, "num_agent_steps_sampled": 46217, "num_agent_steps_trained": 46217}, "done": false, "episodes_total": 1, "training_iteration": 1, "trial_id": "42142_00000", "date": "2023-12-22_16-52-01", "timestamp": 1703235121, "time_this_iter_s": 30.351353883743286, "time_total_s": 30.351353883743286, "pid": 694832, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.52.38", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 20}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7fbcdca39940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 20, "vf_share_layers": -1, "old_value_loss": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 30.351353883743286, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 15.218181818181819, "ram_util_percent": 63.13863636363635}, "success": 0.0, "crash": 0.26666666666666666, "out": 0.26666666666666666, "max_step": 0.4666666666666667, "length": 1900.0, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 139.83347340167586}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.19215686274509802, "crash_rate_min": 0.11764705882352941, "crash_rate_max": 0.26666666666666666, "out_of_road_rate_mean": 0.3686274509803922, "out_of_road_rate_min": 0.26666666666666666, "out_of_road_rate_max": 0.47058823529411764, "max_step_rate_mean": 0.4392156862745098, "max_step_rate_min": 0.4117647058823529, "max_step_rate_max": 0.4666666666666667, "velocity_mean": 0.22262856762124267, "velocity_min": 0.2219081278621617, "velocity_max": 0.22334900738032365, "steering_mean": 0.005992702161934319, "steering_min": -0.0062101722308537935, "steering_max": 0.018195576554722433, "step_reward_mean": 0.01323354919627807, "step_reward_min": 0.013048714024531552, "step_reward_max": 0.013418384368024587, "acceleration_mean": 0.007709797029742829, "acceleration_min": 0.002432469541631058, "acceleration_max": 0.0129871245178546, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 724.2598039215686, "episode_length_min": 682.8529411764706, "episode_length_max": 765.6666666666666, "episode_reward_mean": 9.576874301495812, "episode_reward_min": 9.162783231541965, "episode_reward_max": 9.990965371449658, "num_neighbours_mean": 0.0, "num_neighbours_min": 0.0, "num_neighbours_max": 0.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 32.0, "num_active_agents_min": 30, "num_active_agents_max": 34, "environment_reward_total_mean": 305.63179550795826, "environment_reward_total_min": 299.72896114348976, "environment_reward_total_max": 311.5346298724268}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.2, "cur_lr": 0.00030000000000000003, "total_loss": 2.022468353405574, "policy_loss": -0.011922402705034514, "vf_loss": 2.0324468216743696, "vf_explained_var": 0.057182892788662, "kl": 0.00971972496834783, "entropy": 2.821378359098113, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 673.0, "diff_num_grad_updates_vs_sampler_policy": 222.0}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 91823, "num_agent_steps_trained": 91823}, "sampler_results": {"episode_reward_max": 139.83347340167586, "episode_reward_min": 111.66746851944454, "episode_reward_mean": 125.7504709605602, "episode_len_mean": 1847.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -8.099691577724132}, "policy_reward_max": {"default": 16.834226525161796}, "policy_reward_mean": {"default": 3.9297022175175176}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.19215686274509802, "crash_rate_min": 0.11764705882352941, "crash_rate_max": 0.26666666666666666, "out_of_road_rate_mean": 0.3686274509803922, "out_of_road_rate_min": 0.26666666666666666, "out_of_road_rate_max": 0.47058823529411764, "max_step_rate_mean": 0.4392156862745098, "max_step_rate_min": 0.4117647058823529, "max_step_rate_max": 0.4666666666666667, "velocity_mean": 0.22262856762124267, "velocity_min": 0.2219081278621617, "velocity_max": 0.22334900738032365, "steering_mean": 0.005992702161934319, "steering_min": -0.0062101722308537935, "steering_max": 0.018195576554722433, "step_reward_mean": 0.01323354919627807, "step_reward_min": 0.013048714024531552, "step_reward_max": 0.013418384368024587, "acceleration_mean": 0.007709797029742829, "acceleration_min": 0.002432469541631058, "acceleration_max": 0.0129871245178546, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 724.2598039215686, "episode_length_min": 682.8529411764706, "episode_length_max": 765.6666666666666, "episode_reward_mean": 9.576874301495812, "episode_reward_min": 9.162783231541965, "episode_reward_max": 9.990965371449658, "num_neighbours_mean": 0.0, "num_neighbours_min": 0.0, "num_neighbours_max": 0.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 32.0, "num_active_agents_min": 30, "num_active_agents_max": 34, "environment_reward_total_mean": 305.63179550795826, "environment_reward_total_min": 299.72896114348976, "environment_reward_total_max": 311.5346298724268}, "hist_stats": {"episode_reward": [139.83347340167586, 111.66746851944454], "episode_lengths": [1900, 1794], "policy_default_reward": [13.8853432239571, 13.443010102751401, 12.0444251434711, 13.87115008790701, -6.239092003986695, -1.5291608396282754, -1.3428491120959567, 13.978102932330021, 4.122191766870392, 0.3892440227590317, 13.226427315808273, -3.4297304739415226, 12.887308365764275, -1.745863816116069, -6.079715306831688, -3.9151931619463705, 12.3119998287867, 11.990342187365538, 14.350919788456862, 14.569949605875324, -2.315286962671328, -3.4546484777068187, 12.540231162712889, -0.6126634782132321, -7.912237366697235, 13.299390155554036, -0.154823221922344, -2.6763836976123825, 11.070197205272569, -6.739111574596605, -6.973101456181786, -2.9084640212252966, 15.440580448161995, 12.460916944598816, 1.0822942875280592, 16.161516068557393, -3.841152934323061, -4.963461438821214, 13.463298525452455, -4.4532269670335465, 16.834226525161796, -3.3815353795869196, 11.760239210993435, 13.767531143885313, 13.5818829696895, -1.2126163513632129, -7.723353326495063, 12.96326456963325, 13.06525508916064, -8.099691577724132, 12.51275692410698, -2.6908564303919835, 13.39747526406995, -2.6802429662182004, -4.195466564392027, -7.192590536605059, 9.910771272479218, -6.395701690296256, -1.7586447176080888, 12.981104621956776, -2.344115430783785, 2.5615206272698643, -4.930619753095746, -4.5323244311149296]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5707305226531676, "mean_inference_ms": 0.8876579077009998, "mean_action_processing_ms": 1.104569677501894, "mean_env_wait_ms": 8.681105131177583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033736228942871094, "StateBufferConnector_ms": 0.0028967857360839844, "ViewRequirementAgentConnector_ms": 0.07348060607910156}}, "episode_reward_max": 139.83347340167586, "episode_reward_min": 111.66746851944454, "episode_reward_mean": 3.9297022175175176, "episode_len_mean": 1847.0, "episodes_this_iter": 1, "policy_reward_min": {"default": -8.099691577724132}, "policy_reward_max": {"default": 16.834226525161796}, "policy_reward_mean": {"default": 3.9297022175175176}, "hist_stats": {"episode_reward": [139.83347340167586, 111.66746851944454], "episode_lengths": [1900, 1794], "policy_default_reward": [13.8853432239571, 13.443010102751401, 12.0444251434711, 13.87115008790701, -6.239092003986695, -1.5291608396282754, -1.3428491120959567, 13.978102932330021, 4.122191766870392, 0.3892440227590317, 13.226427315808273, -3.4297304739415226, 12.887308365764275, -1.745863816116069, -6.079715306831688, -3.9151931619463705, 12.3119998287867, 11.990342187365538, 14.350919788456862, 14.569949605875324, -2.315286962671328, -3.4546484777068187, 12.540231162712889, -0.6126634782132321, -7.912237366697235, 13.299390155554036, -0.154823221922344, -2.6763836976123825, 11.070197205272569, -6.739111574596605, -6.973101456181786, -2.9084640212252966, 15.440580448161995, 12.460916944598816, 1.0822942875280592, 16.161516068557393, -3.841152934323061, -4.963461438821214, 13.463298525452455, -4.4532269670335465, 16.834226525161796, -3.3815353795869196, 11.760239210993435, 13.767531143885313, 13.5818829696895, -1.2126163513632129, -7.723353326495063, 12.96326456963325, 13.06525508916064, -8.099691577724132, 12.51275692410698, -2.6908564303919835, 13.39747526406995, -2.6802429662182004, -4.195466564392027, -7.192590536605059, 9.910771272479218, -6.395701690296256, -1.7586447176080888, 12.981104621956776, -2.344115430783785, 2.5615206272698643, -4.930619753095746, -4.5323244311149296]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5707305226531676, "mean_inference_ms": 0.8876579077009998, "mean_action_processing_ms": 1.104569677501894, "mean_env_wait_ms": 8.681105131177583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033736228942871094, "StateBufferConnector_ms": 0.0028967857360839844, "ViewRequirementAgentConnector_ms": 0.07348060607910156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91823, "num_agent_steps_trained": 91823, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 62.96396577761681, "num_env_steps_trained_throughput_per_sec": 62.96396577761681, "timesteps_total": 4000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 91823, "timers": {"training_iteration_time_ms": 31056.317, "sample_time_ms": 27764.071, "load_time_ms": 27.255, "load_throughput": 73382.158, "learn_time_ms": 3262.661, "learn_throughput": 612.997, "synch_weights_time_ms": 1.517}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 91823, "num_agent_steps_trained": 91823}, "done": false, "episodes_total": 2, "training_iteration": 2, "trial_id": "42142_00000", "date": "2023-12-22_16-52-32", "timestamp": 1703235152, "time_this_iter_s": 31.767252445220947, "time_total_s": 62.11860632896423, "pid": 694832, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.52.38", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 20}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7fbcdca39940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 20, "vf_share_layers": -1, "old_value_loss": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 62.11860632896423, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 15.771111111111109, "ram_util_percent": 64.67999999999999}, "success": 0.0, "crash": 0.19215686274509802, "out": 0.3686274509803922, "max_step": 0.4392156862745098, "length": 1847.0, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 125.7504709605602}
