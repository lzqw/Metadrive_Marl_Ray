{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.12121212121212122, "crash_rate_min": 0.12121212121212122, "crash_rate_max": 0.12121212121212122, "out_of_road_rate_mean": 0.3939393939393939, "out_of_road_rate_min": 0.3939393939393939, "out_of_road_rate_max": 0.3939393939393939, "max_step_rate_mean": 0.48484848484848486, "max_step_rate_min": 0.48484848484848486, "max_step_rate_max": 0.48484848484848486, "velocity_mean": 0.21965073380517022, "velocity_min": 0.21965073380517022, "velocity_max": 0.21965073380517022, "steering_mean": -0.009157224844549661, "steering_min": -0.009157224844549661, "steering_max": -0.009157224844549661, "step_reward_mean": 0.012835163103435522, "step_reward_min": 0.012835163103435522, "step_reward_max": 0.012835163103435522, "acceleration_mean": 0.00039165430103054144, "acceleration_min": 0.00039165430103054144, "acceleration_max": 0.00039165430103054144, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 754.6060606060606, "episode_length_min": 754.6060606060606, "episode_length_max": 754.6060606060606, "episode_reward_mean": 9.685491866719738, "episode_reward_min": 9.685491866719738, "episode_reward_max": 9.685491866719738, "num_neighbours_mean": 0.0, "num_neighbours_min": 0.0, "num_neighbours_max": 0.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 33.0, "num_active_agents_min": 33, "num_active_agents_max": 33, "environment_reward_total_mean": 319.6212316017514, "environment_reward_total_min": 319.6212316017514, "environment_reward_total_max": 319.6212316017514}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.2, "cur_lr": 0.00030000000000000003, "total_loss": 1.9695887091729336, "policy_loss": -0.011172028145817824, "vf_loss": 1.9788406457795307, "vf_explained_var": -0.11541490568671116, "kl": 0.00960044578383785, "entropy": 2.8508907434552215, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 215.5, "diff_num_grad_updates_vs_sampler_policy": 214.5}}, "num_env_steps_sampled": 2000, "num_env_steps_trained": 2000, "num_agent_steps_sampled": 44359, "num_agent_steps_trained": 44359}, "sampler_results": {"episode_reward_max": 149.88342105401364, "episode_reward_min": 149.88342105401364, "episode_reward_mean": 149.88342105401364, "episode_len_mean": 1975.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -6.943935110184791}, "policy_reward_max": {"default": 15.858041769960934}, "policy_reward_mean": {"default": 4.541921850121623}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.12121212121212122, "crash_rate_min": 0.12121212121212122, "crash_rate_max": 0.12121212121212122, "out_of_road_rate_mean": 0.3939393939393939, "out_of_road_rate_min": 0.3939393939393939, "out_of_road_rate_max": 0.3939393939393939, "max_step_rate_mean": 0.48484848484848486, "max_step_rate_min": 0.48484848484848486, "max_step_rate_max": 0.48484848484848486, "velocity_mean": 0.21965073380517022, "velocity_min": 0.21965073380517022, "velocity_max": 0.21965073380517022, "steering_mean": -0.009157224844549661, "steering_min": -0.009157224844549661, "steering_max": -0.009157224844549661, "step_reward_mean": 0.012835163103435522, "step_reward_min": 0.012835163103435522, "step_reward_max": 0.012835163103435522, "acceleration_mean": 0.00039165430103054144, "acceleration_min": 0.00039165430103054144, "acceleration_max": 0.00039165430103054144, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 754.6060606060606, "episode_length_min": 754.6060606060606, "episode_length_max": 754.6060606060606, "episode_reward_mean": 9.685491866719738, "episode_reward_min": 9.685491866719738, "episode_reward_max": 9.685491866719738, "num_neighbours_mean": 0.0, "num_neighbours_min": 0.0, "num_neighbours_max": 0.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 33.0, "num_active_agents_min": 33, "num_active_agents_max": 33, "environment_reward_total_mean": 319.6212316017514, "environment_reward_total_min": 319.6212316017514, "environment_reward_total_max": 319.6212316017514}, "hist_stats": {"episode_reward": [149.88342105401364], "episode_lengths": [1975], "policy_default_reward": [11.651592769340585, -6.857996200066463, 14.900941712133656, 13.769353212013451, -4.637471272258472, 10.933635535412098, 12.228814431294492, -6.086479325908675, -4.435589820725175, -5.263653178373862, 14.781221464891933, 11.422297268865583, -3.723272693128483, -6.943935110184791, -1.2052233801619838, -4.354639995092981, 11.083522525924627, 10.497519182949498, 2.2432689784795663, -1.7687587496725463, -6.16207866471958, 11.139927335126012, 12.907906919222153, 15.858041769960934, 3.1879800054272653, -5.720059433850749, 2.401712993933433, 13.375088780684571, -1.44736691178713, 13.92602854904398, 13.492484429329092, -4.810232321890445, 13.498840247801942]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.492934807963755, "mean_inference_ms": 0.905528299692927, "mean_action_processing_ms": 1.0903698989357251, "mean_env_wait_ms": 8.533183840856976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005817413330078125, "StateBufferConnector_ms": 0.0035762786865234375, "ViewRequirementAgentConnector_ms": 0.09391307830810547}}, "episode_reward_max": 149.88342105401364, "episode_reward_min": 149.88342105401364, "episode_reward_mean": 4.541921850121623, "episode_len_mean": 1975.0, "episodes_this_iter": 1, "policy_reward_min": {"default": -6.943935110184791}, "policy_reward_max": {"default": 15.858041769960934}, "policy_reward_mean": {"default": 4.541921850121623}, "hist_stats": {"episode_reward": [149.88342105401364], "episode_lengths": [1975], "policy_default_reward": [11.651592769340585, -6.857996200066463, 14.900941712133656, 13.769353212013451, -4.637471272258472, 10.933635535412098, 12.228814431294492, -6.086479325908675, -4.435589820725175, -5.263653178373862, 14.781221464891933, 11.422297268865583, -3.723272693128483, -6.943935110184791, -1.2052233801619838, -4.354639995092981, 11.083522525924627, 10.497519182949498, 2.2432689784795663, -1.7687587496725463, -6.16207866471958, 11.139927335126012, 12.907906919222153, 15.858041769960934, 3.1879800054272653, -5.720059433850749, 2.401712993933433, 13.375088780684571, -1.44736691178713, 13.92602854904398, 13.492484429329092, -4.810232321890445, 13.498840247801942]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.492934807963755, "mean_inference_ms": 0.905528299692927, "mean_action_processing_ms": 1.0903698989357251, "mean_env_wait_ms": 8.533183840856976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005817413330078125, "StateBufferConnector_ms": 0.0035762786865234375, "ViewRequirementAgentConnector_ms": 0.09391307830810547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44359, "num_agent_steps_trained": 44359, "num_env_steps_sampled": 2000, "num_env_steps_trained": 2000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 66.05007911813378, "num_env_steps_trained_throughput_per_sec": 66.05007911813378, "timesteps_total": 2000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 44359, "timers": {"training_iteration_time_ms": 30280.025, "sample_time_ms": 26909.418, "load_time_ms": 20.864, "load_throughput": 95856.66, "learn_time_ms": 3347.079, "learn_throughput": 597.536, "synch_weights_time_ms": 1.552}, "counters": {"num_env_steps_sampled": 2000, "num_env_steps_trained": 2000, "num_agent_steps_sampled": 44359, "num_agent_steps_trained": 44359}, "done": false, "episodes_total": 1, "training_iteration": 1, "trial_id": "6fc01_00000", "date": "2023-12-22_17-14-46", "timestamp": 1703236486, "time_this_iter_s": 30.282562494277954, "time_total_s": 30.282562494277954, "pid": 703000, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.52.38", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 20}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f15412db940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 20, "vf_share_layers": -1, "old_value_loss": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 30.282562494277954, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 16.57045454545454, "ram_util_percent": 62.30454545454547}, "success": 0.0, "crash": 0.12121212121212122, "out": 0.3939393939393939, "max_step": 0.48484848484848486, "length": 1975.0, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 149.88342105401364}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.2864125122189638, "crash_rate_min": 0.12121212121212122, "crash_rate_max": 0.45161290322580644, "out_of_road_rate_mean": 0.34213098729227764, "out_of_road_rate_min": 0.2903225806451613, "out_of_road_rate_max": 0.3939393939393939, "max_step_rate_mean": 0.37145650048875856, "max_step_rate_min": 0.25806451612903225, "max_step_rate_max": 0.48484848484848486, "velocity_mean": 0.22230367835934153, "velocity_min": 0.21965073380517022, "velocity_max": 0.22495662291351284, "steering_mean": -0.009230322453836181, "steering_min": -0.009303420063122701, "steering_max": -0.009157224844549661, "step_reward_mean": 0.012942585714605357, "step_reward_min": 0.012835163103435522, "step_reward_max": 0.013050008325775193, "acceleration_mean": 0.001993976779404425, "acceleration_min": 0.00039165430103054144, "acceleration_max": 0.003596299257778308, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 729.6417399804496, "episode_length_min": 704.6774193548387, "episode_length_max": 754.6060606060606, "episode_reward_mean": 9.440769028143079, "episode_reward_min": 9.196046189566419, "episode_reward_max": 9.685491866719738, "num_neighbours_mean": 0.0, "num_neighbours_min": 0.0, "num_neighbours_max": 0.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 32.0, "num_active_agents_min": 31, "num_active_agents_max": 33, "environment_reward_total_mean": 302.3493317391552, "environment_reward_total_min": 285.077431876559, "environment_reward_total_max": 319.6212316017514}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.2, "cur_lr": 0.0003, "total_loss": 2.7732020961361017, "policy_loss": -0.012410705307355293, "vf_loss": 2.783532078134326, "vf_explained_var": 0.17378289989936047, "kl": 0.010403603951178812, "entropy": 2.84773605909103, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 625.5, "diff_num_grad_updates_vs_sampler_policy": 194.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 84296, "num_agent_steps_trained": 84296}, "sampler_results": {"episode_reward_max": 149.88342105401364, "episode_reward_min": 55.25599011842389, "episode_reward_mean": 102.56970558621876, "episode_len_mean": 1977.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -7.7086678497271155}, "policy_reward_max": {"default": 15.858041769960934}, "policy_reward_mean": {"default": 3.2053032995693447}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.2864125122189638, "crash_rate_min": 0.12121212121212122, "crash_rate_max": 0.45161290322580644, "out_of_road_rate_mean": 0.34213098729227764, "out_of_road_rate_min": 0.2903225806451613, "out_of_road_rate_max": 0.3939393939393939, "max_step_rate_mean": 0.37145650048875856, "max_step_rate_min": 0.25806451612903225, "max_step_rate_max": 0.48484848484848486, "velocity_mean": 0.22230367835934153, "velocity_min": 0.21965073380517022, "velocity_max": 0.22495662291351284, "steering_mean": -0.009230322453836181, "steering_min": -0.009303420063122701, "steering_max": -0.009157224844549661, "step_reward_mean": 0.012942585714605357, "step_reward_min": 0.012835163103435522, "step_reward_max": 0.013050008325775193, "acceleration_mean": 0.001993976779404425, "acceleration_min": 0.00039165430103054144, "acceleration_max": 0.003596299257778308, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 729.6417399804496, "episode_length_min": 704.6774193548387, "episode_length_max": 754.6060606060606, "episode_reward_mean": 9.440769028143079, "episode_reward_min": 9.196046189566419, "episode_reward_max": 9.685491866719738, "num_neighbours_mean": 0.0, "num_neighbours_min": 0.0, "num_neighbours_max": 0.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 32.0, "num_active_agents_min": 31, "num_active_agents_max": 33, "environment_reward_total_mean": 302.3493317391552, "environment_reward_total_min": 285.077431876559, "environment_reward_total_max": 319.6212316017514}, "hist_stats": {"episode_reward": [149.88342105401364, 55.25599011842389], "episode_lengths": [1975, 1979], "policy_default_reward": [11.651592769340585, -6.857996200066463, 14.900941712133656, 13.769353212013451, -4.637471272258472, 10.933635535412098, 12.228814431294492, -6.086479325908675, -4.435589820725175, -5.263653178373862, 14.781221464891933, 11.422297268865583, -3.723272693128483, -6.943935110184791, -1.2052233801619838, -4.354639995092981, 11.083522525924627, 10.497519182949498, 2.2432689784795663, -1.7687587496725463, -6.16207866471958, 11.139927335126012, 12.907906919222153, 15.858041769960934, 3.1879800054272653, -5.720059433850749, 2.401712993933433, 13.375088780684571, -1.44736691178713, 13.92602854904398, 13.492484429329092, -4.810232321890445, 13.498840247801942, -3.141750020497577, 1.3930628911246803, 1.9420544412209537, 5.479286211126025, -4.202212485399109, -1.744069640252805, -2.015579432100945, -1.1912648684683482, -3.405817499988574, -4.040495698484633, -7.7086678497271155, 7.762517675313032, -2.5100725754112254, -1.3931168912921592, -5.677352637193968, 14.878897178862614, 15.041642275122843, -1.6959533087939764, -1.7120716097335453, -2.9305178690607745, 14.019448408175748, 12.636291692127923, -3.1775104940827203, 13.580238589869687, -2.413227452065991, 12.813529635283377, -0.2932927098734357, -2.757835041658061, -2.5605363864992015, -4.451168229302462, 14.731533820084273]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4395914404776367, "mean_inference_ms": 0.9015552444903288, "mean_action_processing_ms": 1.0614227890214933, "mean_env_wait_ms": 8.374600857172497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005185604095458984, "StateBufferConnector_ms": 0.003731250762939453, "ViewRequirementAgentConnector_ms": 0.08800029754638672}}, "episode_reward_max": 149.88342105401364, "episode_reward_min": 55.25599011842389, "episode_reward_mean": 3.2053032995693447, "episode_len_mean": 1977.0, "episodes_this_iter": 1, "policy_reward_min": {"default": -7.7086678497271155}, "policy_reward_max": {"default": 15.858041769960934}, "policy_reward_mean": {"default": 3.2053032995693447}, "hist_stats": {"episode_reward": [149.88342105401364, 55.25599011842389], "episode_lengths": [1975, 1979], "policy_default_reward": [11.651592769340585, -6.857996200066463, 14.900941712133656, 13.769353212013451, -4.637471272258472, 10.933635535412098, 12.228814431294492, -6.086479325908675, -4.435589820725175, -5.263653178373862, 14.781221464891933, 11.422297268865583, -3.723272693128483, -6.943935110184791, -1.2052233801619838, -4.354639995092981, 11.083522525924627, 10.497519182949498, 2.2432689784795663, -1.7687587496725463, -6.16207866471958, 11.139927335126012, 12.907906919222153, 15.858041769960934, 3.1879800054272653, -5.720059433850749, 2.401712993933433, 13.375088780684571, -1.44736691178713, 13.92602854904398, 13.492484429329092, -4.810232321890445, 13.498840247801942, -3.141750020497577, 1.3930628911246803, 1.9420544412209537, 5.479286211126025, -4.202212485399109, -1.744069640252805, -2.015579432100945, -1.1912648684683482, -3.405817499988574, -4.040495698484633, -7.7086678497271155, 7.762517675313032, -2.5100725754112254, -1.3931168912921592, -5.677352637193968, 14.878897178862614, 15.041642275122843, -1.6959533087939764, -1.7120716097335453, -2.9305178690607745, 14.019448408175748, 12.636291692127923, -3.1775104940827203, 13.580238589869687, -2.413227452065991, 12.813529635283377, -0.2932927098734357, -2.757835041658061, -2.5605363864992015, -4.451168229302462, 14.731533820084273]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4395914404776367, "mean_inference_ms": 0.9015552444903288, "mean_action_processing_ms": 1.0614227890214933, "mean_env_wait_ms": 8.374600857172497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005185604095458984, "StateBufferConnector_ms": 0.003731250762939453, "ViewRequirementAgentConnector_ms": 0.08800029754638672}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84296, "num_agent_steps_trained": 84296, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 72.51165960978295, "num_env_steps_trained_throughput_per_sec": 72.51165960978295, "timesteps_total": 4000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 84296, "timers": {"training_iteration_time_ms": 28930.885, "sample_time_ms": 25802.967, "load_time_ms": 24.014, "load_throughput": 83286.004, "learn_time_ms": 3101.524, "learn_throughput": 644.844, "synch_weights_time_ms": 1.508}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 84296, "num_agent_steps_trained": 84296}, "done": false, "episodes_total": 2, "training_iteration": 2, "trial_id": "6fc01_00000", "date": "2023-12-22_17-15-13", "timestamp": 1703236513, "time_this_iter_s": 27.584951162338257, "time_total_s": 57.86751365661621, "pid": 703000, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.52.38", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 20}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f15412db940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 20, "vf_share_layers": -1, "old_value_loss": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 57.86751365661621, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 19.253846153846155, "ram_util_percent": 63.84615384615385}, "success": 0.0, "crash": 0.2864125122189638, "out": 0.34213098729227764, "max_step": 0.37145650048875856, "length": 1977.0, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 102.56970558621876}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.3576083414793092, "crash_rate_min": 0.12121212121212122, "crash_rate_max": 0.5, "out_of_road_rate_mean": 0.30651869741053805, "out_of_road_rate_min": 0.23529411764705882, "out_of_road_rate_max": 0.3939393939393939, "max_step_rate_mean": 0.33587296111015275, "max_step_rate_min": 0.25806451612903225, "max_step_rate_max": 0.48484848484848486, "velocity_mean": 0.22427706280486634, "velocity_min": 0.21965073380517022, "velocity_max": 0.2282238316959159, "steering_mean": -0.013524167109917565, "steering_min": -0.022111856422080328, "steering_max": -0.009157224844549661, "step_reward_mean": 0.013114548920933111, "step_reward_min": 0.012835163103435522, "step_reward_max": 0.01345847533358862, "acceleration_mean": -0.0014004763554646361, "acceleration_min": -0.008189382625202758, "acceleration_max": 0.003596299257778308, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 700.0650815555938, "episode_length_min": 640.9117647058823, "episode_length_max": 754.6060606060606, "episode_reward_mean": 9.169077744195675, "episode_reward_min": 8.625695176300871, "episode_reward_max": 9.685491866719738, "num_neighbours_mean": 0.0, "num_neighbours_min": 0.0, "num_neighbours_max": 0.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 32.666666666666664, "num_active_agents_min": 31, "num_active_agents_max": 34, "environment_reward_total_mean": 299.32409982418, "environment_reward_total_min": 285.077431876559, "environment_reward_total_max": 319.6212316017514}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.2, "cur_lr": 0.0002999999999999999, "total_loss": 2.776578211129665, "policy_loss": -0.01168045283605655, "vf_loss": 2.7856154910200055, "vf_explained_var": 0.103654431445258, "kl": 0.013215804733252817, "entropy": 2.8747055490811664, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1030.5, "diff_num_grad_updates_vs_sampler_policy": 209.5}}, "num_env_steps_sampled": 6000, "num_env_steps_trained": 6000, "num_agent_steps_sampled": 127479, "num_agent_steps_trained": 127479}, "sampler_results": {"episode_reward_max": 149.88342105401364, "episode_reward_min": 43.455416892221336, "episode_reward_mean": 82.86494268821961, "episode_len_mean": 1947.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -7.7086678497271155}, "policy_reward_max": {"default": 15.88873627845835}, "policy_reward_mean": {"default": 2.536681919027133}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.3576083414793092, "crash_rate_min": 0.12121212121212122, "crash_rate_max": 0.5, "out_of_road_rate_mean": 0.30651869741053805, "out_of_road_rate_min": 0.23529411764705882, "out_of_road_rate_max": 0.3939393939393939, "max_step_rate_mean": 0.33587296111015275, "max_step_rate_min": 0.25806451612903225, "max_step_rate_max": 0.48484848484848486, "velocity_mean": 0.22427706280486634, "velocity_min": 0.21965073380517022, "velocity_max": 0.2282238316959159, "steering_mean": -0.013524167109917565, "steering_min": -0.022111856422080328, "steering_max": -0.009157224844549661, "step_reward_mean": 0.013114548920933111, "step_reward_min": 0.012835163103435522, "step_reward_max": 0.01345847533358862, "acceleration_mean": -0.0014004763554646361, "acceleration_min": -0.008189382625202758, "acceleration_max": 0.003596299257778308, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 700.0650815555938, "episode_length_min": 640.9117647058823, "episode_length_max": 754.6060606060606, "episode_reward_mean": 9.169077744195675, "episode_reward_min": 8.625695176300871, "episode_reward_max": 9.685491866719738, "num_neighbours_mean": 0.0, "num_neighbours_min": 0.0, "num_neighbours_max": 0.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 32.666666666666664, "num_active_agents_min": 31, "num_active_agents_max": 34, "environment_reward_total_mean": 299.32409982418, "environment_reward_total_min": 285.077431876559, "environment_reward_total_max": 319.6212316017514}, "hist_stats": {"episode_reward": [149.88342105401364, 55.25599011842389, 43.455416892221336], "episode_lengths": [1975, 1979, 1887], "policy_default_reward": [11.651592769340585, -6.857996200066463, 14.900941712133656, 13.769353212013451, -4.637471272258472, 10.933635535412098, 12.228814431294492, -6.086479325908675, -4.435589820725175, -5.263653178373862, 14.781221464891933, 11.422297268865583, -3.723272693128483, -6.943935110184791, -1.2052233801619838, -4.354639995092981, 11.083522525924627, 10.497519182949498, 2.2432689784795663, -1.7687587496725463, -6.16207866471958, 11.139927335126012, 12.907906919222153, 15.858041769960934, 3.1879800054272653, -5.720059433850749, 2.401712993933433, 13.375088780684571, -1.44736691178713, 13.92602854904398, 13.492484429329092, -4.810232321890445, 13.498840247801942, -3.141750020497577, 1.3930628911246803, 1.9420544412209537, 5.479286211126025, -4.202212485399109, -1.744069640252805, -2.015579432100945, -1.1912648684683482, -3.405817499988574, -4.040495698484633, -7.7086678497271155, 7.762517675313032, -2.5100725754112254, -1.3931168912921592, -5.677352637193968, 14.878897178862614, 15.041642275122843, -1.6959533087939764, -1.7120716097335453, -2.9305178690607745, 14.019448408175748, 12.636291692127923, -3.1775104940827203, 13.580238589869687, -2.413227452065991, 12.813529635283377, -0.2932927098734357, -2.757835041658061, -2.5605363864992015, -4.451168229302462, 14.731533820084273, -4.039777685671849, 15.381019340532632, -2.3443835064979295, -4.812867185300908, -1.7475938072828932, -0.17432371654347634, -6.98989885534593, -6.201053232313317, -3.2045853610890758, -4.925604411346914, -4.762173058313867, -4.753691173757886, -6.178603966912968, 13.103473457187052, -4.614414615077891, 3.084402903294997, 15.88873627845835, -4.368415786045891, 15.256363081895843, 14.490880478136603, -0.4966997644387572, -4.076248351687737, -2.3862212037146797, 0.0854630131314984, 12.397057430099435, 13.317502401279233, -3.332024067134829, -5.5846803889236964, -4.540299550154666, 11.576235909103342, 11.359853874990032, -1.6586299735753247, 1.1368613688373124, -2.430242983594896]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428062019500279, "mean_inference_ms": 0.9016438816144712, "mean_action_processing_ms": 1.0535764826104572, "mean_env_wait_ms": 8.341656332544288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046571095784505205, "StateBufferConnector_ms": 0.0036319096883138022, "ViewRequirementAgentConnector_ms": 0.08289019266764323}}, "episode_reward_max": 149.88342105401364, "episode_reward_min": 43.455416892221336, "episode_reward_mean": 2.536681919027133, "episode_len_mean": 1947.0, "episodes_this_iter": 1, "policy_reward_min": {"default": -7.7086678497271155}, "policy_reward_max": {"default": 15.88873627845835}, "policy_reward_mean": {"default": 2.536681919027133}, "hist_stats": {"episode_reward": [149.88342105401364, 55.25599011842389, 43.455416892221336], "episode_lengths": [1975, 1979, 1887], "policy_default_reward": [11.651592769340585, -6.857996200066463, 14.900941712133656, 13.769353212013451, -4.637471272258472, 10.933635535412098, 12.228814431294492, -6.086479325908675, -4.435589820725175, -5.263653178373862, 14.781221464891933, 11.422297268865583, -3.723272693128483, -6.943935110184791, -1.2052233801619838, -4.354639995092981, 11.083522525924627, 10.497519182949498, 2.2432689784795663, -1.7687587496725463, -6.16207866471958, 11.139927335126012, 12.907906919222153, 15.858041769960934, 3.1879800054272653, -5.720059433850749, 2.401712993933433, 13.375088780684571, -1.44736691178713, 13.92602854904398, 13.492484429329092, -4.810232321890445, 13.498840247801942, -3.141750020497577, 1.3930628911246803, 1.9420544412209537, 5.479286211126025, -4.202212485399109, -1.744069640252805, -2.015579432100945, -1.1912648684683482, -3.405817499988574, -4.040495698484633, -7.7086678497271155, 7.762517675313032, -2.5100725754112254, -1.3931168912921592, -5.677352637193968, 14.878897178862614, 15.041642275122843, -1.6959533087939764, -1.7120716097335453, -2.9305178690607745, 14.019448408175748, 12.636291692127923, -3.1775104940827203, 13.580238589869687, -2.413227452065991, 12.813529635283377, -0.2932927098734357, -2.757835041658061, -2.5605363864992015, -4.451168229302462, 14.731533820084273, -4.039777685671849, 15.381019340532632, -2.3443835064979295, -4.812867185300908, -1.7475938072828932, -0.17432371654347634, -6.98989885534593, -6.201053232313317, -3.2045853610890758, -4.925604411346914, -4.762173058313867, -4.753691173757886, -6.178603966912968, 13.103473457187052, -4.614414615077891, 3.084402903294997, 15.88873627845835, -4.368415786045891, 15.256363081895843, 14.490880478136603, -0.4966997644387572, -4.076248351687737, -2.3862212037146797, 0.0854630131314984, 12.397057430099435, 13.317502401279233, -3.332024067134829, -5.5846803889236964, -4.540299550154666, 11.576235909103342, 11.359853874990032, -1.6586299735753247, 1.1368613688373124, -2.430242983594896]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428062019500279, "mean_inference_ms": 0.9016438816144712, "mean_action_processing_ms": 1.0535764826104572, "mean_env_wait_ms": 8.341656332544288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046571095784505205, "StateBufferConnector_ms": 0.0036319096883138022, "ViewRequirementAgentConnector_ms": 0.08289019266764323}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 127479, "num_agent_steps_trained": 127479, "num_env_steps_sampled": 6000, "num_env_steps_trained": 6000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 68.2952947781472, "num_env_steps_trained_throughput_per_sec": 68.2952947781472, "timesteps_total": 6000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 127479, "timers": {"training_iteration_time_ms": 29048.781, "sample_time_ms": 25978.708, "load_time_ms": 24.672, "load_throughput": 81062.406, "learn_time_ms": 3042.944, "learn_throughput": 657.258, "synch_weights_time_ms": 1.478}, "counters": {"num_env_steps_sampled": 6000, "num_env_steps_trained": 6000, "num_agent_steps_sampled": 127479, "num_agent_steps_trained": 127479}, "done": false, "episodes_total": 3, "training_iteration": 3, "trial_id": "6fc01_00000", "date": "2023-12-22_17-15-43", "timestamp": 1703236543, "time_this_iter_s": 29.287876844406128, "time_total_s": 87.15539050102234, "pid": 703000, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.52.38", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 20}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f15412db940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 20, "vf_share_layers": -1, "old_value_loss": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 87.15539050102234, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 17.42857142857143, "ram_util_percent": 63.88333333333333}, "success": 0.0, "crash": 0.3576083414793092, "out": 0.30651869741053805, "max_step": 0.33587296111015275, "length": 1947.0, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 82.86494268821961}
