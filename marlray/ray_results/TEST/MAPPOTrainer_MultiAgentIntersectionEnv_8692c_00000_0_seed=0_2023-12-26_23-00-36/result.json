{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.5, "out_of_road_rate_min": 0.5, "out_of_road_rate_max": 0.5, "max_step_rate_mean": 0.5, "max_step_rate_min": 0.5, "max_step_rate_max": 0.5, "velocity_mean": 0.23498094227500077, "velocity_min": 0.23498094227500077, "velocity_max": 0.23498094227500077, "steering_mean": 0.019153391698311116, "steering_min": 0.019153391698311116, "steering_max": 0.019153391698311116, "step_reward_mean": 0.01448770446240547, "step_reward_min": 0.01448770446240547, "step_reward_max": 0.01448770446240547, "acceleration_mean": 0.022010004828716147, "acceleration_min": 0.022010004828716147, "acceleration_max": 0.022010004828716147, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 725.0, "episode_length_min": 725.0, "episode_length_max": 725.0, "episode_reward_mean": 10.50358573524397, "episode_reward_min": 10.50358573524397, "episode_reward_max": 10.50358573524397, "num_neighbours_mean": 0.3427586206896552, "num_neighbours_min": 0.3427586206896552, "num_neighbours_max": 0.3427586206896552, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 4.0, "num_active_agents_min": 4, "num_active_agents_max": 4, "environment_reward_total_mean": 42.01434294097588, "environment_reward_total_min": 42.01434294097588, "environment_reward_total_max": 42.01434294097588}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999993, "cur_lr": 0.0003, "total_loss": 1.9878672043482462, "policy_loss": -0.004500032713015874, "vf_loss": 1.9913062135378519, "vf_explained_var": -0.000307819578382704, "kl": 0.0053051777753151215, "entropy": 2.8607479360368515, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 2000, "num_env_steps_trained": 2000, "num_agent_steps_sampled": 4690, "num_agent_steps_trained": 4690}, "sampler_results": {"episode_reward_max": 22.01204956831763, "episode_reward_min": 22.01204956831763, "episode_reward_mean": 22.01204956831763, "episode_len_mean": 1954.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -4.078005532204889}, "policy_reward_max": {"default": 14.458229657347212}, "policy_reward_mean": {"default": 5.503012392079411}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.5, "out_of_road_rate_min": 0.5, "out_of_road_rate_max": 0.5, "max_step_rate_mean": 0.5, "max_step_rate_min": 0.5, "max_step_rate_max": 0.5, "velocity_mean": 0.23498094227500077, "velocity_min": 0.23498094227500077, "velocity_max": 0.23498094227500077, "steering_mean": 0.019153391698311116, "steering_min": 0.019153391698311116, "steering_max": 0.019153391698311116, "step_reward_mean": 0.01448770446240547, "step_reward_min": 0.01448770446240547, "step_reward_max": 0.01448770446240547, "acceleration_mean": 0.022010004828716147, "acceleration_min": 0.022010004828716147, "acceleration_max": 0.022010004828716147, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 725.0, "episode_length_min": 725.0, "episode_length_max": 725.0, "episode_reward_mean": 10.50358573524397, "episode_reward_min": 10.50358573524397, "episode_reward_max": 10.50358573524397, "num_neighbours_mean": 0.3427586206896552, "num_neighbours_min": 0.3427586206896552, "num_neighbours_max": 0.3427586206896552, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 4.0, "num_active_agents_min": 4, "num_active_agents_max": 4, "environment_reward_total_mean": 42.01434294097588, "environment_reward_total_min": 42.01434294097588, "environment_reward_total_max": 42.01434294097588}, "hist_stats": {"episode_reward": [22.01204956831763], "episode_lengths": [1954], "policy_default_reward": [-2.7026660607659956, 14.458229657347212, -4.078005532204889, 14.334491503941317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36651739056619154, "mean_inference_ms": 0.5938501610629622, "mean_action_processing_ms": 0.17268809004463834, "mean_env_wait_ms": 1.149160155411186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009512901306152344, "StateBufferConnector_ms": 0.0033855438232421875, "ViewRequirementAgentConnector_ms": 0.0856161117553711}}, "episode_reward_max": 22.01204956831763, "episode_reward_min": 22.01204956831763, "episode_reward_mean": 5.503012392079411, "episode_len_mean": 1954.0, "episodes_this_iter": 1, "policy_reward_min": {"default": -4.078005532204889}, "policy_reward_max": {"default": 14.458229657347212}, "policy_reward_mean": {"default": 5.503012392079411}, "hist_stats": {"episode_reward": [22.01204956831763], "episode_lengths": [1954], "policy_default_reward": [-2.7026660607659956, 14.458229657347212, -4.078005532204889, 14.334491503941317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36651739056619154, "mean_inference_ms": 0.5938501610629622, "mean_action_processing_ms": 0.17268809004463834, "mean_env_wait_ms": 1.149160155411186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009512901306152344, "StateBufferConnector_ms": 0.0033855438232421875, "ViewRequirementAgentConnector_ms": 0.0856161117553711}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4690, "num_agent_steps_trained": 4690, "num_env_steps_sampled": 2000, "num_env_steps_trained": 2000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 360.12213729446984, "num_env_steps_trained_throughput_per_sec": 360.12213729446984, "timesteps_total": 2000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 4690, "timers": {"training_iteration_time_ms": 5553.642, "sample_time_ms": 4684.913, "load_time_ms": 2.959, "load_throughput": 675792.153, "learn_time_ms": 863.203, "learn_throughput": 2316.951, "synch_weights_time_ms": 1.79}, "counters": {"num_env_steps_sampled": 2000, "num_env_steps_trained": 2000, "num_agent_steps_sampled": 4690, "num_agent_steps_trained": 4690}, "done": false, "episodes_total": 1, "training_iteration": 1, "trial_id": "8692c_00000", "date": "2023-12-26_23-01-00", "timestamp": 1703602860, "time_this_iter_s": 5.556734323501587, "time_total_s": 5.556734323501587, "pid": 65201, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "concat", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7ffa4ce4cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "concat", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5.556734323501587, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 29.05, "ram_util_percent": 57.2875}, "success": 0.0, "crash": 0.0, "out": 0.5, "max_step": 0.5, "length": 1954.0, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 22.01204956831763}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.41666666666666663, "out_of_road_rate_min": 0.3333333333333333, "out_of_road_rate_max": 0.5, "max_step_rate_mean": 0.5833333333333333, "max_step_rate_min": 0.5, "max_step_rate_max": 0.6666666666666666, "velocity_mean": 0.227061629738164, "velocity_min": 0.2191423172013272, "velocity_max": 0.23498094227500077, "steering_mean": -0.01709352644991729, "steering_min": -0.05334044459814569, "steering_max": 0.019153391698311116, "step_reward_mean": 0.01368620223582653, "step_reward_min": 0.012884700009247591, "step_reward_max": 0.01448770446240547, "acceleration_mean": 0.011267198180217623, "acceleration_min": 0.0005243915317190968, "acceleration_max": 0.022010004828716147, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 803.6666666666667, "episode_length_min": 725.0, "episode_length_max": 882.3333333333334, "episode_reward_mean": 10.936093021701712, "episode_reward_min": 10.50358573524397, "episode_reward_max": 11.368600308159456, "num_neighbours_mean": 0.2941598165782994, "num_neighbours_min": 0.2455610124669437, "num_neighbours_max": 0.3427586206896552, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.5, "num_active_agents_min": 3, "num_active_agents_max": 4, "environment_reward_total_mean": 38.060071932727126, "environment_reward_total_min": 34.105800924478366, "environment_reward_total_max": 42.01434294097588}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0003, "total_loss": 0.5522988024034671, "policy_loss": -0.0461325111665896, "vf_loss": 0.5964832285019969, "vf_explained_var": 0.0025580218860081264, "kl": 0.009740444410791957, "entropy": 2.7236766747065952, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 8601, "num_agent_steps_trained": 8601}, "sampler_results": {"episode_reward_max": 24.1006289170576, "episode_reward_min": 22.01204956831763, "episode_reward_mean": 23.056339242687613, "episode_len_mean": 1814.5, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -4.078005532204889}, "policy_reward_max": {"default": 14.458229657347212}, "policy_reward_mean": {"default": 6.587525497910749}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.41666666666666663, "out_of_road_rate_min": 0.3333333333333333, "out_of_road_rate_max": 0.5, "max_step_rate_mean": 0.5833333333333333, "max_step_rate_min": 0.5, "max_step_rate_max": 0.6666666666666666, "velocity_mean": 0.227061629738164, "velocity_min": 0.2191423172013272, "velocity_max": 0.23498094227500077, "steering_mean": -0.01709352644991729, "steering_min": -0.05334044459814569, "steering_max": 0.019153391698311116, "step_reward_mean": 0.01368620223582653, "step_reward_min": 0.012884700009247591, "step_reward_max": 0.01448770446240547, "acceleration_mean": 0.011267198180217623, "acceleration_min": 0.0005243915317190968, "acceleration_max": 0.022010004828716147, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 803.6666666666667, "episode_length_min": 725.0, "episode_length_max": 882.3333333333334, "episode_reward_mean": 10.936093021701712, "episode_reward_min": 10.50358573524397, "episode_reward_max": 11.368600308159456, "num_neighbours_mean": 0.2941598165782994, "num_neighbours_min": 0.2455610124669437, "num_neighbours_max": 0.3427586206896552, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.5, "num_active_agents_min": 3, "num_active_agents_max": 4, "environment_reward_total_mean": 38.060071932727126, "environment_reward_total_min": 34.105800924478366, "environment_reward_total_max": 42.01434294097588}, "hist_stats": {"episode_reward": [22.01204956831763, 24.1006289170576], "episode_lengths": [1954, 1675], "policy_default_reward": [-2.7026660607659956, 14.458229657347212, -4.078005532204889, 14.334491503941317, 11.819362009990394, -1.3370410223903324, 13.618307929457542]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36508971810676605, "mean_inference_ms": 0.6042773475081482, "mean_action_processing_ms": 0.1777292726175505, "mean_env_wait_ms": 1.1752689243156569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007033348083496094, "StateBufferConnector_ms": 0.003039836883544922, "ViewRequirementAgentConnector_ms": 0.0803232192993164}}, "episode_reward_max": 24.1006289170576, "episode_reward_min": 22.01204956831763, "episode_reward_mean": 6.587525497910749, "episode_len_mean": 1814.5, "episodes_this_iter": 1, "policy_reward_min": {"default": -4.078005532204889}, "policy_reward_max": {"default": 14.458229657347212}, "policy_reward_mean": {"default": 6.587525497910749}, "hist_stats": {"episode_reward": [22.01204956831763, 24.1006289170576], "episode_lengths": [1954, 1675], "policy_default_reward": [-2.7026660607659956, 14.458229657347212, -4.078005532204889, 14.334491503941317, 11.819362009990394, -1.3370410223903324, 13.618307929457542]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36508971810676605, "mean_inference_ms": 0.6042773475081482, "mean_action_processing_ms": 0.1777292726175505, "mean_env_wait_ms": 1.1752689243156569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007033348083496094, "StateBufferConnector_ms": 0.003039836883544922, "ViewRequirementAgentConnector_ms": 0.0803232192993164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8601, "num_agent_steps_trained": 8601, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 381.5134909456237, "num_env_steps_trained_throughput_per_sec": 381.5134909456237, "timesteps_total": 4000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 8601, "timers": {"training_iteration_time_ms": 5397.951, "sample_time_ms": 4838.972, "load_time_ms": 3.462, "load_throughput": 577747.719, "learn_time_ms": 553.24, "learn_throughput": 3615.069, "synch_weights_time_ms": 1.737}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 8601, "num_agent_steps_trained": 8601}, "done": false, "episodes_total": 2, "training_iteration": 2, "trial_id": "8692c_00000", "date": "2023-12-26_23-01-05", "timestamp": 1703602865, "time_this_iter_s": 5.245157480239868, "time_total_s": 10.801891803741455, "pid": 65201, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "concat", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7ffa4ce4cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "concat", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10.801891803741455, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 21.9625, "ram_util_percent": 58.475}, "success": 0.0, "crash": 0.0, "out": 0.41666666666666663, "max_step": 0.5833333333333333, "length": 1814.5, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 23.056339242687613}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.5277777777777778, "out_of_road_rate_min": 0.3333333333333333, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.47222222222222215, "max_step_rate_min": 0.25, "max_step_rate_max": 0.6666666666666666, "velocity_mean": 0.22193434164610015, "velocity_min": 0.21167976546197248, "velocity_max": 0.23498094227500077, "steering_mean": -0.012793725403014987, "steering_min": -0.05334044459814569, "steering_max": 0.019153391698311116, "step_reward_mean": 0.012988246177861632, "step_reward_min": 0.011592334061931834, "step_reward_max": 0.01448770446240547, "acceleration_mean": -0.004043904462148035, "acceleration_min": -0.03466610974687935, "acceleration_max": 0.022010004828716147, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 766.9444444444445, "episode_length_min": 693.5, "episode_length_max": 882.3333333333334, "episode_reward_mean": 9.970489905117718, "episode_reward_min": 8.039283671949732, "episode_reward_max": 11.368600308159456, "num_neighbours_mean": 0.2652005121817358, "num_neighbours_min": 0.2072819033886085, "num_neighbours_max": 0.3427586206896552, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.6666666666666665, "num_active_agents_min": 3, "num_active_agents_max": 4, "environment_reward_total_mean": 36.092426184417725, "environment_reward_total_min": 32.15713468779893, "environment_reward_total_max": 42.01434294097588}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999996, "cur_lr": 0.0003, "total_loss": 2.585145790576935, "policy_loss": 0.007680492252111435, "vf_loss": 2.5759940934181214, "vf_explained_var": 0.0009118366241455078, "kl": 0.007356173755833879, "entropy": 2.7264730310440064, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 105.5, "diff_num_grad_updates_vs_sampler_policy": 24.5}}, "num_env_steps_sampled": 6000, "num_env_steps_trained": 6000, "num_agent_steps_sampled": 14162, "num_agent_steps_trained": 14162}, "sampler_results": {"episode_reward_max": 24.1006289170576, "episode_reward_min": 2.159555562314189, "episode_reward_mean": 16.090744682563138, "episode_len_mean": 1700.6666666666667, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -5.258338319486444}, "policy_reward_max": {"default": 14.458229657347212}, "policy_reward_mean": {"default": 4.388384913426313}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.5277777777777778, "out_of_road_rate_min": 0.3333333333333333, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.47222222222222215, "max_step_rate_min": 0.25, "max_step_rate_max": 0.6666666666666666, "velocity_mean": 0.22193434164610015, "velocity_min": 0.21167976546197248, "velocity_max": 0.23498094227500077, "steering_mean": -0.012793725403014987, "steering_min": -0.05334044459814569, "steering_max": 0.019153391698311116, "step_reward_mean": 0.012988246177861632, "step_reward_min": 0.011592334061931834, "step_reward_max": 0.01448770446240547, "acceleration_mean": -0.004043904462148035, "acceleration_min": -0.03466610974687935, "acceleration_max": 0.022010004828716147, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 766.9444444444445, "episode_length_min": 693.5, "episode_length_max": 882.3333333333334, "episode_reward_mean": 9.970489905117718, "episode_reward_min": 8.039283671949732, "episode_reward_max": 11.368600308159456, "num_neighbours_mean": 0.2652005121817358, "num_neighbours_min": 0.2072819033886085, "num_neighbours_max": 0.3427586206896552, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.6666666666666665, "num_active_agents_min": 3, "num_active_agents_max": 4, "environment_reward_total_mean": 36.092426184417725, "environment_reward_total_min": 32.15713468779893, "environment_reward_total_max": 42.01434294097588}, "hist_stats": {"episode_reward": [22.01204956831763, 24.1006289170576, 2.159555562314189], "episode_lengths": [1954, 1675, 1473], "policy_default_reward": [-2.7026660607659956, 14.458229657347212, -4.078005532204889, 14.334491503941317, 11.819362009990394, -1.3370410223903324, 13.618307929457542, -0.7160082185234131, -5.258338319486444, 12.112034006705112, -3.978131906381063]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.371111857981786, "mean_inference_ms": 0.6081807627933157, "mean_action_processing_ms": 0.18237166038257302, "mean_env_wait_ms": 1.1991636581356133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005857149759928386, "StateBufferConnector_ms": 0.0029484430948893228, "ViewRequirementAgentConnector_ms": 0.07786750793457031}}, "episode_reward_max": 24.1006289170576, "episode_reward_min": 2.159555562314189, "episode_reward_mean": 4.388384913426313, "episode_len_mean": 1700.6666666666667, "episodes_this_iter": 1, "policy_reward_min": {"default": -5.258338319486444}, "policy_reward_max": {"default": 14.458229657347212}, "policy_reward_mean": {"default": 4.388384913426313}, "hist_stats": {"episode_reward": [22.01204956831763, 24.1006289170576, 2.159555562314189], "episode_lengths": [1954, 1675, 1473], "policy_default_reward": [-2.7026660607659956, 14.458229657347212, -4.078005532204889, 14.334491503941317, 11.819362009990394, -1.3370410223903324, 13.618307929457542, -0.7160082185234131, -5.258338319486444, 12.112034006705112, -3.978131906381063]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.371111857981786, "mean_inference_ms": 0.6081807627933157, "mean_action_processing_ms": 0.18237166038257302, "mean_env_wait_ms": 1.1991636581356133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005857149759928386, "StateBufferConnector_ms": 0.0029484430948893228, "ViewRequirementAgentConnector_ms": 0.07786750793457031}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14162, "num_agent_steps_trained": 14162, "num_env_steps_sampled": 6000, "num_env_steps_trained": 6000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 353.0233089176576, "num_env_steps_trained_throughput_per_sec": 353.0233089176576, "timesteps_total": 6000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 14162, "timers": {"training_iteration_time_ms": 5487.073, "sample_time_ms": 4994.502, "load_time_ms": 3.778, "load_throughput": 529439.0, "learn_time_ms": 486.459, "learn_throughput": 4111.343, "synch_weights_time_ms": 1.751}, "counters": {"num_env_steps_sampled": 6000, "num_env_steps_trained": 6000, "num_agent_steps_sampled": 14162, "num_agent_steps_trained": 14162}, "done": false, "episodes_total": 3, "training_iteration": 3, "trial_id": "8692c_00000", "date": "2023-12-26_23-01-11", "timestamp": 1703602871, "time_this_iter_s": 5.668557167053223, "time_total_s": 16.470448970794678, "pid": 65201, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "concat", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7ffa4ce4cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "concat", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 16.470448970794678, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.15, "ram_util_percent": 58.5625}, "success": 0.0, "crash": 0.0, "out": 0.5277777777777778, "max_step": 0.47222222222222215, "length": 1700.6666666666667, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 16.090744682563138}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.5208333333333333, "out_of_road_rate_min": 0.3333333333333333, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.47916666666666663, "max_step_rate_min": 0.25, "max_step_rate_max": 0.6666666666666666, "velocity_mean": 0.22031603163245736, "velocity_min": 0.21167976546197248, "velocity_max": 0.23498094227500077, "steering_mean": -0.02205939387658408, "steering_min": -0.05334044459814569, "steering_max": 0.019153391698311116, "step_reward_mean": 0.012858814925866654, "step_reward_min": 0.011592334061931834, "step_reward_max": 0.01448770446240547, "acceleration_mean": -0.003717209290168641, "acceleration_min": -0.03466610974687935, "acceleration_max": 0.022010004828716147, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 751.3958333333334, "episode_length_min": 693.5, "episode_length_max": 882.3333333333334, "episode_reward_mean": 9.675017377456824, "episode_reward_min": 8.039283671949732, "episode_reward_max": 11.368600308159456, "num_neighbours_mean": 0.19890038413630184, "num_neighbours_min": 0.0, "num_neighbours_max": 0.3427586206896552, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.75, "num_active_agents_min": 3, "num_active_agents_max": 4, "environment_reward_total_mean": 35.85791943278743, "environment_reward_total_min": 32.15713468779893, "environment_reward_total_max": 42.01434294097588}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999993, "cur_lr": 0.0003, "total_loss": 2.052034766703016, "policy_loss": -0.0028933663335111407, "vf_loss": 2.0541672453284265, "vf_explained_var": 3.922118080986871e-05, "kl": 0.003804457881940691, "entropy": 2.7196522500779894, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 153.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 19190, "num_agent_steps_trained": 19190}, "sampler_results": {"episode_reward_max": 24.1006289170576, "episode_reward_min": 2.159555562314189, "episode_reward_mean": 15.856330357805062, "episode_len_mean": 1679.75, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -6.496886345768102}, "policy_reward_max": {"default": 14.458229657347212}, "policy_reward_mean": {"default": 4.22835476208135}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.5208333333333333, "out_of_road_rate_min": 0.3333333333333333, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.47916666666666663, "max_step_rate_min": 0.25, "max_step_rate_max": 0.6666666666666666, "velocity_mean": 0.22031603163245736, "velocity_min": 0.21167976546197248, "velocity_max": 0.23498094227500077, "steering_mean": -0.02205939387658408, "steering_min": -0.05334044459814569, "steering_max": 0.019153391698311116, "step_reward_mean": 0.012858814925866654, "step_reward_min": 0.011592334061931834, "step_reward_max": 0.01448770446240547, "acceleration_mean": -0.003717209290168641, "acceleration_min": -0.03466610974687935, "acceleration_max": 0.022010004828716147, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 751.3958333333334, "episode_length_min": 693.5, "episode_length_max": 882.3333333333334, "episode_reward_mean": 9.675017377456824, "episode_reward_min": 8.039283671949732, "episode_reward_max": 11.368600308159456, "num_neighbours_mean": 0.19890038413630184, "num_neighbours_min": 0.0, "num_neighbours_max": 0.3427586206896552, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.75, "num_active_agents_min": 3, "num_active_agents_max": 4, "environment_reward_total_mean": 35.85791943278743, "environment_reward_total_min": 32.15713468779893, "environment_reward_total_max": 42.01434294097588}, "hist_stats": {"episode_reward": [22.01204956831763, 24.1006289170576, 2.159555562314189, 15.15308738353083], "episode_lengths": [1954, 1675, 1473, 1617], "policy_default_reward": [-2.7026660607659956, 14.458229657347212, -4.078005532204889, 14.334491503941317, 11.819362009990394, -1.3370410223903324, 13.618307929457542, -0.7160082185234131, -5.258338319486444, 12.112034006705112, -3.978131906381063, -2.3856195103099695, -6.496886345768102, 11.39390403648099, 12.6416892031279]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37563803282802594, "mean_inference_ms": 0.613636327701601, "mean_action_processing_ms": 0.18533229706940502, "mean_env_wait_ms": 1.2198917780390022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005841255187988281, "StateBufferConnector_ms": 0.003337860107421875, "ViewRequirementAgentConnector_ms": 0.0803232192993164}}, "episode_reward_max": 24.1006289170576, "episode_reward_min": 2.159555562314189, "episode_reward_mean": 4.22835476208135, "episode_len_mean": 1679.75, "episodes_this_iter": 1, "policy_reward_min": {"default": -6.496886345768102}, "policy_reward_max": {"default": 14.458229657347212}, "policy_reward_mean": {"default": 4.22835476208135}, "hist_stats": {"episode_reward": [22.01204956831763, 24.1006289170576, 2.159555562314189, 15.15308738353083], "episode_lengths": [1954, 1675, 1473, 1617], "policy_default_reward": [-2.7026660607659956, 14.458229657347212, -4.078005532204889, 14.334491503941317, 11.819362009990394, -1.3370410223903324, 13.618307929457542, -0.7160082185234131, -5.258338319486444, 12.112034006705112, -3.978131906381063, -2.3856195103099695, -6.496886345768102, 11.39390403648099, 12.6416892031279]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37563803282802594, "mean_inference_ms": 0.613636327701601, "mean_action_processing_ms": 0.18533229706940502, "mean_env_wait_ms": 1.2198917780390022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005841255187988281, "StateBufferConnector_ms": 0.003337860107421875, "ViewRequirementAgentConnector_ms": 0.0803232192993164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19190, "num_agent_steps_trained": 19190, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 340.3529766088394, "num_env_steps_trained_throughput_per_sec": 340.3529766088394, "timesteps_total": 8000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 19190, "timers": {"training_iteration_time_ms": 5584.361, "sample_time_ms": 5133.361, "load_time_ms": 4.277, "load_throughput": 467592.419, "learn_time_ms": 444.414, "learn_throughput": 4500.303, "synch_weights_time_ms": 1.755}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 19190, "num_agent_steps_trained": 19190}, "done": false, "episodes_total": 4, "training_iteration": 4, "trial_id": "8692c_00000", "date": "2023-12-26_23-01-17", "timestamp": 1703602877, "time_this_iter_s": 5.879499197006226, "time_total_s": 22.349948167800903, "pid": 65201, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "concat", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7ffa4ce4cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "concat", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 22.349948167800903, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 22.15, "ram_util_percent": 58.4375}, "success": 0.0, "crash": 0.0, "out": 0.5208333333333333, "max_step": 0.47916666666666663, "length": 1679.75, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 15.856330357805062}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.40277777777777773, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.5972222222222222, "max_step_rate_min": 0.25, "max_step_rate_max": 1.0, "velocity_mean": 0.22155344062661744, "velocity_min": 0.21167976546197248, "velocity_max": 0.23498094227500077, "steering_mean": -0.03180807903801534, "steering_min": -0.06920825686882032, "steering_max": 0.019153391698311116, "step_reward_mean": 0.012911822457992134, "step_reward_min": 0.011592334061931834, "step_reward_max": 0.01448770446240547, "acceleration_mean": -0.0008749047808214723, "acceleration_min": -0.03466610974687935, "acceleration_max": 0.022010004828716147, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 798.875, "episode_length_min": 693.5, "episode_length_max": 999.0, "episode_reward_mean": 10.316827657561602, "episode_reward_min": 8.039283671949732, "episode_reward_max": 12.669223247577253, "num_neighbours_mean": 0.1326002560908679, "num_neighbours_min": 0.0, "num_neighbours_max": 0.3427586206896552, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.3333333333333335, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 33.3941906316999, "environment_reward_total_min": 25.338446495154507, "environment_reward_total_max": 42.01434294097588}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0003, "total_loss": 0.2519991813876134, "policy_loss": 0.011421358798231397, "vf_loss": 0.2398542858394129, "vf_explained_var": -0.03337079797472273, "kl": 0.007235237679976544, "entropy": 2.7008062975747245, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 193.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_agent_steps_sampled": 23284, "num_agent_steps_trained": 23284}, "sampler_results": {"episode_reward_max": 25.415171295822407, "episode_reward_min": 2.159555562314189, "episode_reward_mean": 18.40899763709514, "episode_len_mean": 1518.8333333333333, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"default": -6.496886345768102}, "policy_reward_max": {"default": 14.458229657347212}, "policy_reward_mean": {"default": 5.522699291128548}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.40277777777777773, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.5972222222222222, "max_step_rate_min": 0.25, "max_step_rate_max": 1.0, "velocity_mean": 0.22155344062661744, "velocity_min": 0.21167976546197248, "velocity_max": 0.23498094227500077, "steering_mean": -0.03180807903801534, "steering_min": -0.06920825686882032, "steering_max": 0.019153391698311116, "step_reward_mean": 0.012911822457992134, "step_reward_min": 0.011592334061931834, "step_reward_max": 0.01448770446240547, "acceleration_mean": -0.0008749047808214723, "acceleration_min": -0.03466610974687935, "acceleration_max": 0.022010004828716147, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 798.875, "episode_length_min": 693.5, "episode_length_max": 999.0, "episode_reward_mean": 10.316827657561602, "episode_reward_min": 8.039283671949732, "episode_reward_max": 12.669223247577253, "num_neighbours_mean": 0.1326002560908679, "num_neighbours_min": 0.0, "num_neighbours_max": 0.3427586206896552, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.3333333333333335, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 33.3941906316999, "environment_reward_total_min": 25.338446495154507, "environment_reward_total_max": 42.01434294097588}, "hist_stats": {"episode_reward": [22.01204956831763, 24.1006289170576, 2.159555562314189, 15.15308738353083, 21.61349309552819, 25.415171295822407], "episode_lengths": [1954, 1675, 1473, 1617, 1394, 1000], "policy_default_reward": [-2.7026660607659956, 14.458229657347212, -4.078005532204889, 14.334491503941317, 11.819362009990394, -1.3370410223903324, 13.618307929457542, -0.7160082185234131, -5.258338319486444, 12.112034006705112, -3.978131906381063, -2.3856195103099695, -6.496886345768102, 11.39390403648099, 12.6416892031279, -4.598665285739648, 13.771773114506862, 12.440385266761036, 12.055577110854694, 13.359594184967754]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38181578158284685, "mean_inference_ms": 0.618701152554619, "mean_action_processing_ms": 0.18966865535210195, "mean_env_wait_ms": 1.2481771530673738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00516970952351888, "StateBufferConnector_ms": 0.003270308176676432, "ViewRequirementAgentConnector_ms": 0.08706251780192058}}, "episode_reward_max": 25.415171295822407, "episode_reward_min": 2.159555562314189, "episode_reward_mean": 5.522699291128548, "episode_len_mean": 1518.8333333333333, "episodes_this_iter": 2, "policy_reward_min": {"default": -6.496886345768102}, "policy_reward_max": {"default": 14.458229657347212}, "policy_reward_mean": {"default": 5.522699291128548}, "hist_stats": {"episode_reward": [22.01204956831763, 24.1006289170576, 2.159555562314189, 15.15308738353083, 21.61349309552819, 25.415171295822407], "episode_lengths": [1954, 1675, 1473, 1617, 1394, 1000], "policy_default_reward": [-2.7026660607659956, 14.458229657347212, -4.078005532204889, 14.334491503941317, 11.819362009990394, -1.3370410223903324, 13.618307929457542, -0.7160082185234131, -5.258338319486444, 12.112034006705112, -3.978131906381063, -2.3856195103099695, -6.496886345768102, 11.39390403648099, 12.6416892031279, -4.598665285739648, 13.771773114506862, 12.440385266761036, 12.055577110854694, 13.359594184967754]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38181578158284685, "mean_inference_ms": 0.618701152554619, "mean_action_processing_ms": 0.18966865535210195, "mean_env_wait_ms": 1.2481771530673738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00516970952351888, "StateBufferConnector_ms": 0.003270308176676432, "ViewRequirementAgentConnector_ms": 0.08706251780192058}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23284, "num_agent_steps_trained": 23284, "num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 350.7167913395119, "num_env_steps_trained_throughput_per_sec": 350.7167913395119, "timesteps_total": 10000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 23284, "timers": {"training_iteration_time_ms": 5608.007, "sample_time_ms": 5187.809, "load_time_ms": 4.414, "load_throughput": 453144.339, "learn_time_ms": 413.534, "learn_throughput": 4836.358, "synch_weights_time_ms": 1.72}, "counters": {"num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_agent_steps_sampled": 23284, "num_agent_steps_trained": 23284}, "done": false, "episodes_total": 6, "training_iteration": 5, "trial_id": "8692c_00000", "date": "2023-12-26_23-01-22", "timestamp": 1703602882, "time_this_iter_s": 5.706238508224487, "time_total_s": 28.05618667602539, "pid": 65201, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "concat", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7ffa4ce4cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "concat", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 28.05618667602539, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 18.04444444444444, "ram_util_percent": 58.611111111111114}, "success": 0.0, "crash": 0.0, "out": 0.40277777777777773, "max_step": 0.5972222222222222, "length": 1518.8333333333333, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 18.40899763709514}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.3020833333333333, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.6979166666666666, "max_step_rate_min": 0.25, "max_step_rate_max": 1.0, "velocity_mean": 0.22731757941973055, "velocity_min": 0.21167976546197248, "velocity_max": 0.26108552248487343, "steering_mean": -0.02910148113219989, "steering_min": -0.06920825686882032, "steering_max": 0.019153391698311116, "step_reward_mean": 0.013597866653614638, "step_reward_min": 0.011592334061931834, "step_reward_max": 0.017813141378583353, "acceleration_mean": 0.00909495075793772, "acceleration_min": -0.03466610974687935, "acceleration_max": 0.07293597511104397, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 848.90625, "episode_length_min": 693.5, "episode_length_max": 999.0, "episode_reward_mean": 11.647706553481619, "episode_reward_min": 8.039283671949732, "episode_reward_max": 17.795328237204778, "num_neighbours_mean": 0.22445019206815092, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 32.86581459439576, "environment_reward_total_min": 25.338446495154507, "environment_reward_total_max": 42.01434294097588}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0003, "total_loss": 0.2146572462682213, "policy_loss": -0.06695936428649085, "vf_loss": 0.28013620621391705, "vf_explained_var": -0.04444298233304705, "kl": 0.014804067397822886, "entropy": 2.590381186349051, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 228.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 27335, "num_agent_steps_trained": 27335}, "sampler_results": {"episode_reward_max": 35.639744824557326, "episode_reward_min": 2.159555562314189, "episode_reward_mean": 21.64091261955835, "episode_len_mean": 1389.125, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"default": -6.496886345768102}, "policy_reward_max": {"default": 21.208312329313}, "policy_reward_mean": {"default": 7.213637539852784}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.3020833333333333, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.6979166666666666, "max_step_rate_min": 0.25, "max_step_rate_max": 1.0, "velocity_mean": 0.22731757941973055, "velocity_min": 0.21167976546197248, "velocity_max": 0.26108552248487343, "steering_mean": -0.02910148113219989, "steering_min": -0.06920825686882032, "steering_max": 0.019153391698311116, "step_reward_mean": 0.013597866653614638, "step_reward_min": 0.011592334061931834, "step_reward_max": 0.017813141378583353, "acceleration_mean": 0.00909495075793772, "acceleration_min": -0.03466610974687935, "acceleration_max": 0.07293597511104397, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 848.90625, "episode_length_min": 693.5, "episode_length_max": 999.0, "episode_reward_mean": 11.647706553481619, "episode_reward_min": 8.039283671949732, "episode_reward_max": 17.795328237204778, "num_neighbours_mean": 0.22445019206815092, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 32.86581459439576, "environment_reward_total_min": 25.338446495154507, "environment_reward_total_max": 42.01434294097588}, "hist_stats": {"episode_reward": [22.01204956831763, 24.1006289170576, 2.159555562314189, 15.15308738353083, 21.61349309552819, 25.415171295822407, 27.033570309338618, 35.639744824557326], "episode_lengths": [1954, 1675, 1473, 1617, 1394, 1000, 1000, 1000], "policy_default_reward": [-2.7026660607659956, 14.458229657347212, -4.078005532204889, 14.334491503941317, 11.819362009990394, -1.3370410223903324, 13.618307929457542, -0.7160082185234131, -5.258338319486444, 12.112034006705112, -3.978131906381063, -2.3856195103099695, -6.496886345768102, 11.39390403648099, 12.6416892031279, -4.598665285739648, 13.771773114506862, 12.440385266761036, 12.055577110854694, 13.359594184967754, 12.588087035273837, 14.445483274064754, 14.431432495244284, 21.208312329313]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38625360356102556, "mean_inference_ms": 0.6217906476501358, "mean_action_processing_ms": 0.19316832597412742, "mean_env_wait_ms": 1.2677913905320717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005170702934265137, "StateBufferConnector_ms": 0.0034123659133911133, "ViewRequirementAgentConnector_ms": 0.09967982769012451}}, "episode_reward_max": 35.639744824557326, "episode_reward_min": 2.159555562314189, "episode_reward_mean": 7.213637539852784, "episode_len_mean": 1389.125, "episodes_this_iter": 2, "policy_reward_min": {"default": -6.496886345768102}, "policy_reward_max": {"default": 21.208312329313}, "policy_reward_mean": {"default": 7.213637539852784}, "hist_stats": {"episode_reward": [22.01204956831763, 24.1006289170576, 2.159555562314189, 15.15308738353083, 21.61349309552819, 25.415171295822407, 27.033570309338618, 35.639744824557326], "episode_lengths": [1954, 1675, 1473, 1617, 1394, 1000, 1000, 1000], "policy_default_reward": [-2.7026660607659956, 14.458229657347212, -4.078005532204889, 14.334491503941317, 11.819362009990394, -1.3370410223903324, 13.618307929457542, -0.7160082185234131, -5.258338319486444, 12.112034006705112, -3.978131906381063, -2.3856195103099695, -6.496886345768102, 11.39390403648099, 12.6416892031279, -4.598665285739648, 13.771773114506862, 12.440385266761036, 12.055577110854694, 13.359594184967754, 12.588087035273837, 14.445483274064754, 14.431432495244284, 21.208312329313]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38625360356102556, "mean_inference_ms": 0.6217906476501358, "mean_action_processing_ms": 0.19316832597412742, "mean_env_wait_ms": 1.2677913905320717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005170702934265137, "StateBufferConnector_ms": 0.0034123659133911133, "ViewRequirementAgentConnector_ms": 0.09967982769012451}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27335, "num_agent_steps_trained": 27335, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 343.890078264578, "num_env_steps_trained_throughput_per_sec": 343.890078264578, "timesteps_total": 12000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 27335, "timers": {"training_iteration_time_ms": 5642.637, "sample_time_ms": 5252.566, "load_time_ms": 4.341, "load_throughput": 460705.801, "learn_time_ms": 383.55, "learn_throughput": 5214.447, "synch_weights_time_ms": 1.676}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 27335, "num_agent_steps_trained": 27335}, "done": false, "episodes_total": 8, "training_iteration": 6, "trial_id": "8692c_00000", "date": "2023-12-26_23-01-28", "timestamp": 1703602888, "time_this_iter_s": 5.81965708732605, "time_total_s": 33.87584376335144, "pid": 65201, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "concat", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7ffa4ce4cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "concat", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 33.87584376335144, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 21.4, "ram_util_percent": 58.7}, "success": 0.0, "crash": 0.0, "out": 0.3020833333333333, "max_step": 0.6979166666666666, "length": 1389.125, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 21.64091261955835}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.32407407407407407, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.6759259259259259, "max_step_rate_min": 0.25, "max_step_rate_max": 1.0, "velocity_mean": 0.23193820448762667, "velocity_min": 0.21167976546197248, "velocity_max": 0.2689032050307957, "steering_mean": -0.02946927402119738, "steering_min": -0.06920825686882032, "steering_max": 0.019153391698311116, "step_reward_mean": 0.014212224847235647, "step_reward_min": 0.011592334061931834, "step_reward_max": 0.019127090396203725, "acceleration_mean": 0.02126464415026507, "acceleration_min": -0.03466610974687935, "acceleration_max": 0.11862219128888389, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 851.1944444444445, "episode_length_min": 693.5, "episode_length_max": 999.0, "episode_reward_mean": 12.20140639192801, "episode_reward_min": 8.039283671949732, "episode_reward_max": 17.795328237204778, "num_neighbours_mean": 0.20989400498703698, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.111111111111111, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 36.60561523924029, "environment_reward_total_min": 25.338446495154507, "environment_reward_total_max": 66.52402039799657}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09999999999999996, "cur_lr": 0.0003, "total_loss": 3.16790976524353, "policy_loss": 0.008422129559848043, "vf_loss": 3.1588210079405044, "vf_explained_var": 0.0012388613488939074, "kl": 0.00666644351505157, "entropy": 2.6221026791466606, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 268.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 14000, "num_env_steps_trained": 14000, "num_agent_steps_sampled": 32154, "num_agent_steps_trained": 32154}, "sampler_results": {"episode_reward_max": 46.553162546527055, "episode_reward_min": 2.159555562314189, "episode_reward_mean": 24.40894038922154, "episode_len_mean": 1450.7777777777778, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -6.496886345768102}, "policy_reward_max": {"default": 21.208312329313}, "policy_reward_mean": {"default": 7.845730839392642}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.32407407407407407, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.6759259259259259, "max_step_rate_min": 0.25, "max_step_rate_max": 1.0, "velocity_mean": 0.23193820448762667, "velocity_min": 0.21167976546197248, "velocity_max": 0.2689032050307957, "steering_mean": -0.02946927402119738, "steering_min": -0.06920825686882032, "steering_max": 0.019153391698311116, "step_reward_mean": 0.014212224847235647, "step_reward_min": 0.011592334061931834, "step_reward_max": 0.019127090396203725, "acceleration_mean": 0.02126464415026507, "acceleration_min": -0.03466610974687935, "acceleration_max": 0.11862219128888389, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 851.1944444444445, "episode_length_min": 693.5, "episode_length_max": 999.0, "episode_reward_mean": 12.20140639192801, "episode_reward_min": 8.039283671949732, "episode_reward_max": 17.795328237204778, "num_neighbours_mean": 0.20989400498703698, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.111111111111111, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 36.60561523924029, "environment_reward_total_min": 25.338446495154507, "environment_reward_total_max": 66.52402039799657}, "hist_stats": {"episode_reward": [22.01204956831763, 24.1006289170576, 2.159555562314189, 15.15308738353083, 21.61349309552819, 25.415171295822407, 27.033570309338618, 35.639744824557326, 46.553162546527055], "episode_lengths": [1954, 1675, 1473, 1617, 1394, 1000, 1000, 1000, 1944], "policy_default_reward": [-2.7026660607659956, 14.458229657347212, -4.078005532204889, 14.334491503941317, 11.819362009990394, -1.3370410223903324, 13.618307929457542, -0.7160082185234131, -5.258338319486444, 12.112034006705112, -3.978131906381063, -2.3856195103099695, -6.496886345768102, 11.39390403648099, 12.6416892031279, -4.598665285739648, 13.771773114506862, 12.440385266761036, 12.055577110854694, 13.359594184967754, 12.588087035273837, 14.445483274064754, 14.431432495244284, 21.208312329313, 8.615212015924918, -0.28514616183603536, 19.210454329546042, 19.0126423628922]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3878327857483787, "mean_inference_ms": 0.6230549365056268, "mean_action_processing_ms": 0.19437649629372064, "mean_env_wait_ms": 1.2743304848823604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052187177870008684, "StateBufferConnector_ms": 0.0033564037746853298, "ViewRequirementAgentConnector_ms": 0.09737014770507812}}, "episode_reward_max": 46.553162546527055, "episode_reward_min": 2.159555562314189, "episode_reward_mean": 7.845730839392642, "episode_len_mean": 1450.7777777777778, "episodes_this_iter": 1, "policy_reward_min": {"default": -6.496886345768102}, "policy_reward_max": {"default": 21.208312329313}, "policy_reward_mean": {"default": 7.845730839392642}, "hist_stats": {"episode_reward": [22.01204956831763, 24.1006289170576, 2.159555562314189, 15.15308738353083, 21.61349309552819, 25.415171295822407, 27.033570309338618, 35.639744824557326, 46.553162546527055], "episode_lengths": [1954, 1675, 1473, 1617, 1394, 1000, 1000, 1000, 1944], "policy_default_reward": [-2.7026660607659956, 14.458229657347212, -4.078005532204889, 14.334491503941317, 11.819362009990394, -1.3370410223903324, 13.618307929457542, -0.7160082185234131, -5.258338319486444, 12.112034006705112, -3.978131906381063, -2.3856195103099695, -6.496886345768102, 11.39390403648099, 12.6416892031279, -4.598665285739648, 13.771773114506862, 12.440385266761036, 12.055577110854694, 13.359594184967754, 12.588087035273837, 14.445483274064754, 14.431432495244284, 21.208312329313, 8.615212015924918, -0.28514616183603536, 19.210454329546042, 19.0126423628922]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3878327857483787, "mean_inference_ms": 0.6230549365056268, "mean_action_processing_ms": 0.19437649629372064, "mean_env_wait_ms": 1.2743304848823604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052187177870008684, "StateBufferConnector_ms": 0.0033564037746853298, "ViewRequirementAgentConnector_ms": 0.09737014770507812}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32154, "num_agent_steps_trained": 32154, "num_env_steps_sampled": 14000, "num_env_steps_trained": 14000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 356.9484481335711, "num_env_steps_trained_throughput_per_sec": 356.9484481335711, "timesteps_total": 14000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 32154, "timers": {"training_iteration_time_ms": 5636.979, "sample_time_ms": 5257.513, "load_time_ms": 4.386, "load_throughput": 456033.612, "learn_time_ms": 372.945, "learn_throughput": 5362.722, "synch_weights_time_ms": 1.649}, "counters": {"num_env_steps_sampled": 14000, "num_env_steps_trained": 14000, "num_agent_steps_sampled": 32154, "num_agent_steps_trained": 32154}, "done": false, "episodes_total": 9, "training_iteration": 7, "trial_id": "8692c_00000", "date": "2023-12-26_23-01-34", "timestamp": 1703602894, "time_this_iter_s": 5.606466770172119, "time_total_s": 39.48231053352356, "pid": 65201, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "concat", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7ffa4ce4cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "concat", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 39.48231053352356, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 22.0375, "ram_util_percent": 58.6875}, "success": 0.0, "crash": 0.0, "out": 0.32407407407407407, "max_step": 0.6759259259259259, "length": 1450.7777777777778, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 24.40894038922154}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.3333333333333333, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.6666666666666666, "max_step_rate_min": 0.25, "max_step_rate_max": 1.0, "velocity_mean": 0.23917514052518138, "velocity_min": 0.21167976546197248, "velocity_max": 0.3041154534129878, "steering_mean": -0.022532732643497585, "steering_min": -0.06920825686882032, "steering_max": 0.019683073291753752, "step_reward_mean": 0.015122838839975937, "step_reward_min": 0.011592334061931834, "step_reward_max": 0.023178126431603434, "acceleration_mean": 0.033123744638199275, "acceleration_min": -0.03466610974687935, "acceleration_max": 0.14572411119059078, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 839.6590909090909, "episode_length_min": 576.5, "episode_length_max": 999.0, "episode_reward_mean": 12.583878320090863, "episode_reward_min": 8.039283671949732, "episode_reward_max": 17.795328237204778, "num_neighbours_mean": 0.1885255925057544, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.090909090909091, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 37.5813568105542, "environment_reward_total_min": 25.338446495154507, "environment_reward_total_max": 66.52402039799657}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09999999999999996, "cur_lr": 0.0003, "total_loss": 1.2246806513932016, "policy_loss": 0.009215928324394756, "vf_loss": 1.214751891957389, "vf_explained_var": -0.00016687711079915363, "kl": 0.007128301604987225, "entropy": 2.6450387636820474, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 313.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 36919, "num_agent_steps_trained": 36919}, "sampler_results": {"episode_reward_max": 46.553162546527055, "episode_reward_min": 2.159555562314189, "episode_reward_mean": 24.87615609598956, "episode_len_mean": 1389.4545454545455, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"default": -7.367345438914269}, "policy_reward_max": {"default": 21.208312329313}, "policy_reward_mean": {"default": 8.048168148702507}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.3333333333333333, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.6666666666666666, "max_step_rate_min": 0.25, "max_step_rate_max": 1.0, "velocity_mean": 0.23917514052518138, "velocity_min": 0.21167976546197248, "velocity_max": 0.3041154534129878, "steering_mean": -0.022532732643497585, "steering_min": -0.06920825686882032, "steering_max": 0.019683073291753752, "step_reward_mean": 0.015122838839975937, "step_reward_min": 0.011592334061931834, "step_reward_max": 0.023178126431603434, "acceleration_mean": 0.033123744638199275, "acceleration_min": -0.03466610974687935, "acceleration_max": 0.14572411119059078, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 839.6590909090909, "episode_length_min": 576.5, "episode_length_max": 999.0, "episode_reward_mean": 12.583878320090863, "episode_reward_min": 8.039283671949732, "episode_reward_max": 17.795328237204778, "num_neighbours_mean": 0.1885255925057544, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.090909090909091, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 37.5813568105542, "environment_reward_total_min": 25.338446495154507, "environment_reward_total_max": 66.52402039799657}, "hist_stats": {"episode_reward": [22.01204956831763, 24.1006289170576, 2.159555562314189, 15.15308738353083, 21.61349309552819, 25.415171295822407, 27.033570309338618, 35.639744824557326, 46.553162546527055, 23.456218052086236, 30.50103550080506], "episode_lengths": [1954, 1675, 1473, 1617, 1394, 1000, 1000, 1000, 1944, 1227, 1000], "policy_default_reward": [-2.7026660607659956, 14.458229657347212, -4.078005532204889, 14.334491503941317, 11.819362009990394, -1.3370410223903324, 13.618307929457542, -0.7160082185234131, -5.258338319486444, 12.112034006705112, -3.978131906381063, -2.3856195103099695, -6.496886345768102, 11.39390403648099, 12.6416892031279, -4.598665285739648, 13.771773114506862, 12.440385266761036, 12.055577110854694, 13.359594184967754, 12.588087035273837, 14.445483274064754, 14.431432495244284, 21.208312329313, 8.615212015924918, -0.28514616183603536, 19.210454329546042, 19.0126423628922, 14.080240088185647, -7.367345438914269, 20.79728392678364, -4.053960523968819, 14.825364964934213, 15.67567053587086]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3910540817305605, "mean_inference_ms": 0.6254169120672871, "mean_action_processing_ms": 0.196532681126856, "mean_env_wait_ms": 1.2858759168532126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005366585471413352, "StateBufferConnector_ms": 0.0033985484730113635, "ViewRequirementAgentConnector_ms": 0.09974132884632457}}, "episode_reward_max": 46.553162546527055, "episode_reward_min": 2.159555562314189, "episode_reward_mean": 8.048168148702507, "episode_len_mean": 1389.4545454545455, "episodes_this_iter": 2, "policy_reward_min": {"default": -7.367345438914269}, "policy_reward_max": {"default": 21.208312329313}, "policy_reward_mean": {"default": 8.048168148702507}, "hist_stats": {"episode_reward": [22.01204956831763, 24.1006289170576, 2.159555562314189, 15.15308738353083, 21.61349309552819, 25.415171295822407, 27.033570309338618, 35.639744824557326, 46.553162546527055, 23.456218052086236, 30.50103550080506], "episode_lengths": [1954, 1675, 1473, 1617, 1394, 1000, 1000, 1000, 1944, 1227, 1000], "policy_default_reward": [-2.7026660607659956, 14.458229657347212, -4.078005532204889, 14.334491503941317, 11.819362009990394, -1.3370410223903324, 13.618307929457542, -0.7160082185234131, -5.258338319486444, 12.112034006705112, -3.978131906381063, -2.3856195103099695, -6.496886345768102, 11.39390403648099, 12.6416892031279, -4.598665285739648, 13.771773114506862, 12.440385266761036, 12.055577110854694, 13.359594184967754, 12.588087035273837, 14.445483274064754, 14.431432495244284, 21.208312329313, 8.615212015924918, -0.28514616183603536, 19.210454329546042, 19.0126423628922, 14.080240088185647, -7.367345438914269, 20.79728392678364, -4.053960523968819, 14.825364964934213, 15.67567053587086]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3910540817305605, "mean_inference_ms": 0.6254169120672871, "mean_action_processing_ms": 0.196532681126856, "mean_env_wait_ms": 1.2858759168532126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005366585471413352, "StateBufferConnector_ms": 0.0033985484730113635, "ViewRequirementAgentConnector_ms": 0.09974132884632457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36919, "num_agent_steps_trained": 36919, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 337.6244512541328, "num_env_steps_trained_throughput_per_sec": 337.6244512541328, "timesteps_total": 16000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 36919, "timers": {"training_iteration_time_ms": 5672.822, "sample_time_ms": 5299.005, "load_time_ms": 4.432, "load_throughput": 451255.171, "learn_time_ms": 367.276, "learn_throughput": 5445.501, "synch_weights_time_ms": 1.629}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 36919, "num_agent_steps_trained": 36919}, "done": false, "episodes_total": 11, "training_iteration": 8, "trial_id": "8692c_00000", "date": "2023-12-26_23-01-41", "timestamp": 1703602901, "time_this_iter_s": 5.927983045578003, "time_total_s": 45.41029357910156, "pid": 65201, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "concat", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7ffa4ce4cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "concat", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 45.41029357910156, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 21.509999999999998, "ram_util_percent": 58.70000000000001}, "success": 0.0, "crash": 0.0, "out": 0.3333333333333333, "max_step": 0.6666666666666666, "length": 1389.4545454545455, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 24.87615609598956}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.35555555555555557, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.6444444444444445, "max_step_rate_min": 0.25, "max_step_rate_max": 1.0, "velocity_mean": 0.24079513821032275, "velocity_min": 0.21167976546197248, "velocity_max": 0.3041154534129878, "steering_mean": -0.017259247521716592, "steering_min": -0.06920825686882032, "steering_max": 0.04074908881787433, "step_reward_mean": 0.015345347726979668, "step_reward_min": 0.011592334061931834, "step_reward_max": 0.023178126431603434, "acceleration_mean": 0.037787396240430086, "acceleration_min": -0.03466610974687935, "acceleration_max": 0.14572411119059078, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 830.0875, "episode_length_min": 576.5, "episode_length_max": 999.0, "episode_reward_mean": 12.609915700651477, "episode_reward_min": 8.039283671949732, "episode_reward_max": 17.795328237204778, "num_neighbours_mean": 0.1754365392671402, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.25, "num_active_agents_min": 2, "num_active_agents_max": 5, "environment_reward_total_mean": 39.82304661251561, "environment_reward_total_min": 25.338446495154507, "environment_reward_total_max": 66.52402039799657}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09999999999999996, "cur_lr": 0.0003000000000000001, "total_loss": 2.593104511499405, "policy_loss": -0.011292662099003791, "vf_loss": 2.603387576341629, "vf_explained_var": 0.005108000834782919, "kl": 0.010096031074256946, "entropy": 2.632298465569814, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 365.5, "diff_num_grad_updates_vs_sampler_policy": 29.5}}, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 43084, "num_agent_steps_trained": 43084}, "sampler_results": {"episode_reward_max": 46.553162546527055, "episode_reward_min": 2.159555562314189, "episode_reward_mean": 25.6784395337111, "episode_len_mean": 1431.4166666666667, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -7.367345438914269}, "policy_reward_max": {"default": 21.208312329313}, "policy_reward_mean": {"default": 7.9010583180649565}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.35555555555555557, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.6444444444444445, "max_step_rate_min": 0.25, "max_step_rate_max": 1.0, "velocity_mean": 0.24079513821032275, "velocity_min": 0.21167976546197248, "velocity_max": 0.3041154534129878, "steering_mean": -0.017259247521716592, "steering_min": -0.06920825686882032, "steering_max": 0.04074908881787433, "step_reward_mean": 0.015345347726979668, "step_reward_min": 0.011592334061931834, "step_reward_max": 0.023178126431603434, "acceleration_mean": 0.037787396240430086, "acceleration_min": -0.03466610974687935, "acceleration_max": 0.14572411119059078, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 830.0875, "episode_length_min": 576.5, "episode_length_max": 999.0, "episode_reward_mean": 12.609915700651477, "episode_reward_min": 8.039283671949732, "episode_reward_max": 17.795328237204778, "num_neighbours_mean": 0.1754365392671402, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.25, "num_active_agents_min": 2, "num_active_agents_max": 5, "environment_reward_total_mean": 39.82304661251561, "environment_reward_total_min": 25.338446495154507, "environment_reward_total_max": 66.52402039799657}, "hist_stats": {"episode_reward": [22.01204956831763, 24.1006289170576, 2.159555562314189, 15.15308738353083, 21.61349309552819, 25.415171295822407, 27.033570309338618, 35.639744824557326, 46.553162546527055, 23.456218052086236, 30.50103550080506, 34.50355734864802], "episode_lengths": [1954, 1675, 1473, 1617, 1394, 1000, 1000, 1000, 1944, 1227, 1000, 1893], "policy_default_reward": [-2.7026660607659956, 14.458229657347212, -4.078005532204889, 14.334491503941317, 11.819362009990394, -1.3370410223903324, 13.618307929457542, -0.7160082185234131, -5.258338319486444, 12.112034006705112, -3.978131906381063, -2.3856195103099695, -6.496886345768102, 11.39390403648099, 12.6416892031279, -4.598665285739648, 13.771773114506862, 12.440385266761036, 12.055577110854694, 13.359594184967754, 12.588087035273837, 14.445483274064754, 14.431432495244284, 21.208312329313, 8.615212015924918, -0.28514616183603536, 19.210454329546042, 19.0126423628922, 14.080240088185647, -7.367345438914269, 20.79728392678364, -4.053960523968819, 14.825364964934213, 15.67567053587086, 1.8467976072835377, 6.0339170896642536, -3.0082175797854944, 14.994180285527538, 14.636879945958215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3926733972218403, "mean_inference_ms": 0.6263890981210702, "mean_action_processing_ms": 0.1976985793374956, "mean_env_wait_ms": 1.2913711075127055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005408128102620442, "StateBufferConnector_ms": 0.003353754679361979, "ViewRequirementAgentConnector_ms": 0.09778539339701335}}, "episode_reward_max": 46.553162546527055, "episode_reward_min": 2.159555562314189, "episode_reward_mean": 7.9010583180649565, "episode_len_mean": 1431.4166666666667, "episodes_this_iter": 1, "policy_reward_min": {"default": -7.367345438914269}, "policy_reward_max": {"default": 21.208312329313}, "policy_reward_mean": {"default": 7.9010583180649565}, "hist_stats": {"episode_reward": [22.01204956831763, 24.1006289170576, 2.159555562314189, 15.15308738353083, 21.61349309552819, 25.415171295822407, 27.033570309338618, 35.639744824557326, 46.553162546527055, 23.456218052086236, 30.50103550080506, 34.50355734864802], "episode_lengths": [1954, 1675, 1473, 1617, 1394, 1000, 1000, 1000, 1944, 1227, 1000, 1893], "policy_default_reward": [-2.7026660607659956, 14.458229657347212, -4.078005532204889, 14.334491503941317, 11.819362009990394, -1.3370410223903324, 13.618307929457542, -0.7160082185234131, -5.258338319486444, 12.112034006705112, -3.978131906381063, -2.3856195103099695, -6.496886345768102, 11.39390403648099, 12.6416892031279, -4.598665285739648, 13.771773114506862, 12.440385266761036, 12.055577110854694, 13.359594184967754, 12.588087035273837, 14.445483274064754, 14.431432495244284, 21.208312329313, 8.615212015924918, -0.28514616183603536, 19.210454329546042, 19.0126423628922, 14.080240088185647, -7.367345438914269, 20.79728392678364, -4.053960523968819, 14.825364964934213, 15.67567053587086, 1.8467976072835377, 6.0339170896642536, -3.0082175797854944, 14.994180285527538, 14.636879945958215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3926733972218403, "mean_inference_ms": 0.6263890981210702, "mean_action_processing_ms": 0.1976985793374956, "mean_env_wait_ms": 1.2913711075127055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005408128102620442, "StateBufferConnector_ms": 0.003353754679361979, "ViewRequirementAgentConnector_ms": 0.09778539339701335}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43084, "num_agent_steps_trained": 43084, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 315.7085773925987, "num_env_steps_trained_throughput_per_sec": 315.7085773925987, "timesteps_total": 18000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 43084, "timers": {"training_iteration_time_ms": 5746.39, "sample_time_ms": 5361.597, "load_time_ms": 4.607, "load_throughput": 434165.494, "learn_time_ms": 378.103, "learn_throughput": 5289.569, "synch_weights_time_ms": 1.601}, "counters": {"num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 43084, "num_agent_steps_trained": 43084}, "done": false, "episodes_total": 12, "training_iteration": 9, "trial_id": "8692c_00000", "date": "2023-12-26_23-01-47", "timestamp": 1703602907, "time_this_iter_s": 6.338518142700195, "time_total_s": 51.74881172180176, "pid": 65201, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "concat", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7ffa4ce4cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "concat", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 51.74881172180176, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 22.444444444444443, "ram_util_percent": 58.6888888888889}, "success": 0.0, "crash": 0.0, "out": 0.35555555555555557, "max_step": 0.6444444444444445, "length": 1431.4166666666667, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 25.6784395337111}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.32857142857142857, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.6714285714285715, "max_step_rate_min": 0.25, "max_step_rate_max": 1.0, "velocity_mean": 0.23900824002610982, "velocity_min": 0.21167976546197248, "velocity_max": 0.3041154534129878, "steering_mean": -0.013506747445756131, "steering_min": -0.06920825686882032, "steering_max": 0.04074908881787433, "step_reward_mean": 0.015089291480552047, "step_reward_min": 0.011592334061931834, "step_reward_max": 0.023178126431603434, "acceleration_mean": 0.03492204680102412, "acceleration_min": -0.03466610974687935, "acceleration_max": 0.14572411119059078, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 837.717857142857, "episode_length_min": 576.5, "episode_length_max": 999.0, "episode_reward_mean": 12.49739448330275, "episode_reward_min": 8.039283671949732, "episode_reward_max": 17.795328237204778, "num_neighbours_mean": 0.21522474136525643, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.142857142857143, "num_active_agents_min": 2, "num_active_agents_max": 5, "environment_reward_total_mean": 38.32738951945593, "environment_reward_total_min": 24.453418306133642, "environment_reward_total_max": 66.52402039799657}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 0.5902863804250955, "policy_loss": -0.03627765458077192, "vf_loss": 0.626146870595403, "vf_explained_var": 0.020611113309860228, "kl": 0.004171735997806536, "entropy": 2.7503970861434937, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 415.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 47333, "num_agent_steps_trained": 47333}, "sampler_results": {"episode_reward_max": 46.553162546527055, "episode_reward_min": 2.159555562314189, "episode_reward_mean": 25.494174392823016, "episode_len_mean": 1393.5, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"default": -7.367345438914269}, "policy_reward_max": {"default": 21.208312329313}, "policy_reward_mean": {"default": 8.111782761352782}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.32857142857142857, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.6714285714285715, "max_step_rate_min": 0.25, "max_step_rate_max": 1.0, "velocity_mean": 0.23900824002610982, "velocity_min": 0.21167976546197248, "velocity_max": 0.3041154534129878, "steering_mean": -0.013506747445756131, "steering_min": -0.06920825686882032, "steering_max": 0.04074908881787433, "step_reward_mean": 0.015089291480552047, "step_reward_min": 0.011592334061931834, "step_reward_max": 0.023178126431603434, "acceleration_mean": 0.03492204680102412, "acceleration_min": -0.03466610974687935, "acceleration_max": 0.14572411119059078, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 837.717857142857, "episode_length_min": 576.5, "episode_length_max": 999.0, "episode_reward_mean": 12.49739448330275, "episode_reward_min": 8.039283671949732, "episode_reward_max": 17.795328237204778, "num_neighbours_mean": 0.21522474136525643, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.142857142857143, "num_active_agents_min": 2, "num_active_agents_max": 5, "environment_reward_total_mean": 38.32738951945593, "environment_reward_total_min": 24.453418306133642, "environment_reward_total_max": 66.52402039799657}, "hist_stats": {"episode_reward": [22.01204956831763, 24.1006289170576, 2.159555562314189, 15.15308738353083, 21.61349309552819, 25.415171295822407, 27.033570309338618, 35.639744824557326, 46.553162546527055, 23.456218052086236, 30.50103550080506, 34.50355734864802, 24.251898912940707, 24.52526818204832], "episode_lengths": [1954, 1675, 1473, 1617, 1394, 1000, 1000, 1000, 1944, 1227, 1000, 1893, 1332, 1000], "policy_default_reward": [-2.7026660607659956, 14.458229657347212, -4.078005532204889, 14.334491503941317, 11.819362009990394, -1.3370410223903324, 13.618307929457542, -0.7160082185234131, -5.258338319486444, 12.112034006705112, -3.978131906381063, -2.3856195103099695, -6.496886345768102, 11.39390403648099, 12.6416892031279, -4.598665285739648, 13.771773114506862, 12.440385266761036, 12.055577110854694, 13.359594184967754, 12.588087035273837, 14.445483274064754, 14.431432495244284, 21.208312329313, 8.615212015924918, -0.28514616183603536, 19.210454329546042, 19.0126423628922, 14.080240088185647, -7.367345438914269, 20.79728392678364, -4.053960523968819, 14.825364964934213, 15.67567053587086, 1.8467976072835377, 6.0339170896642536, -3.0082175797854944, 14.994180285527538, 14.636879945958215, 13.499410447980349, -5.27958609264428, 16.03207455760466, 12.117692164444914, 12.40757601760339]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3953223353021088, "mean_inference_ms": 0.627751225604559, "mean_action_processing_ms": 0.19949311896272018, "mean_env_wait_ms": 1.3005307808515225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005209445953369141, "StateBufferConnector_ms": 0.0034196036202566965, "ViewRequirementAgentConnector_ms": 0.09854521070207868}}, "episode_reward_max": 46.553162546527055, "episode_reward_min": 2.159555562314189, "episode_reward_mean": 8.111782761352782, "episode_len_mean": 1393.5, "episodes_this_iter": 2, "policy_reward_min": {"default": -7.367345438914269}, "policy_reward_max": {"default": 21.208312329313}, "policy_reward_mean": {"default": 8.111782761352782}, "hist_stats": {"episode_reward": [22.01204956831763, 24.1006289170576, 2.159555562314189, 15.15308738353083, 21.61349309552819, 25.415171295822407, 27.033570309338618, 35.639744824557326, 46.553162546527055, 23.456218052086236, 30.50103550080506, 34.50355734864802, 24.251898912940707, 24.52526818204832], "episode_lengths": [1954, 1675, 1473, 1617, 1394, 1000, 1000, 1000, 1944, 1227, 1000, 1893, 1332, 1000], "policy_default_reward": [-2.7026660607659956, 14.458229657347212, -4.078005532204889, 14.334491503941317, 11.819362009990394, -1.3370410223903324, 13.618307929457542, -0.7160082185234131, -5.258338319486444, 12.112034006705112, -3.978131906381063, -2.3856195103099695, -6.496886345768102, 11.39390403648099, 12.6416892031279, -4.598665285739648, 13.771773114506862, 12.440385266761036, 12.055577110854694, 13.359594184967754, 12.588087035273837, 14.445483274064754, 14.431432495244284, 21.208312329313, 8.615212015924918, -0.28514616183603536, 19.210454329546042, 19.0126423628922, 14.080240088185647, -7.367345438914269, 20.79728392678364, -4.053960523968819, 14.825364964934213, 15.67567053587086, 1.8467976072835377, 6.0339170896642536, -3.0082175797854944, 14.994180285527538, 14.636879945958215, 13.499410447980349, -5.27958609264428, 16.03207455760466, 12.117692164444914, 12.40757601760339]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3953223353021088, "mean_inference_ms": 0.627751225604559, "mean_action_processing_ms": 0.19949311896272018, "mean_env_wait_ms": 1.3005307808515225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005209445953369141, "StateBufferConnector_ms": 0.0034196036202566965, "ViewRequirementAgentConnector_ms": 0.09854521070207868}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47333, "num_agent_steps_trained": 47333, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 350.773443708288, "num_env_steps_trained_throughput_per_sec": 350.773443708288, "timesteps_total": 20000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 47333, "timers": {"training_iteration_time_ms": 5741.916, "sample_time_ms": 5365.07, "load_time_ms": 4.679, "load_throughput": 427453.706, "learn_time_ms": 370.084, "learn_throughput": 5404.18, "synch_weights_time_ms": 1.615}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 47333, "num_agent_steps_trained": 47333}, "done": false, "episodes_total": 14, "training_iteration": 10, "trial_id": "8692c_00000", "date": "2023-12-26_23-01-54", "timestamp": 1703602914, "time_this_iter_s": 5.706080198287964, "time_total_s": 57.45489192008972, "pid": 65201, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "concat", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7ffa4ce4cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "concat", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 57.45489192008972, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 17.433333333333334, "ram_util_percent": 58.588888888888896}, "success": 0.0, "crash": 0.0, "out": 0.32857142857142857, "max_step": 0.6714285714285715, "length": 1393.5, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 25.494174392823016}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.33999999999999997, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.66, "max_step_rate_min": 0.25, "max_step_rate_max": 1.0, "velocity_mean": 0.23790142725719055, "velocity_min": 0.21167976546197248, "velocity_max": 0.3041154534129878, "steering_mean": -0.014485416337857823, "steering_min": -0.06920825686882032, "steering_max": 0.04074908881787433, "step_reward_mean": 0.014933406637077847, "step_reward_min": 0.011592334061931834, "step_reward_max": 0.023178126431603434, "acceleration_mean": 0.03173826138019627, "acceleration_min": -0.03466610974687935, "acceleration_max": 0.14572411119059078, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 825.3033333333333, "episode_length_min": 576.5, "episode_length_max": 999.0, "episode_reward_mean": 12.218054102197767, "episode_reward_min": 8.039283671949732, "episode_reward_max": 17.795328237204778, "num_neighbours_mean": 0.20432999396188326, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.2, "num_active_agents_min": 2, "num_active_agents_max": 5, "environment_reward_total_mean": 37.98750722261967, "environment_reward_total_min": 24.453418306133642, "environment_reward_total_max": 66.52402039799657}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05, "cur_lr": 0.0003, "total_loss": 2.303698006347986, "policy_loss": 0.028684738278388976, "vf_loss": 2.274524683505297, "vf_explained_var": -0.001907479763031006, "kl": 0.009772252409311477, "entropy": 2.670027643442154, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 455.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 22000, "num_env_steps_trained": 22000, "num_agent_steps_sampled": 51935, "num_agent_steps_trained": 51935}, "sampler_results": {"episode_reward_max": 46.553162546527055, "episode_reward_min": 2.159555562314189, "episode_reward_mean": 24.679520527085554, "episode_len_mean": 1411.2666666666667, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -7.367345438914269}, "policy_reward_max": {"default": 21.208312329313}, "policy_reward_mean": {"default": 7.712350164714238}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.33999999999999997, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.66, "max_step_rate_min": 0.25, "max_step_rate_max": 1.0, "velocity_mean": 0.23790142725719055, "velocity_min": 0.21167976546197248, "velocity_max": 0.3041154534129878, "steering_mean": -0.014485416337857823, "steering_min": -0.06920825686882032, "steering_max": 0.04074908881787433, "step_reward_mean": 0.014933406637077847, "step_reward_min": 0.011592334061931834, "step_reward_max": 0.023178126431603434, "acceleration_mean": 0.03173826138019627, "acceleration_min": -0.03466610974687935, "acceleration_max": 0.14572411119059078, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 825.3033333333333, "episode_length_min": 576.5, "episode_length_max": 999.0, "episode_reward_mean": 12.218054102197767, "episode_reward_min": 8.039283671949732, "episode_reward_max": 17.795328237204778, "num_neighbours_mean": 0.20432999396188326, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.2, "num_active_agents_min": 2, "num_active_agents_max": 5, "environment_reward_total_mean": 37.98750722261967, "environment_reward_total_min": 24.453418306133642, "environment_reward_total_max": 66.52402039799657}, "hist_stats": {"episode_reward": [22.01204956831763, 24.1006289170576, 2.159555562314189, 15.15308738353083, 21.61349309552819, 25.415171295822407, 27.033570309338618, 35.639744824557326, 46.553162546527055, 23.456218052086236, 30.50103550080506, 34.50355734864802, 24.251898912940707, 24.52526818204832, 13.274366406761066], "episode_lengths": [1954, 1675, 1473, 1617, 1394, 1000, 1000, 1000, 1944, 1227, 1000, 1893, 1332, 1000, 1660], "policy_default_reward": [-2.7026660607659956, 14.458229657347212, -4.078005532204889, 14.334491503941317, 11.819362009990394, -1.3370410223903324, 13.618307929457542, -0.7160082185234131, -5.258338319486444, 12.112034006705112, -3.978131906381063, -2.3856195103099695, -6.496886345768102, 11.39390403648099, 12.6416892031279, -4.598665285739648, 13.771773114506862, 12.440385266761036, 12.055577110854694, 13.359594184967754, 12.588087035273837, 14.445483274064754, 14.431432495244284, 21.208312329313, 8.615212015924918, -0.28514616183603536, 19.210454329546042, 19.0126423628922, 14.080240088185647, -7.367345438914269, 20.79728392678364, -4.053960523968819, 14.825364964934213, 15.67567053587086, 1.8467976072835377, 6.0339170896642536, -3.0082175797854944, 14.994180285527538, 14.636879945958215, 13.499410447980349, -5.27958609264428, 16.03207455760466, 12.117692164444914, 12.40757601760339, 11.305452048131187, -5.460032886978165, -6.085180532903252, 13.514127778511307]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3961925753963671, "mean_inference_ms": 0.6283802915508186, "mean_action_processing_ms": 0.20011845882609197, "mean_env_wait_ms": 1.3035781332798402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005289713541666667, "StateBufferConnector_ms": 0.0033807754516601562, "ViewRequirementAgentConnector_ms": 0.09665330251057942}}, "episode_reward_max": 46.553162546527055, "episode_reward_min": 2.159555562314189, "episode_reward_mean": 7.712350164714238, "episode_len_mean": 1411.2666666666667, "episodes_this_iter": 1, "policy_reward_min": {"default": -7.367345438914269}, "policy_reward_max": {"default": 21.208312329313}, "policy_reward_mean": {"default": 7.712350164714238}, "hist_stats": {"episode_reward": [22.01204956831763, 24.1006289170576, 2.159555562314189, 15.15308738353083, 21.61349309552819, 25.415171295822407, 27.033570309338618, 35.639744824557326, 46.553162546527055, 23.456218052086236, 30.50103550080506, 34.50355734864802, 24.251898912940707, 24.52526818204832, 13.274366406761066], "episode_lengths": [1954, 1675, 1473, 1617, 1394, 1000, 1000, 1000, 1944, 1227, 1000, 1893, 1332, 1000, 1660], "policy_default_reward": [-2.7026660607659956, 14.458229657347212, -4.078005532204889, 14.334491503941317, 11.819362009990394, -1.3370410223903324, 13.618307929457542, -0.7160082185234131, -5.258338319486444, 12.112034006705112, -3.978131906381063, -2.3856195103099695, -6.496886345768102, 11.39390403648099, 12.6416892031279, -4.598665285739648, 13.771773114506862, 12.440385266761036, 12.055577110854694, 13.359594184967754, 12.588087035273837, 14.445483274064754, 14.431432495244284, 21.208312329313, 8.615212015924918, -0.28514616183603536, 19.210454329546042, 19.0126423628922, 14.080240088185647, -7.367345438914269, 20.79728392678364, -4.053960523968819, 14.825364964934213, 15.67567053587086, 1.8467976072835377, 6.0339170896642536, -3.0082175797854944, 14.994180285527538, 14.636879945958215, 13.499410447980349, -5.27958609264428, 16.03207455760466, 12.117692164444914, 12.40757601760339, 11.305452048131187, -5.460032886978165, -6.085180532903252, 13.514127778511307]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3961925753963671, "mean_inference_ms": 0.6283802915508186, "mean_action_processing_ms": 0.20011845882609197, "mean_env_wait_ms": 1.3035781332798402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005289713541666667, "StateBufferConnector_ms": 0.0033807754516601562, "ViewRequirementAgentConnector_ms": 0.09665330251057942}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51935, "num_agent_steps_trained": 51935, "num_env_steps_sampled": 22000, "num_env_steps_trained": 22000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 373.6757477962391, "num_env_steps_trained_throughput_per_sec": 373.6757477962391, "timesteps_total": 22000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 51935, "timers": {"training_iteration_time_ms": 5721.771, "sample_time_ms": 5403.636, "load_time_ms": 4.84, "load_throughput": 413199.354, "learn_time_ms": 311.277, "learn_throughput": 6425.14, "synch_weights_time_ms": 1.584}, "counters": {"num_env_steps_sampled": 22000, "num_env_steps_trained": 22000, "num_agent_steps_sampled": 51935, "num_agent_steps_trained": 51935}, "done": false, "episodes_total": 15, "training_iteration": 11, "trial_id": "8692c_00000", "date": "2023-12-26_23-01-59", "timestamp": 1703602919, "time_this_iter_s": 5.356578826904297, "time_total_s": 62.81147074699402, "pid": 65201, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "concat", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7ffa4ce4cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "concat", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 62.81147074699402, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 22.6875, "ram_util_percent": 58.6125}, "success": 0.0, "crash": 0.0, "out": 0.33999999999999997, "max_step": 0.66, "length": 1411.2666666666667, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 24.679520527085554}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.3, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.7, "max_step_rate_min": 0.25, "max_step_rate_max": 1.0, "velocity_mean": 0.238590845584633, "velocity_min": 0.21167976546197248, "velocity_max": 0.3041154534129878, "steering_mean": -0.013690455095382095, "steering_min": -0.06920825686882032, "steering_max": 0.04074908881787433, "step_reward_mean": 0.015034173398002327, "step_reward_min": 0.011592334061931834, "step_reward_max": 0.023178126431603434, "acceleration_mean": 0.0337673161224692, "acceleration_min": -0.03466610974687935, "acceleration_max": 0.14572411119059078, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 845.7382352941177, "episode_length_min": 576.5, "episode_length_max": 999.0, "episode_reward_mean": 12.63641646438991, "episode_reward_min": 8.039283671949732, "episode_reward_max": 17.795328237204778, "num_neighbours_mean": 0.18029117114283813, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0588235294117645, "num_active_agents_min": 2, "num_active_agents_max": 5, "environment_reward_total_mean": 37.229949709565815, "environment_reward_total_min": 24.453418306133642, "environment_reward_total_max": 66.52402039799657}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0003, "total_loss": 0.00569988526403904, "policy_loss": -0.03459454466189657, "vf_loss": 0.03910940981337002, "vf_explained_var": -0.009532201290130615, "kl": 0.02370036066235376, "entropy": 2.5508533341544015, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 493.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 55935, "num_agent_steps_trained": 55935}, "sampler_results": {"episode_reward_max": 46.553162546527055, "episode_reward_min": 2.159555562314189, "episode_reward_mean": 25.489544391029774, "episode_len_mean": 1362.8823529411766, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"default": -7.367345438914269}, "policy_reward_max": {"default": 21.208312329313}, "policy_reward_mean": {"default": 8.333120281682813}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.3, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.7, "max_step_rate_min": 0.25, "max_step_rate_max": 1.0, "velocity_mean": 0.238590845584633, "velocity_min": 0.21167976546197248, "velocity_max": 0.3041154534129878, "steering_mean": -0.013690455095382095, "steering_min": -0.06920825686882032, "steering_max": 0.04074908881787433, "step_reward_mean": 0.015034173398002327, "step_reward_min": 0.011592334061931834, "step_reward_max": 0.023178126431603434, "acceleration_mean": 0.0337673161224692, "acceleration_min": -0.03466610974687935, "acceleration_max": 0.14572411119059078, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 845.7382352941177, "episode_length_min": 576.5, "episode_length_max": 999.0, "episode_reward_mean": 12.63641646438991, "episode_reward_min": 8.039283671949732, "episode_reward_max": 17.795328237204778, "num_neighbours_mean": 0.18029117114283813, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0588235294117645, "num_active_agents_min": 2, "num_active_agents_max": 5, "environment_reward_total_mean": 37.229949709565815, "environment_reward_total_min": 24.453418306133642, "environment_reward_total_max": 66.52402039799657}, "hist_stats": {"episode_reward": [22.01204956831763, 24.1006289170576, 2.159555562314189, 15.15308738353083, 21.61349309552819, 25.415171295822407, 27.033570309338618, 35.639744824557326, 46.553162546527055, 23.456218052086236, 30.50103550080506, 34.50355734864802, 24.251898912940707, 24.52526818204832, 13.274366406761066, 33.66680323700023, 29.462643504222655], "episode_lengths": [1954, 1675, 1473, 1617, 1394, 1000, 1000, 1000, 1944, 1227, 1000, 1893, 1332, 1000, 1660, 1000, 1000], "policy_default_reward": [-2.7026660607659956, 14.458229657347212, -4.078005532204889, 14.334491503941317, 11.819362009990394, -1.3370410223903324, 13.618307929457542, -0.7160082185234131, -5.258338319486444, 12.112034006705112, -3.978131906381063, -2.3856195103099695, -6.496886345768102, 11.39390403648099, 12.6416892031279, -4.598665285739648, 13.771773114506862, 12.440385266761036, 12.055577110854694, 13.359594184967754, 12.588087035273837, 14.445483274064754, 14.431432495244284, 21.208312329313, 8.615212015924918, -0.28514616183603536, 19.210454329546042, 19.0126423628922, 14.080240088185647, -7.367345438914269, 20.79728392678364, -4.053960523968819, 14.825364964934213, 15.67567053587086, 1.8467976072835377, 6.0339170896642536, -3.0082175797854944, 14.994180285527538, 14.636879945958215, 13.499410447980349, -5.27958609264428, 16.03207455760466, 12.117692164444914, 12.40757601760339, 11.305452048131187, -5.460032886978165, -6.085180532903252, 13.514127778511307, 15.881469916168019, 17.785333320832127, 15.768113150889464, 13.694530353333201]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3976073142198574, "mean_inference_ms": 0.6291586655014438, "mean_action_processing_ms": 0.20124701054277563, "mean_env_wait_ms": 1.3089061199647847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005549543044146369, "StateBufferConnector_ms": 0.0033995684455422792, "ViewRequirementAgentConnector_ms": 0.101166612961713}}, "episode_reward_max": 46.553162546527055, "episode_reward_min": 2.159555562314189, "episode_reward_mean": 8.333120281682813, "episode_len_mean": 1362.8823529411766, "episodes_this_iter": 2, "policy_reward_min": {"default": -7.367345438914269}, "policy_reward_max": {"default": 21.208312329313}, "policy_reward_mean": {"default": 8.333120281682813}, "hist_stats": {"episode_reward": [22.01204956831763, 24.1006289170576, 2.159555562314189, 15.15308738353083, 21.61349309552819, 25.415171295822407, 27.033570309338618, 35.639744824557326, 46.553162546527055, 23.456218052086236, 30.50103550080506, 34.50355734864802, 24.251898912940707, 24.52526818204832, 13.274366406761066, 33.66680323700023, 29.462643504222655], "episode_lengths": [1954, 1675, 1473, 1617, 1394, 1000, 1000, 1000, 1944, 1227, 1000, 1893, 1332, 1000, 1660, 1000, 1000], "policy_default_reward": [-2.7026660607659956, 14.458229657347212, -4.078005532204889, 14.334491503941317, 11.819362009990394, -1.3370410223903324, 13.618307929457542, -0.7160082185234131, -5.258338319486444, 12.112034006705112, -3.978131906381063, -2.3856195103099695, -6.496886345768102, 11.39390403648099, 12.6416892031279, -4.598665285739648, 13.771773114506862, 12.440385266761036, 12.055577110854694, 13.359594184967754, 12.588087035273837, 14.445483274064754, 14.431432495244284, 21.208312329313, 8.615212015924918, -0.28514616183603536, 19.210454329546042, 19.0126423628922, 14.080240088185647, -7.367345438914269, 20.79728392678364, -4.053960523968819, 14.825364964934213, 15.67567053587086, 1.8467976072835377, 6.0339170896642536, -3.0082175797854944, 14.994180285527538, 14.636879945958215, 13.499410447980349, -5.27958609264428, 16.03207455760466, 12.117692164444914, 12.40757601760339, 11.305452048131187, -5.460032886978165, -6.085180532903252, 13.514127778511307, 15.881469916168019, 17.785333320832127, 15.768113150889464, 13.694530353333201]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3976073142198574, "mean_inference_ms": 0.6291586655014438, "mean_action_processing_ms": 0.20124701054277563, "mean_env_wait_ms": 1.3089061199647847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005549543044146369, "StateBufferConnector_ms": 0.0033995684455422792, "ViewRequirementAgentConnector_ms": 0.101166612961713}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55935, "num_agent_steps_trained": 55935, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 357.347430352121, "num_env_steps_trained_throughput_per_sec": 357.347430352121, "timesteps_total": 24000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 55935, "timers": {"training_iteration_time_ms": 5757.222, "sample_time_ms": 5437.458, "load_time_ms": 4.944, "load_throughput": 404517.849, "learn_time_ms": 312.792, "learn_throughput": 6394.029, "synch_weights_time_ms": 1.576}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 55935, "num_agent_steps_trained": 55935}, "done": false, "episodes_total": 17, "training_iteration": 12, "trial_id": "8692c_00000", "date": "2023-12-26_23-02-05", "timestamp": 1703602925, "time_this_iter_s": 5.601561546325684, "time_total_s": 68.4130322933197, "pid": 65201, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "concat", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7ffa4ce4cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "concat", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 68.4130322933197, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 17.2625, "ram_util_percent": 58.650000000000006}, "success": 0.0, "crash": 0.0, "out": 0.3, "max_step": 0.7, "length": 1362.8823529411766, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 25.489544391029774}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.3078947368421052, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.6921052631578947, "max_step_rate_min": 0.25, "max_step_rate_max": 1.0, "velocity_mean": 0.24234368496484332, "velocity_min": 0.21167976546197248, "velocity_max": 0.3041154534129878, "steering_mean": -0.01247753786552441, "steering_min": -0.06920825686882032, "steering_max": 0.04074908881787433, "step_reward_mean": 0.015515022139457654, "step_reward_min": 0.011592334061931834, "step_reward_max": 0.023178126431603434, "acceleration_mean": 0.040219625656862205, "acceleration_min": -0.03466610974687935, "acceleration_max": 0.14675640095741416, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 848.5815789473684, "episode_length_min": 576.5, "episode_length_max": 999.0, "episode_reward_mean": 13.073033355064814, "episode_reward_min": 8.039283671949732, "episode_reward_max": 17.795328237204778, "num_neighbours_mean": 0.17913315524293633, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0526315789473686, "num_active_agents_min": 2, "num_active_agents_max": 5, "environment_reward_total_mean": 38.58625818868379, "environment_reward_total_min": 24.453418306133642, "environment_reward_total_max": 66.52402039799657}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.07500000000000002, "cur_lr": 0.0003, "total_loss": 2.4675758486820594, "policy_loss": 0.006470660699738396, "vf_loss": 2.4601304627127116, "vf_explained_var": 0.010574022928873697, "kl": 0.012996852377222805, "entropy": 2.4462616973453097, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 533.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 26000, "num_env_steps_trained": 26000, "num_agent_steps_sampled": 60765, "num_agent_steps_trained": 60765}, "sampler_results": {"episode_reward_max": 46.553162546527055, "episode_reward_min": 2.159555562314189, "episode_reward_mean": 26.507633966752643, "episode_len_mean": 1355.7368421052631, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"default": -7.367345438914269}, "policy_reward_max": {"default": 21.208312329313}, "policy_reward_mean": {"default": 8.683535264970695}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.3078947368421052, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.6921052631578947, "max_step_rate_min": 0.25, "max_step_rate_max": 1.0, "velocity_mean": 0.24234368496484332, "velocity_min": 0.21167976546197248, "velocity_max": 0.3041154534129878, "steering_mean": -0.01247753786552441, "steering_min": -0.06920825686882032, "steering_max": 0.04074908881787433, "step_reward_mean": 0.015515022139457654, "step_reward_min": 0.011592334061931834, "step_reward_max": 0.023178126431603434, "acceleration_mean": 0.040219625656862205, "acceleration_min": -0.03466610974687935, "acceleration_max": 0.14675640095741416, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 848.5815789473684, "episode_length_min": 576.5, "episode_length_max": 999.0, "episode_reward_mean": 13.073033355064814, "episode_reward_min": 8.039283671949732, "episode_reward_max": 17.795328237204778, "num_neighbours_mean": 0.17913315524293633, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0526315789473686, "num_active_agents_min": 2, "num_active_agents_max": 5, "environment_reward_total_mean": 38.58625818868379, "environment_reward_total_min": 24.453418306133642, "environment_reward_total_max": 66.52402039799657}, "hist_stats": {"episode_reward": [22.01204956831763, 24.1006289170576, 2.159555562314189, 15.15308738353083, 21.61349309552819, 25.415171295822407, 27.033570309338618, 35.639744824557326, 46.553162546527055, 23.456218052086236, 30.50103550080506, 34.50355734864802, 24.251898912940707, 24.52526818204832, 13.274366406761066, 33.66680323700023, 29.462643504222655, 34.141766171770904, 36.18102454902318], "episode_lengths": [1954, 1675, 1473, 1617, 1394, 1000, 1000, 1000, 1944, 1227, 1000, 1893, 1332, 1000, 1660, 1000, 1000, 1000, 1590], "policy_default_reward": [-2.7026660607659956, 14.458229657347212, -4.078005532204889, 14.334491503941317, 11.819362009990394, -1.3370410223903324, 13.618307929457542, -0.7160082185234131, -5.258338319486444, 12.112034006705112, -3.978131906381063, -2.3856195103099695, -6.496886345768102, 11.39390403648099, 12.6416892031279, -4.598665285739648, 13.771773114506862, 12.440385266761036, 12.055577110854694, 13.359594184967754, 12.588087035273837, 14.445483274064754, 14.431432495244284, 21.208312329313, 8.615212015924918, -0.28514616183603536, 19.210454329546042, 19.0126423628922, 14.080240088185647, -7.367345438914269, 20.79728392678364, -4.053960523968819, 14.825364964934213, 15.67567053587086, 1.8467976072835377, 6.0339170896642536, -3.0082175797854944, 14.994180285527538, 14.636879945958215, 13.499410447980349, -5.27958609264428, 16.03207455760466, 12.117692164444914, 12.40757601760339, 11.305452048131187, -5.460032886978165, -6.085180532903252, 13.514127778511307, 15.881469916168019, 17.785333320832127, 15.768113150889464, 13.694530353333201, 17.19380393815582, 16.947962233615073, 4.577734268367687, 1.021734687936636, 12.164768563506705, 18.416787029212202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39923734797536, "mean_inference_ms": 0.6295268533396717, "mean_action_processing_ms": 0.20212807252932402, "mean_env_wait_ms": 1.3130120092384485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005693184702019943, "StateBufferConnector_ms": 0.0033780148154810854, "ViewRequirementAgentConnector_ms": 0.10133793479517887}}, "episode_reward_max": 46.553162546527055, "episode_reward_min": 2.159555562314189, "episode_reward_mean": 8.683535264970695, "episode_len_mean": 1355.7368421052631, "episodes_this_iter": 2, "policy_reward_min": {"default": -7.367345438914269}, "policy_reward_max": {"default": 21.208312329313}, "policy_reward_mean": {"default": 8.683535264970695}, "hist_stats": {"episode_reward": [22.01204956831763, 24.1006289170576, 2.159555562314189, 15.15308738353083, 21.61349309552819, 25.415171295822407, 27.033570309338618, 35.639744824557326, 46.553162546527055, 23.456218052086236, 30.50103550080506, 34.50355734864802, 24.251898912940707, 24.52526818204832, 13.274366406761066, 33.66680323700023, 29.462643504222655, 34.141766171770904, 36.18102454902318], "episode_lengths": [1954, 1675, 1473, 1617, 1394, 1000, 1000, 1000, 1944, 1227, 1000, 1893, 1332, 1000, 1660, 1000, 1000, 1000, 1590], "policy_default_reward": [-2.7026660607659956, 14.458229657347212, -4.078005532204889, 14.334491503941317, 11.819362009990394, -1.3370410223903324, 13.618307929457542, -0.7160082185234131, -5.258338319486444, 12.112034006705112, -3.978131906381063, -2.3856195103099695, -6.496886345768102, 11.39390403648099, 12.6416892031279, -4.598665285739648, 13.771773114506862, 12.440385266761036, 12.055577110854694, 13.359594184967754, 12.588087035273837, 14.445483274064754, 14.431432495244284, 21.208312329313, 8.615212015924918, -0.28514616183603536, 19.210454329546042, 19.0126423628922, 14.080240088185647, -7.367345438914269, 20.79728392678364, -4.053960523968819, 14.825364964934213, 15.67567053587086, 1.8467976072835377, 6.0339170896642536, -3.0082175797854944, 14.994180285527538, 14.636879945958215, 13.499410447980349, -5.27958609264428, 16.03207455760466, 12.117692164444914, 12.40757601760339, 11.305452048131187, -5.460032886978165, -6.085180532903252, 13.514127778511307, 15.881469916168019, 17.785333320832127, 15.768113150889464, 13.694530353333201, 17.19380393815582, 16.947962233615073, 4.577734268367687, 1.021734687936636, 12.164768563506705, 18.416787029212202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39923734797536, "mean_inference_ms": 0.6295268533396717, "mean_action_processing_ms": 0.20212807252932402, "mean_env_wait_ms": 1.3130120092384485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005693184702019943, "StateBufferConnector_ms": 0.0033780148154810854, "ViewRequirementAgentConnector_ms": 0.10133793479517887}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60765, "num_agent_steps_trained": 60765, "num_env_steps_sampled": 26000, "num_env_steps_trained": 26000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 347.21801177541704, "num_env_steps_trained_throughput_per_sec": 347.21801177541704, "timesteps_total": 26000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 60765, "timers": {"training_iteration_time_ms": 5766.694, "sample_time_ms": 5451.884, "load_time_ms": 4.96, "load_throughput": 403228.672, "learn_time_ms": 307.857, "learn_throughput": 6496.533, "synch_weights_time_ms": 1.566}, "counters": {"num_env_steps_sampled": 26000, "num_env_steps_trained": 26000, "num_agent_steps_sampled": 60765, "num_agent_steps_trained": 60765}, "done": false, "episodes_total": 19, "training_iteration": 13, "trial_id": "8692c_00000", "date": "2023-12-26_23-02-11", "timestamp": 1703602931, "time_this_iter_s": 5.765355825424194, "time_total_s": 74.1783881187439, "pid": 65201, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "concat", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7ffa4ce4cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "concat", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 74.1783881187439, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 19.5, "ram_util_percent": 58.6875}, "success": 0.0, "crash": 0.0, "out": 0.3078947368421052, "max_step": 0.6921052631578947, "length": 1355.7368421052631, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 26.507633966752643}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.30916666666666665, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.6908333333333332, "max_step_rate_min": 0.25, "max_step_rate_max": 1.0, "velocity_mean": 0.2458239202487996, "velocity_min": 0.21167976546197248, "velocity_max": 0.3119483906439685, "steering_mean": -0.0155230347042635, "steering_min": -0.07338747464030622, "steering_max": 0.04074908881787433, "step_reward_mean": 0.015966795440802185, "step_reward_min": 0.011592334061931834, "step_reward_max": 0.024550488166348316, "acceleration_mean": 0.04655162376352, "acceleration_min": -0.03466610974687935, "acceleration_max": 0.1668595877900181, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 840.7358333333334, "episode_length_min": 576.5, "episode_length_max": 999.0, "episode_reward_mean": 13.268419403064453, "episode_reward_min": 8.039283671949732, "episode_reward_max": 17.795328237204778, "num_neighbours_mean": 0.1701764974807895, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.05, "num_active_agents_min": 2, "num_active_agents_max": 5, "environment_reward_total_mean": 39.20405842650824, "environment_reward_total_min": 24.453418306133642, "environment_reward_total_max": 66.52402039799657}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.07500000000000001, "cur_lr": 0.0003, "total_loss": 1.3475939142517745, "policy_loss": -0.023685599118471144, "vf_loss": 1.3708015400916338, "vf_explained_var": 0.0003456562757492065, "kl": 0.0063731939299035536, "entropy": 2.458557790517807, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 575.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 65207, "num_agent_steps_trained": 65207}, "sampler_results": {"episode_reward_max": 46.553162546527055, "episode_reward_min": 2.159555562314189, "episode_reward_mean": 27.232425497184796, "episode_len_mean": 1343.1, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -7.3700054587747745}, "policy_reward_max": {"default": 26.956188386121532}, "policy_reward_mean": {"default": 8.928664097437641}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.30916666666666665, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.6908333333333332, "max_step_rate_min": 0.25, "max_step_rate_max": 1.0, "velocity_mean": 0.2458239202487996, "velocity_min": 0.21167976546197248, "velocity_max": 0.3119483906439685, "steering_mean": -0.0155230347042635, "steering_min": -0.07338747464030622, "steering_max": 0.04074908881787433, "step_reward_mean": 0.015966795440802185, "step_reward_min": 0.011592334061931834, "step_reward_max": 0.024550488166348316, "acceleration_mean": 0.04655162376352, "acceleration_min": -0.03466610974687935, "acceleration_max": 0.1668595877900181, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 840.7358333333334, "episode_length_min": 576.5, "episode_length_max": 999.0, "episode_reward_mean": 13.268419403064453, "episode_reward_min": 8.039283671949732, "episode_reward_max": 17.795328237204778, "num_neighbours_mean": 0.1701764974807895, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.05, "num_active_agents_min": 2, "num_active_agents_max": 5, "environment_reward_total_mean": 39.20405842650824, "environment_reward_total_min": 24.453418306133642, "environment_reward_total_max": 66.52402039799657}, "hist_stats": {"episode_reward": [22.01204956831763, 24.1006289170576, 2.159555562314189, 15.15308738353083, 21.61349309552819, 25.415171295822407, 27.033570309338618, 35.639744824557326, 46.553162546527055, 23.456218052086236, 30.50103550080506, 34.50355734864802, 24.251898912940707, 24.52526818204832, 13.274366406761066, 33.66680323700023, 29.462643504222655, 34.141766171770904, 36.18102454902318, 41.003464575395725], "episode_lengths": [1954, 1675, 1473, 1617, 1394, 1000, 1000, 1000, 1944, 1227, 1000, 1893, 1332, 1000, 1660, 1000, 1000, 1000, 1590, 1103], "policy_default_reward": [-2.7026660607659956, 14.458229657347212, -4.078005532204889, 14.334491503941317, 11.819362009990394, -1.3370410223903324, 13.618307929457542, -0.7160082185234131, -5.258338319486444, 12.112034006705112, -3.978131906381063, -2.3856195103099695, -6.496886345768102, 11.39390403648099, 12.6416892031279, -4.598665285739648, 13.771773114506862, 12.440385266761036, 12.055577110854694, 13.359594184967754, 12.588087035273837, 14.445483274064754, 14.431432495244284, 21.208312329313, 8.615212015924918, -0.28514616183603536, 19.210454329546042, 19.0126423628922, 14.080240088185647, -7.367345438914269, 20.79728392678364, -4.053960523968819, 14.825364964934213, 15.67567053587086, 1.8467976072835377, 6.0339170896642536, -3.0082175797854944, 14.994180285527538, 14.636879945958215, 13.499410447980349, -5.27958609264428, 16.03207455760466, 12.117692164444914, 12.40757601760339, 11.305452048131187, -5.460032886978165, -6.085180532903252, 13.514127778511307, 15.881469916168019, 17.785333320832127, 15.768113150889464, 13.694530353333201, 17.19380393815582, 16.947962233615073, 4.577734268367687, 1.021734687936636, 12.164768563506705, 18.416787029212202, -7.3700054587747745, 21.417281648048995, 26.956188386121532]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3998241134264474, "mean_inference_ms": 0.6296386457768555, "mean_action_processing_ms": 0.20249451641304064, "mean_env_wait_ms": 1.3147380883989987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005587339401245117, "StateBufferConnector_ms": 0.0033473968505859375, "ViewRequirementAgentConnector_ms": 0.09977340698242188}}, "episode_reward_max": 46.553162546527055, "episode_reward_min": 2.159555562314189, "episode_reward_mean": 8.928664097437641, "episode_len_mean": 1343.1, "episodes_this_iter": 1, "policy_reward_min": {"default": -7.3700054587747745}, "policy_reward_max": {"default": 26.956188386121532}, "policy_reward_mean": {"default": 8.928664097437641}, "hist_stats": {"episode_reward": [22.01204956831763, 24.1006289170576, 2.159555562314189, 15.15308738353083, 21.61349309552819, 25.415171295822407, 27.033570309338618, 35.639744824557326, 46.553162546527055, 23.456218052086236, 30.50103550080506, 34.50355734864802, 24.251898912940707, 24.52526818204832, 13.274366406761066, 33.66680323700023, 29.462643504222655, 34.141766171770904, 36.18102454902318, 41.003464575395725], "episode_lengths": [1954, 1675, 1473, 1617, 1394, 1000, 1000, 1000, 1944, 1227, 1000, 1893, 1332, 1000, 1660, 1000, 1000, 1000, 1590, 1103], "policy_default_reward": [-2.7026660607659956, 14.458229657347212, -4.078005532204889, 14.334491503941317, 11.819362009990394, -1.3370410223903324, 13.618307929457542, -0.7160082185234131, -5.258338319486444, 12.112034006705112, -3.978131906381063, -2.3856195103099695, -6.496886345768102, 11.39390403648099, 12.6416892031279, -4.598665285739648, 13.771773114506862, 12.440385266761036, 12.055577110854694, 13.359594184967754, 12.588087035273837, 14.445483274064754, 14.431432495244284, 21.208312329313, 8.615212015924918, -0.28514616183603536, 19.210454329546042, 19.0126423628922, 14.080240088185647, -7.367345438914269, 20.79728392678364, -4.053960523968819, 14.825364964934213, 15.67567053587086, 1.8467976072835377, 6.0339170896642536, -3.0082175797854944, 14.994180285527538, 14.636879945958215, 13.499410447980349, -5.27958609264428, 16.03207455760466, 12.117692164444914, 12.40757601760339, 11.305452048131187, -5.460032886978165, -6.085180532903252, 13.514127778511307, 15.881469916168019, 17.785333320832127, 15.768113150889464, 13.694530353333201, 17.19380393815582, 16.947962233615073, 4.577734268367687, 1.021734687936636, 12.164768563506705, 18.416787029212202, -7.3700054587747745, 21.417281648048995, 26.956188386121532]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3998241134264474, "mean_inference_ms": 0.6296386457768555, "mean_action_processing_ms": 0.20249451641304064, "mean_env_wait_ms": 1.3147380883989987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005587339401245117, "StateBufferConnector_ms": 0.0033473968505859375, "ViewRequirementAgentConnector_ms": 0.09977340698242188}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65207, "num_agent_steps_trained": 65207, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 363.377164873297, "num_env_steps_trained_throughput_per_sec": 363.377164873297, "timesteps_total": 28000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 65207, "timers": {"training_iteration_time_ms": 5729.462, "sample_time_ms": 5418.67, "load_time_ms": 4.903, "load_throughput": 407873.31, "learn_time_ms": 303.943, "learn_throughput": 6580.185, "synch_weights_time_ms": 1.528}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 65207, "num_agent_steps_trained": 65207}, "done": false, "episodes_total": 20, "training_iteration": 14, "trial_id": "8692c_00000", "date": "2023-12-26_23-02-16", "timestamp": 1703602936, "time_this_iter_s": 5.508735656738281, "time_total_s": 79.68712377548218, "pid": 65201, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "concat", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7ffa4ce4cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "concat", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 79.68712377548218, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 19.862499999999997, "ram_util_percent": 58.7}, "success": 0.0, "crash": 0.0, "out": 0.30916666666666665, "max_step": 0.6908333333333332, "length": 1343.1, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 27.232425497184796}
