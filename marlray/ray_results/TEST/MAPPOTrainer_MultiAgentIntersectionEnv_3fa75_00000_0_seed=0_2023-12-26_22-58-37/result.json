{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.0, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.0, "max_step_rate_mean": 1.0, "max_step_rate_min": 1.0, "max_step_rate_max": 1.0, "velocity_mean": 0.2353747426964573, "velocity_min": 0.2353747426964573, "velocity_max": 0.2353747426964573, "steering_mean": 0.02205840490005157, "steering_min": 0.02205840490005157, "steering_max": 0.02205840490005157, "step_reward_mean": 0.014464028715024528, "step_reward_min": 0.014464028715024528, "step_reward_max": 0.014464028715024528, "acceleration_mean": 0.018587119138992584, "acceleration_min": 0.018587119138992584, "acceleration_max": 0.018587119138992584, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 999.0, "episode_length_min": 999.0, "episode_length_max": 999.0, "episode_reward_mean": 14.449564686309504, "episode_reward_min": 14.449564686309504, "episode_reward_max": 14.449564686309504, "num_neighbours_mean": 0.0, "num_neighbours_min": 0.0, "num_neighbours_max": 0.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 2.0, "num_active_agents_min": 2, "num_active_agents_max": 2, "environment_reward_total_mean": 28.899129372619008, "environment_reward_total_min": 28.899129372619008, "environment_reward_total_max": 28.899129372619008}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0003, "total_loss": 0.45522366666368075, "policy_loss": -0.03937147089413234, "vf_loss": 0.49360872126583544, "vf_explained_var": 0.005312478542327881, "kl": 0.004932056413963448, "entropy": 2.86297127859933, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 2000, "num_env_steps_trained": 2000, "num_agent_steps_sampled": 4025, "num_agent_steps_trained": 4025}, "sampler_results": {"episode_reward_max": 28.9388874783246, "episode_reward_min": 28.9388874783246, "episode_reward_mean": 28.9388874783246, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": 13.792646992032571}, "policy_reward_max": {"default": 15.146240486292044}, "policy_reward_mean": {"default": 14.469443739162308}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.0, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.0, "max_step_rate_mean": 1.0, "max_step_rate_min": 1.0, "max_step_rate_max": 1.0, "velocity_mean": 0.2353747426964573, "velocity_min": 0.2353747426964573, "velocity_max": 0.2353747426964573, "steering_mean": 0.02205840490005157, "steering_min": 0.02205840490005157, "steering_max": 0.02205840490005157, "step_reward_mean": 0.014464028715024528, "step_reward_min": 0.014464028715024528, "step_reward_max": 0.014464028715024528, "acceleration_mean": 0.018587119138992584, "acceleration_min": 0.018587119138992584, "acceleration_max": 0.018587119138992584, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 999.0, "episode_length_min": 999.0, "episode_length_max": 999.0, "episode_reward_mean": 14.449564686309504, "episode_reward_min": 14.449564686309504, "episode_reward_max": 14.449564686309504, "num_neighbours_mean": 0.0, "num_neighbours_min": 0.0, "num_neighbours_max": 0.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 2.0, "num_active_agents_min": 2, "num_active_agents_max": 2, "environment_reward_total_mean": 28.899129372619008, "environment_reward_total_min": 28.899129372619008, "environment_reward_total_max": 28.899129372619008}, "hist_stats": {"episode_reward": [28.9388874783246], "episode_lengths": [1000], "policy_default_reward": [15.146240486292044, 13.792646992032571]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3793987853714134, "mean_inference_ms": 0.595179871878941, "mean_action_processing_ms": 0.2147064752307074, "mean_env_wait_ms": 1.4420407584522559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008726119995117188, "StateBufferConnector_ms": 0.004458427429199219, "ViewRequirementAgentConnector_ms": 0.13179779052734375}}, "episode_reward_max": 28.9388874783246, "episode_reward_min": 28.9388874783246, "episode_reward_mean": 14.469443739162308, "episode_len_mean": 1000.0, "episodes_this_iter": 1, "policy_reward_min": {"default": 13.792646992032571}, "policy_reward_max": {"default": 15.146240486292044}, "policy_reward_mean": {"default": 14.469443739162308}, "hist_stats": {"episode_reward": [28.9388874783246], "episode_lengths": [1000], "policy_default_reward": [15.146240486292044, 13.792646992032571]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3793987853714134, "mean_inference_ms": 0.595179871878941, "mean_action_processing_ms": 0.2147064752307074, "mean_env_wait_ms": 1.4420407584522559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008726119995117188, "StateBufferConnector_ms": 0.004458427429199219, "ViewRequirementAgentConnector_ms": 0.13179779052734375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4025, "num_agent_steps_trained": 4025, "num_env_steps_sampled": 2000, "num_env_steps_trained": 2000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 280.8168083659936, "num_env_steps_trained_throughput_per_sec": 280.8168083659936, "timesteps_total": 2000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 4025, "timers": {"training_iteration_time_ms": 7122.039, "sample_time_ms": 5371.071, "load_time_ms": 2.274, "load_throughput": 879493.395, "learn_time_ms": 1746.492, "learn_throughput": 1145.153, "synch_weights_time_ms": 1.698}, "counters": {"num_env_steps_sampled": 2000, "num_env_steps_trained": 2000, "num_agent_steps_sampled": 4025, "num_agent_steps_trained": 4025}, "done": false, "episodes_total": 1, "training_iteration": 1, "trial_id": "3fa75_00000", "date": "2023-12-26_22-59-02", "timestamp": 1703602742, "time_this_iter_s": 7.124945878982544, "time_total_s": 7.124945878982544, "pid": 64206, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "concat", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f30342c3f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "concat", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7.124945878982544, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 15.245454545454544, "ram_util_percent": 57.46363636363637}, "success": 0.0, "crash": 0.0, "out": 0.0, "max_step": 1.0, "length": 1000.0, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 28.9388874783246}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.4444444444444444, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 1.0, "max_step_rate_mean": 0.5555555555555555, "max_step_rate_min": 0.0, "max_step_rate_max": 1.0, "velocity_mean": 0.23438271968473653, "velocity_min": 0.2246222116698911, "velocity_max": 0.24315120468786117, "steering_mean": 0.040282552685372494, "steering_min": 0.019902693792180914, "steering_max": 0.078886559363885, "step_reward_mean": 0.014602734355787295, "step_reward_min": 0.013632640942173107, "step_reward_max": 0.015711533410164246, "acceleration_mean": 0.03196073467114776, "acceleration_min": 0.011790456430268229, "acceleration_max": 0.06550462844418248, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 786.0277777777778, "episode_length_min": 551.75, "episode_length_max": 999.0, "episode_reward_mean": 11.37482956644957, "episode_reward_min": 8.668838559058118, "episode_reward_max": 14.449564686309504, "num_neighbours_mean": 0.4164557358284098, "num_neighbours_min": 0.0, "num_neighbours_max": 0.7951971001359311, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 32.19757999026492, "environment_reward_total_min": 28.899129372619008, "environment_reward_total_max": 34.67535423623247}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09999999999999996, "cur_lr": 0.0003, "total_loss": 2.955708439441191, "policy_loss": 0.026290665566921233, "vf_loss": 2.9288205590513017, "vf_explained_var": -0.014052605628967286, "kl": 0.0059725000671783796, "entropy": 2.821578841739231, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 58.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 9120, "num_agent_steps_trained": 9120}, "sampler_results": {"episode_reward_max": 28.9388874783246, "episode_reward_min": -5.324645763767513, "episode_reward_mean": 15.545146958470541, "episode_len_mean": 1204.6666666666667, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"default": -5.751700746072122}, "policy_reward_max": {"default": 15.146240486292044}, "policy_reward_mean": {"default": 5.1817156528235175}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.4444444444444444, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 1.0, "max_step_rate_mean": 0.5555555555555555, "max_step_rate_min": 0.0, "max_step_rate_max": 1.0, "velocity_mean": 0.23438271968473653, "velocity_min": 0.2246222116698911, "velocity_max": 0.24315120468786117, "steering_mean": 0.040282552685372494, "steering_min": 0.019902693792180914, "steering_max": 0.078886559363885, "step_reward_mean": 0.014602734355787295, "step_reward_min": 0.013632640942173107, "step_reward_max": 0.015711533410164246, "acceleration_mean": 0.03196073467114776, "acceleration_min": 0.011790456430268229, "acceleration_max": 0.06550462844418248, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 786.0277777777778, "episode_length_min": 551.75, "episode_length_max": 999.0, "episode_reward_mean": 11.37482956644957, "episode_reward_min": 8.668838559058118, "episode_reward_max": 14.449564686309504, "num_neighbours_mean": 0.4164557358284098, "num_neighbours_min": 0.0, "num_neighbours_max": 0.7951971001359311, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 32.19757999026492, "environment_reward_total_min": 28.899129372619008, "environment_reward_total_max": 34.67535423623247}, "hist_stats": {"episode_reward": [28.9388874783246, 23.02119916085454, -5.324645763767513], "episode_lengths": [1000, 1450, 1164], "policy_default_reward": [15.146240486292044, 13.792646992032571, -4.655038125760198, 13.910252842546525, 13.765984444068243, -2.87225930343741, -5.751700746072122, 4.5037120306096785, -1.204397744867677]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3912004281202062, "mean_inference_ms": 0.5845748182373716, "mean_action_processing_ms": 0.2048650117190237, "mean_env_wait_ms": 1.384042866092729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005237261454264323, "StateBufferConnector_ms": 0.0035762786865234375, "ViewRequirementAgentConnector_ms": 0.09230772654215495}}, "episode_reward_max": 28.9388874783246, "episode_reward_min": -5.324645763767513, "episode_reward_mean": 5.1817156528235175, "episode_len_mean": 1204.6666666666667, "episodes_this_iter": 2, "policy_reward_min": {"default": -5.751700746072122}, "policy_reward_max": {"default": 15.146240486292044}, "policy_reward_mean": {"default": 5.1817156528235175}, "hist_stats": {"episode_reward": [28.9388874783246, 23.02119916085454, -5.324645763767513], "episode_lengths": [1000, 1450, 1164], "policy_default_reward": [15.146240486292044, 13.792646992032571, -4.655038125760198, 13.910252842546525, 13.765984444068243, -2.87225930343741, -5.751700746072122, 4.5037120306096785, -1.204397744867677]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3912004281202062, "mean_inference_ms": 0.5845748182373716, "mean_action_processing_ms": 0.2048650117190237, "mean_env_wait_ms": 1.384042866092729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005237261454264323, "StateBufferConnector_ms": 0.0035762786865234375, "ViewRequirementAgentConnector_ms": 0.09230772654215495}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9120, "num_agent_steps_trained": 9120, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 372.48893471001566, "num_env_steps_trained_throughput_per_sec": 372.48893471001566, "timesteps_total": 4000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 9120, "timers": {"training_iteration_time_ms": 6245.654, "sample_time_ms": 5179.302, "load_time_ms": 3.128, "load_throughput": 639375.61, "learn_time_ms": 1061.007, "learn_throughput": 1885.002, "synch_weights_time_ms": 1.701}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 9120, "num_agent_steps_trained": 9120}, "done": false, "episodes_total": 3, "training_iteration": 2, "trial_id": "3fa75_00000", "date": "2023-12-26_22-59-08", "timestamp": 1703602748, "time_this_iter_s": 5.372533082962036, "time_total_s": 12.49747896194458, "pid": 64206, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "concat", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f30342c3f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "concat", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12.49747896194458, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 15.857142857142858, "ram_util_percent": 58.471428571428575}, "success": 0.0, "crash": 0.0, "out": 0.4444444444444444, "max_step": 0.5555555555555555, "length": 1204.6666666666667, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 15.545146958470541}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.36666666666666664, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 1.0, "max_step_rate_mean": 0.6333333333333333, "max_step_rate_min": 0.0, "max_step_rate_max": 1.0, "velocity_mean": 0.23179753213258397, "velocity_min": 0.2246222116698911, "velocity_max": 0.24315120468786117, "steering_mean": 0.04362526944569944, "steering_min": 0.019902693792180914, "steering_max": 0.078886559363885, "step_reward_mean": 0.014305519967034183, "step_reward_min": 0.013632640942173107, "step_reward_max": 0.015711533410164246, "acceleration_mean": 0.023284452895391935, "acceleration_min": 0.0071245203684042165, "acceleration_max": 0.06550462844418248, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 869.5166666666668, "episode_length_min": 551.75, "episode_length_max": 999.0, "episode_reward_mean": 12.339348336482939, "episode_reward_min": 8.668838559058118, "episode_reward_max": 14.449564686309504, "num_neighbours_mean": 0.24987344149704588, "num_neighbours_min": 0.0, "num_neighbours_max": 0.7951971001359311, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 2.6, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 30.347449187385344, "environment_reward_total_min": 27.31159860390452, "environment_reward_total_max": 34.67535423623247}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 0.4224788445746526, "policy_loss": 0.0006323732435703277, "vf_loss": 0.4212321066297591, "vf_explained_var": -0.007632303237915039, "kl": 0.006143847357998311, "entropy": 2.813676118850708, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 100.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 6000, "num_env_steps_trained": 6000, "num_agent_steps_sampled": 13300, "num_agent_steps_trained": 13300}, "sampler_results": {"episode_reward_max": 28.9388874783246, "episode_reward_min": -5.324645763767513, "episode_reward_mean": 18.35723333521799, "episode_len_mean": 1122.8, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"default": -5.751700746072122}, "policy_reward_max": {"default": 15.146240486292044}, "policy_reward_mean": {"default": 7.060474359699232}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.36666666666666664, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 1.0, "max_step_rate_mean": 0.6333333333333333, "max_step_rate_min": 0.0, "max_step_rate_max": 1.0, "velocity_mean": 0.23179753213258397, "velocity_min": 0.2246222116698911, "velocity_max": 0.24315120468786117, "steering_mean": 0.04362526944569944, "steering_min": 0.019902693792180914, "steering_max": 0.078886559363885, "step_reward_mean": 0.014305519967034183, "step_reward_min": 0.013632640942173107, "step_reward_max": 0.015711533410164246, "acceleration_mean": 0.023284452895391935, "acceleration_min": 0.0071245203684042165, "acceleration_max": 0.06550462844418248, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 869.5166666666668, "episode_length_min": 551.75, "episode_length_max": 999.0, "episode_reward_mean": 12.339348336482939, "episode_reward_min": 8.668838559058118, "episode_reward_max": 14.449564686309504, "num_neighbours_mean": 0.24987344149704588, "num_neighbours_min": 0.0, "num_neighbours_max": 0.7951971001359311, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 2.6, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 30.347449187385344, "environment_reward_total_min": 27.31159860390452, "environment_reward_total_max": 34.67535423623247}, "hist_stats": {"episode_reward": [28.9388874783246, 23.02119916085454, -5.324645763767513, 27.317528310567422, 17.833197490110923], "episode_lengths": [1000, 1450, 1164, 1000, 1000], "policy_default_reward": [15.146240486292044, 13.792646992032571, -4.655038125760198, 13.910252842546525, 13.765984444068243, -2.87225930343741, -5.751700746072122, 4.5037120306096785, -1.204397744867677, 14.84497740462472, 12.472550905942734, 12.237427041956062, 5.595770448154843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39481892471296537, "mean_inference_ms": 0.5833135418388637, "mean_action_processing_ms": 0.20465339336171984, "mean_env_wait_ms": 1.3798568496998407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005154609680175781, "StateBufferConnector_ms": 0.0036382675170898438, "ViewRequirementAgentConnector_ms": 0.09600639343261719}}, "episode_reward_max": 28.9388874783246, "episode_reward_min": -5.324645763767513, "episode_reward_mean": 7.060474359699232, "episode_len_mean": 1122.8, "episodes_this_iter": 2, "policy_reward_min": {"default": -5.751700746072122}, "policy_reward_max": {"default": 15.146240486292044}, "policy_reward_mean": {"default": 7.060474359699232}, "hist_stats": {"episode_reward": [28.9388874783246, 23.02119916085454, -5.324645763767513, 27.317528310567422, 17.833197490110923], "episode_lengths": [1000, 1450, 1164, 1000, 1000], "policy_default_reward": [15.146240486292044, 13.792646992032571, -4.655038125760198, 13.910252842546525, 13.765984444068243, -2.87225930343741, -5.751700746072122, 4.5037120306096785, -1.204397744867677, 14.84497740462472, 12.472550905942734, 12.237427041956062, 5.595770448154843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39481892471296537, "mean_inference_ms": 0.5833135418388637, "mean_action_processing_ms": 0.20465339336171984, "mean_env_wait_ms": 1.3798568496998407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005154609680175781, "StateBufferConnector_ms": 0.0036382675170898438, "ViewRequirementAgentConnector_ms": 0.09600639343261719}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13300, "num_agent_steps_trained": 13300, "num_env_steps_sampled": 6000, "num_env_steps_trained": 6000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 355.7725209143285, "num_env_steps_trained_throughput_per_sec": 355.7725209143285, "timesteps_total": 6000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 13300, "timers": {"training_iteration_time_ms": 6037.619, "sample_time_ms": 5231.856, "load_time_ms": 3.698, "load_throughput": 540828.333, "learn_time_ms": 799.907, "learn_throughput": 2500.29, "synch_weights_time_ms": 1.68}, "counters": {"num_env_steps_sampled": 6000, "num_env_steps_trained": 6000, "num_agent_steps_sampled": 13300, "num_agent_steps_trained": 13300}, "done": false, "episodes_total": 5, "training_iteration": 3, "trial_id": "3fa75_00000", "date": "2023-12-26_22-59-13", "timestamp": 1703602753, "time_this_iter_s": 5.625020503997803, "time_total_s": 18.122499465942383, "pid": 64206, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "concat", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f30342c3f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "concat", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 18.122499465942383, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 15.6625, "ram_util_percent": 58.4875}, "success": 0.0, "crash": 0.0, "out": 0.36666666666666664, "max_step": 0.6333333333333333, "length": 1122.8, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 18.35723333521799}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.3611111111111111, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 1.0, "max_step_rate_mean": 0.6388888888888888, "max_step_rate_min": 0.0, "max_step_rate_max": 1.0, "velocity_mean": 0.23285122806316724, "velocity_min": 0.2246222116698911, "velocity_max": 0.24315120468786117, "steering_mean": 0.03754225168569385, "steering_min": 0.007127162885665893, "steering_max": 0.078886559363885, "step_reward_mean": 0.014397839462381304, "step_reward_min": 0.013632640942173107, "step_reward_max": 0.015711533410164246, "acceleration_mean": 0.025233398711076174, "acceleration_min": 0.0071245203684042165, "acceleration_max": 0.06550462844418248, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 863.4861111111112, "episode_length_min": 551.75, "episode_length_max": 999.0, "episode_reward_mean": 12.34660096639091, "episode_reward_min": 8.668838559058118, "episode_reward_max": 14.449564686309504, "num_neighbours_mean": 0.2082278679142049, "num_neighbours_min": 0.0, "num_neighbours_max": 0.7951971001359311, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 2.6666666666666665, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 31.480973047453165, "environment_reward_total_min": 27.31159860390452, "environment_reward_total_max": 37.1485923477923}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0003, "total_loss": 1.3247963087899344, "policy_loss": -0.027996470034122468, "vf_loss": 1.351457473316363, "vf_explained_var": 0.00767258746283395, "kl": 0.01335303153633244, "entropy": 2.8120243549346924, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 138.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 17335, "num_agent_steps_trained": 17335}, "sampler_results": {"episode_reward_max": 28.9388874783246, "episode_reward_min": -5.324645763767513, "episode_reward_mean": 19.83085556745488, "episode_len_mean": 1190.3333333333333, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -5.751700746072122}, "policy_reward_max": {"default": 16.14586781288086}, "policy_reward_mean": {"default": 7.436570837795583}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.3611111111111111, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 1.0, "max_step_rate_mean": 0.6388888888888888, "max_step_rate_min": 0.0, "max_step_rate_max": 1.0, "velocity_mean": 0.23285122806316724, "velocity_min": 0.2246222116698911, "velocity_max": 0.24315120468786117, "steering_mean": 0.03754225168569385, "steering_min": 0.007127162885665893, "steering_max": 0.078886559363885, "step_reward_mean": 0.014397839462381304, "step_reward_min": 0.013632640942173107, "step_reward_max": 0.015711533410164246, "acceleration_mean": 0.025233398711076174, "acceleration_min": 0.0071245203684042165, "acceleration_max": 0.06550462844418248, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 863.4861111111112, "episode_length_min": 551.75, "episode_length_max": 999.0, "episode_reward_mean": 12.34660096639091, "episode_reward_min": 8.668838559058118, "episode_reward_max": 14.449564686309504, "num_neighbours_mean": 0.2082278679142049, "num_neighbours_min": 0.0, "num_neighbours_max": 0.7951971001359311, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 2.6666666666666665, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 31.480973047453165, "environment_reward_total_min": 27.31159860390452, "environment_reward_total_max": 37.1485923477923}, "hist_stats": {"episode_reward": [28.9388874783246, 23.02119916085454, -5.324645763767513, 27.317528310567422, 17.833197490110923, 27.198966728639302], "episode_lengths": [1000, 1450, 1164, 1000, 1000, 1528], "policy_default_reward": [15.146240486292044, 13.792646992032571, -4.655038125760198, 13.910252842546525, 13.765984444068243, -2.87225930343741, -5.751700746072122, 4.5037120306096785, -1.204397744867677, 14.84497740462472, 12.472550905942734, 12.237427041956062, 5.595770448154843, 14.730727721142278, -3.6776288053838178, 16.14586781288086]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3937554636610054, "mean_inference_ms": 0.5826301002333855, "mean_action_processing_ms": 0.20389239305396287, "mean_env_wait_ms": 1.3735825097797694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004891554514567058, "StateBufferConnector_ms": 0.003556410471598307, "ViewRequirementAgentConnector_ms": 0.09195009867350261}}, "episode_reward_max": 28.9388874783246, "episode_reward_min": -5.324645763767513, "episode_reward_mean": 7.436570837795583, "episode_len_mean": 1190.3333333333333, "episodes_this_iter": 1, "policy_reward_min": {"default": -5.751700746072122}, "policy_reward_max": {"default": 16.14586781288086}, "policy_reward_mean": {"default": 7.436570837795583}, "hist_stats": {"episode_reward": [28.9388874783246, 23.02119916085454, -5.324645763767513, 27.317528310567422, 17.833197490110923, 27.198966728639302], "episode_lengths": [1000, 1450, 1164, 1000, 1000, 1528], "policy_default_reward": [15.146240486292044, 13.792646992032571, -4.655038125760198, 13.910252842546525, 13.765984444068243, -2.87225930343741, -5.751700746072122, 4.5037120306096785, -1.204397744867677, 14.84497740462472, 12.472550905942734, 12.237427041956062, 5.595770448154843, 14.730727721142278, -3.6776288053838178, 16.14586781288086]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3937554636610054, "mean_inference_ms": 0.5826301002333855, "mean_action_processing_ms": 0.20389239305396287, "mean_env_wait_ms": 1.3735825097797694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004891554514567058, "StateBufferConnector_ms": 0.003556410471598307, "ViewRequirementAgentConnector_ms": 0.09195009867350261}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17335, "num_agent_steps_trained": 17335, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 388.02171098881286, "num_env_steps_trained_throughput_per_sec": 388.02171098881286, "timesteps_total": 8000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 17335, "timers": {"training_iteration_time_ms": 5816.796, "sample_time_ms": 5151.398, "load_time_ms": 5.046, "load_throughput": 396371.489, "learn_time_ms": 658.275, "learn_throughput": 3038.243, "synch_weights_time_ms": 1.619}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 17335, "num_agent_steps_trained": 17335}, "done": false, "episodes_total": 6, "training_iteration": 4, "trial_id": "3fa75_00000", "date": "2023-12-26_22-59-18", "timestamp": 1703602758, "time_this_iter_s": 5.157660007476807, "time_total_s": 23.28015947341919, "pid": 64206, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "concat", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f30342c3f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "concat", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 23.28015947341919, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 16.85, "ram_util_percent": 58.462500000000006}, "success": 0.0, "crash": 0.0, "out": 0.3611111111111111, "max_step": 0.6388888888888888, "length": 1190.3333333333333, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 19.83085556745488}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.4047619047619047, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 1.0, "max_step_rate_mean": 0.5952380952380951, "max_step_rate_min": 0.0, "max_step_rate_max": 1.0, "velocity_mean": 0.23322094880585428, "velocity_min": 0.2246222116698911, "velocity_max": 0.24315120468786117, "steering_mean": 0.03871474118772168, "steering_min": 0.007127162885665893, "steering_max": 0.078886559363885, "step_reward_mean": 0.01417667908957355, "step_reward_min": 0.012849716852727013, "step_reward_max": 0.015711533410164246, "acceleration_mean": 0.0265639442707741, "acceleration_min": 0.0071245203684042165, "acceleration_max": 0.06550462844418248, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 837.9880952380953, "episode_length_min": 551.75, "episode_length_max": 999.0, "episode_reward_mean": 11.84023740606621, "episode_reward_min": 8.668838559058118, "episode_reward_max": 14.449564686309504, "num_neighbours_mean": 0.1796628162239935, "num_neighbours_min": 0.0, "num_neighbours_max": 0.7951971001359311, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 2.7142857142857144, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 30.75600091672472, "environment_reward_total_min": 26.40616813235401, "environment_reward_total_max": 37.1485923477923}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09999999999999998, "cur_lr": 0.0003, "total_loss": 2.6778799724578857, "policy_loss": -0.0015940321981906891, "vf_loss": 2.6789348888397218, "vf_explained_var": 0.0009269118309020996, "kl": 0.005391175299882945, "entropy": 2.8103641939163206, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 24.5}}, "num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_agent_steps_sampled": 22485, "num_agent_steps_trained": 22485}, "sampler_results": {"episode_reward_max": 28.9388874783246, "episode_reward_min": -5.324645763767513, "episode_reward_mean": 17.912916749237436, "episode_len_mean": 1175.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -5.751700746072122}, "policy_reward_max": {"default": 16.14586781288086}, "policy_reward_mean": {"default": 6.5994956444559}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.4047619047619047, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 1.0, "max_step_rate_mean": 0.5952380952380951, "max_step_rate_min": 0.0, "max_step_rate_max": 1.0, "velocity_mean": 0.23322094880585428, "velocity_min": 0.2246222116698911, "velocity_max": 0.24315120468786117, "steering_mean": 0.03871474118772168, "steering_min": 0.007127162885665893, "steering_max": 0.078886559363885, "step_reward_mean": 0.01417667908957355, "step_reward_min": 0.012849716852727013, "step_reward_max": 0.015711533410164246, "acceleration_mean": 0.0265639442707741, "acceleration_min": 0.0071245203684042165, "acceleration_max": 0.06550462844418248, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 837.9880952380953, "episode_length_min": 551.75, "episode_length_max": 999.0, "episode_reward_mean": 11.84023740606621, "episode_reward_min": 8.668838559058118, "episode_reward_max": 14.449564686309504, "num_neighbours_mean": 0.1796628162239935, "num_neighbours_min": 0.0, "num_neighbours_max": 0.7951971001359311, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 2.7142857142857144, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 30.75600091672472, "environment_reward_total_min": 26.40616813235401, "environment_reward_total_max": 37.1485923477923}, "hist_stats": {"episode_reward": [28.9388874783246, 23.02119916085454, -5.324645763767513, 27.317528310567422, 17.833197490110923, 27.198966728639302, 6.405283839932775], "episode_lengths": [1000, 1450, 1164, 1000, 1000, 1528, 1083], "policy_default_reward": [15.146240486292044, 13.792646992032571, -4.655038125760198, 13.910252842546525, 13.765984444068243, -2.87225930343741, -5.751700746072122, 4.5037120306096785, -1.204397744867677, 14.84497740462472, 12.472550905942734, 12.237427041956062, 5.595770448154843, 14.730727721142278, -3.6776288053838178, 16.14586781288086, -0.11206339366774287, 11.481322315396774, -4.963975081796268]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39271967021473636, "mean_inference_ms": 0.5816642462375995, "mean_action_processing_ms": 0.20284995761839522, "mean_env_wait_ms": 1.365349205610441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004744529724121094, "StateBufferConnector_ms": 0.0035081590924944195, "ViewRequirementAgentConnector_ms": 0.0894648688180106}}, "episode_reward_max": 28.9388874783246, "episode_reward_min": -5.324645763767513, "episode_reward_mean": 6.5994956444559, "episode_len_mean": 1175.0, "episodes_this_iter": 1, "policy_reward_min": {"default": -5.751700746072122}, "policy_reward_max": {"default": 16.14586781288086}, "policy_reward_mean": {"default": 6.5994956444559}, "hist_stats": {"episode_reward": [28.9388874783246, 23.02119916085454, -5.324645763767513, 27.317528310567422, 17.833197490110923, 27.198966728639302, 6.405283839932775], "episode_lengths": [1000, 1450, 1164, 1000, 1000, 1528, 1083], "policy_default_reward": [15.146240486292044, 13.792646992032571, -4.655038125760198, 13.910252842546525, 13.765984444068243, -2.87225930343741, -5.751700746072122, 4.5037120306096785, -1.204397744867677, 14.84497740462472, 12.472550905942734, 12.237427041956062, 5.595770448154843, 14.730727721142278, -3.6776288053838178, 16.14586781288086, -0.11206339366774287, 11.481322315396774, -4.963975081796268]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39271967021473636, "mean_inference_ms": 0.5816642462375995, "mean_action_processing_ms": 0.20284995761839522, "mean_env_wait_ms": 1.365349205610441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004744529724121094, "StateBufferConnector_ms": 0.0035081590924944195, "ViewRequirementAgentConnector_ms": 0.0894648688180106}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22485, "num_agent_steps_trained": 22485, "num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 389.71013112507404, "num_env_steps_trained_throughput_per_sec": 389.71013112507404, "timesteps_total": 10000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 22485, "timers": {"training_iteration_time_ms": 5679.837, "sample_time_ms": 5078.674, "load_time_ms": 5.02, "load_throughput": 398398.921, "learn_time_ms": 594.074, "learn_throughput": 3366.585, "synch_weights_time_ms": 1.621}, "counters": {"num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_agent_steps_sampled": 22485, "num_agent_steps_trained": 22485}, "done": false, "episodes_total": 7, "training_iteration": 5, "trial_id": "3fa75_00000", "date": "2023-12-26_22-59-24", "timestamp": 1703602764, "time_this_iter_s": 5.1354591846466064, "time_total_s": 28.415618658065796, "pid": 64206, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "concat", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f30342c3f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "concat", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 28.415618658065796, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 15.971428571428572, "ram_util_percent": 58.5}, "success": 0.0, "crash": 0.0, "out": 0.4047619047619047, "max_step": 0.5952380952380951, "length": 1175.0, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 17.912916749237436}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.4351851851851852, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 1.0, "max_step_rate_mean": 0.5648148148148148, "max_step_rate_min": 0.0, "max_step_rate_max": 1.0, "velocity_mean": 0.23393594389796146, "velocity_min": 0.2246222116698911, "velocity_max": 0.24345157670734263, "steering_mean": 0.04144212587740275, "steering_min": -0.007435240980558602, "steering_max": 0.10941118556313152, "step_reward_mean": 0.014318759200218578, "step_reward_min": 0.012849716852727013, "step_reward_max": 0.016034942613651813, "acceleration_mean": 0.03073397485112164, "acceleration_min": 0.0071245203684042165, "acceleration_max": 0.06550462844418248, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 821.175925925926, "episode_length_min": 551.75, "episode_length_max": 999.0, "episode_reward_mean": 11.708546855497543, "episode_reward_min": 8.668838559058118, "episode_reward_max": 14.449564686309504, "num_neighbours_mean": 0.15749709904068934, "num_neighbours_min": 0.0, "num_neighbours_max": 0.7951971001359311, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 2.888888888888889, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 32.629899152635346, "environment_reward_total_min": 26.40616813235401, "environment_reward_total_max": 43.56522554240696}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09999999999999998, "cur_lr": 0.0003, "total_loss": 2.1810293412208557, "policy_loss": -0.004930183589458466, "vf_loss": 2.185469744205475, "vf_explained_var": 0.01852478861808777, "kl": 0.004897638096590573, "entropy": 2.7751119804382323, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 230.5, "diff_num_grad_updates_vs_sampler_policy": 24.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 27988, "num_agent_steps_trained": 27988}, "sampler_results": {"episode_reward_max": 28.9388874783246, "episode_reward_min": -5.324645763767513, "episode_reward_mean": 18.198215640474075, "episode_len_mean": 1267.5555555555557, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"default": -8.263217083487769}, "policy_reward_max": {"default": 17.16130871303959}, "policy_reward_mean": {"default": 6.299382337087181}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.4351851851851852, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 1.0, "max_step_rate_mean": 0.5648148148148148, "max_step_rate_min": 0.0, "max_step_rate_max": 1.0, "velocity_mean": 0.23393594389796146, "velocity_min": 0.2246222116698911, "velocity_max": 0.24345157670734263, "steering_mean": 0.04144212587740275, "steering_min": -0.007435240980558602, "steering_max": 0.10941118556313152, "step_reward_mean": 0.014318759200218578, "step_reward_min": 0.012849716852727013, "step_reward_max": 0.016034942613651813, "acceleration_mean": 0.03073397485112164, "acceleration_min": 0.0071245203684042165, "acceleration_max": 0.06550462844418248, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 821.175925925926, "episode_length_min": 551.75, "episode_length_max": 999.0, "episode_reward_mean": 11.708546855497543, "episode_reward_min": 8.668838559058118, "episode_reward_max": 14.449564686309504, "num_neighbours_mean": 0.15749709904068934, "num_neighbours_min": 0.0, "num_neighbours_max": 0.7951971001359311, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 2.888888888888889, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 32.629899152635346, "environment_reward_total_min": 26.40616813235401, "environment_reward_total_max": 43.56522554240696}, "hist_stats": {"episode_reward": [28.9388874783246, 23.02119916085454, -5.324645763767513, 27.317528310567422, 17.833197490110923, 27.198966728639302, 6.405283839932775, 13.564873109940043, 24.8286504096646], "episode_lengths": [1000, 1450, 1164, 1000, 1000, 1528, 1083, 1984, 1199], "policy_default_reward": [15.146240486292044, 13.792646992032571, -4.655038125760198, 13.910252842546525, 13.765984444068243, -2.87225930343741, -5.751700746072122, 4.5037120306096785, -1.204397744867677, 14.84497740462472, 12.472550905942734, 12.237427041956062, 5.595770448154843, 14.730727721142278, -3.6776288053838178, 16.14586781288086, -0.11206339366774287, 11.481322315396774, -4.963975081796268, -3.2822399323438303, 2.493814819908671, -0.749412472125119, 15.1027106945003, -8.263217083487769, 17.16130871303959, 15.930558780112769]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3929192479502157, "mean_inference_ms": 0.5800603492667219, "mean_action_processing_ms": 0.20123084857770768, "mean_env_wait_ms": 1.3518127134624454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004596180386013455, "StateBufferConnector_ms": 0.003719329833984375, "ViewRequirementAgentConnector_ms": 0.08694065941704644}}, "episode_reward_max": 28.9388874783246, "episode_reward_min": -5.324645763767513, "episode_reward_mean": 6.299382337087181, "episode_len_mean": 1267.5555555555557, "episodes_this_iter": 2, "policy_reward_min": {"default": -8.263217083487769}, "policy_reward_max": {"default": 17.16130871303959}, "policy_reward_mean": {"default": 6.299382337087181}, "hist_stats": {"episode_reward": [28.9388874783246, 23.02119916085454, -5.324645763767513, 27.317528310567422, 17.833197490110923, 27.198966728639302, 6.405283839932775, 13.564873109940043, 24.8286504096646], "episode_lengths": [1000, 1450, 1164, 1000, 1000, 1528, 1083, 1984, 1199], "policy_default_reward": [15.146240486292044, 13.792646992032571, -4.655038125760198, 13.910252842546525, 13.765984444068243, -2.87225930343741, -5.751700746072122, 4.5037120306096785, -1.204397744867677, 14.84497740462472, 12.472550905942734, 12.237427041956062, 5.595770448154843, 14.730727721142278, -3.6776288053838178, 16.14586781288086, -0.11206339366774287, 11.481322315396774, -4.963975081796268, -3.2822399323438303, 2.493814819908671, -0.749412472125119, 15.1027106945003, -8.263217083487769, 17.16130871303959, 15.930558780112769]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3929192479502157, "mean_inference_ms": 0.5800603492667219, "mean_action_processing_ms": 0.20123084857770768, "mean_env_wait_ms": 1.3518127134624454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004596180386013455, "StateBufferConnector_ms": 0.003719329833984375, "ViewRequirementAgentConnector_ms": 0.08694065941704644}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27988, "num_agent_steps_trained": 27988, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 373.97002420419994, "num_env_steps_trained_throughput_per_sec": 373.97002420419994, "timesteps_total": 12000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 27988, "timers": {"training_iteration_time_ms": 5624.528, "sample_time_ms": 5064.755, "load_time_ms": 5.011, "load_throughput": 399140.745, "learn_time_ms": 552.704, "learn_throughput": 3618.573, "synch_weights_time_ms": 1.627}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 27988, "num_agent_steps_trained": 27988}, "done": false, "episodes_total": 9, "training_iteration": 6, "trial_id": "3fa75_00000", "date": "2023-12-26_22-59-29", "timestamp": 1703602769, "time_this_iter_s": 5.352153539657593, "time_total_s": 33.76777219772339, "pid": 64206, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "concat", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f30342c3f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "concat", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 33.76777219772339, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 15.5, "ram_util_percent": 58.6}, "success": 0.0, "crash": 0.0, "out": 0.4351851851851852, "max_step": 0.5648148148148148, "length": 1267.5555555555557, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 18.198215640474075}
