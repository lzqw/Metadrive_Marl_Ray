{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.0, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.0, "max_step_rate_mean": 1.0, "max_step_rate_min": 1.0, "max_step_rate_max": 1.0, "velocity_mean": 0.22164056043408062, "velocity_min": 0.22164056043408062, "velocity_max": 0.22164056043408062, "steering_mean": 0.004365405878863177, "steering_min": 0.004365405878863177, "steering_max": 0.004365405878863177, "step_reward_mean": 0.013187613257144121, "step_reward_min": 0.013187613257144121, "step_reward_max": 0.013187613257144121, "acceleration_mean": 0.007596198771450971, "acceleration_min": 0.007596198771450971, "acceleration_max": 0.007596198771450971, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 999.0, "episode_length_min": 999.0, "episode_length_max": 999.0, "episode_reward_mean": 13.174425643886972, "episode_reward_min": 13.174425643886972, "episode_reward_max": 13.174425643886972, "num_neighbours_mean": 0.0, "num_neighbours_min": 0.0, "num_neighbours_max": 0.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 2.0, "num_active_agents_min": 2, "num_active_agents_max": 2, "environment_reward_total_mean": 26.348851287773943, "environment_reward_total_min": 26.348851287773943, "environment_reward_total_max": 26.348851287773943}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.2, "cur_lr": 0.0003, "total_loss": 1.236293539404869, "policy_loss": -0.02895687725394964, "vf_loss": 1.263619170896709, "vf_explained_var": 0.00012122243642807007, "kl": 0.008156176982447519, "entropy": 2.837565767765045, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 20.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 2000, "num_env_steps_trained": 2000, "num_agent_steps_sampled": 4341, "num_agent_steps_trained": 4341}, "sampler_results": {"episode_reward_max": 26.380314769721366, "episode_reward_min": 26.380314769721366, "episode_reward_mean": 26.380314769721366, "episode_len_mean": 1000.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": 12.167725607614678}, "policy_reward_max": {"default": 14.212589162106731}, "policy_reward_mean": {"default": 13.190157384860704}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.0, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.0, "max_step_rate_mean": 1.0, "max_step_rate_min": 1.0, "max_step_rate_max": 1.0, "velocity_mean": 0.22164056043408062, "velocity_min": 0.22164056043408062, "velocity_max": 0.22164056043408062, "steering_mean": 0.004365405878863177, "steering_min": 0.004365405878863177, "steering_max": 0.004365405878863177, "step_reward_mean": 0.013187613257144121, "step_reward_min": 0.013187613257144121, "step_reward_max": 0.013187613257144121, "acceleration_mean": 0.007596198771450971, "acceleration_min": 0.007596198771450971, "acceleration_max": 0.007596198771450971, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 999.0, "episode_length_min": 999.0, "episode_length_max": 999.0, "episode_reward_mean": 13.174425643886972, "episode_reward_min": 13.174425643886972, "episode_reward_max": 13.174425643886972, "num_neighbours_mean": 0.0, "num_neighbours_min": 0.0, "num_neighbours_max": 0.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 2.0, "num_active_agents_min": 2, "num_active_agents_max": 2, "environment_reward_total_mean": 26.348851287773943, "environment_reward_total_min": 26.348851287773943, "environment_reward_total_max": 26.348851287773943}, "hist_stats": {"episode_reward": [26.380314769721366], "episode_lengths": [1000], "policy_default_reward": [14.212589162106731, 12.167725607614678]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3841634633122892, "mean_inference_ms": 0.6197270961000823, "mean_action_processing_ms": 0.2157897844367001, "mean_env_wait_ms": 1.3943974343852243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007677078247070313, "StateBufferConnector_ms": 0.0038623809814453125, "ViewRequirementAgentConnector_ms": 0.14002323150634766}}, "episode_reward_max": 26.380314769721366, "episode_reward_min": 26.380314769721366, "episode_reward_mean": 13.190157384860704, "episode_len_mean": 1000.0, "episodes_this_iter": 1, "policy_reward_min": {"default": 12.167725607614678}, "policy_reward_max": {"default": 14.212589162106731}, "policy_reward_mean": {"default": 13.190157384860704}, "hist_stats": {"episode_reward": [26.380314769721366], "episode_lengths": [1000], "policy_default_reward": [14.212589162106731, 12.167725607614678]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3841634633122892, "mean_inference_ms": 0.6197270961000823, "mean_action_processing_ms": 0.2157897844367001, "mean_env_wait_ms": 1.3943974343852243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007677078247070313, "StateBufferConnector_ms": 0.0038623809814453125, "ViewRequirementAgentConnector_ms": 0.14002323150634766}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4341, "num_agent_steps_trained": 4341, "num_env_steps_sampled": 2000, "num_env_steps_trained": 2000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 313.253805694398, "num_env_steps_trained_throughput_per_sec": 313.253805694398, "timesteps_total": 2000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 4341, "timers": {"training_iteration_time_ms": 6384.575, "sample_time_ms": 5341.234, "load_time_ms": 14.532, "load_throughput": 137624.202, "learn_time_ms": 1026.509, "learn_throughput": 1948.352, "synch_weights_time_ms": 1.517}, "counters": {"num_env_steps_sampled": 2000, "num_env_steps_trained": 2000, "num_agent_steps_sampled": 4341, "num_agent_steps_trained": 4341}, "done": false, "episodes_total": 1, "training_iteration": 1, "trial_id": "3f391_00000", "date": "2023-12-26_23-20-29", "timestamp": 1703604029, "time_this_iter_s": 6.387093544006348, "time_total_s": 6.387093544006348, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6.387093544006348, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 17.47, "ram_util_percent": 58.669999999999995}, "success": 0.0, "crash": 0.0, "out": 0.0, "max_step": 1.0, "length": 1000.0, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 26.380314769721366}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.38888888888888884, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.6666666666666666, "max_step_rate_mean": 0.611111111111111, "max_step_rate_min": 0.3333333333333333, "max_step_rate_max": 1.0, "velocity_mean": 0.22272383837115073, "velocity_min": 0.21853789300413567, "velocity_max": 0.22799306167523586, "steering_mean": -0.035268290092241555, "steering_min": -0.09470507073235679, "steering_max": 0.004365405878863177, "step_reward_mean": 0.013202700200105706, "step_reward_min": 0.012692142206641865, "step_reward_max": 0.013728345136531131, "acceleration_mean": 0.008269422542367207, "acceleration_min": -0.007236358014548697, "acceleration_max": 0.02444842687019935, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 776.3333333333334, "episode_length_min": 615.0, "episode_length_max": 999.0, "episode_reward_mean": 10.26528662453049, "episode_reward_min": 7.805667457084747, "episode_reward_max": 13.174425643886972, "num_neighbours_mean": 0.13170731707317074, "num_neighbours_min": 0.0, "num_neighbours_max": 0.3951219512195122, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 29.006273811324064, "environment_reward_total_min": 26.348851287773943, "environment_reward_total_max": 31.222669828338987}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.2, "cur_lr": 0.0003, "total_loss": 2.132209077477455, "policy_loss": -0.012588466331362725, "vf_loss": 2.143606451898813, "vf_explained_var": -0.0011385411024093627, "kl": 0.005955356384947724, "entropy": 2.8476699113845827, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 8838, "num_agent_steps_trained": 8838}, "sampler_results": {"episode_reward_max": 26.380314769721366, "episode_reward_min": 9.442897069674476, "episode_reward_mean": 15.694148113593267, "episode_len_mean": 1229.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"default": -7.696558404176836}, "policy_reward_max": {"default": 14.212589162106731}, "policy_reward_mean": {"default": 5.231382704531091}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.38888888888888884, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.6666666666666666, "max_step_rate_mean": 0.611111111111111, "max_step_rate_min": 0.3333333333333333, "max_step_rate_max": 1.0, "velocity_mean": 0.22272383837115073, "velocity_min": 0.21853789300413567, "velocity_max": 0.22799306167523586, "steering_mean": -0.035268290092241555, "steering_min": -0.09470507073235679, "steering_max": 0.004365405878863177, "step_reward_mean": 0.013202700200105706, "step_reward_min": 0.012692142206641865, "step_reward_max": 0.013728345136531131, "acceleration_mean": 0.008269422542367207, "acceleration_min": -0.007236358014548697, "acceleration_max": 0.02444842687019935, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 776.3333333333334, "episode_length_min": 615.0, "episode_length_max": 999.0, "episode_reward_mean": 10.26528662453049, "episode_reward_min": 7.805667457084747, "episode_reward_max": 13.174425643886972, "num_neighbours_mean": 0.13170731707317074, "num_neighbours_min": 0.0, "num_neighbours_max": 0.3951219512195122, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 29.006273811324064, "environment_reward_total_min": 26.348851287773943, "environment_reward_total_max": 31.222669828338987}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476], "episode_lengths": [1000, 1514, 1173], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3851240618918202, "mean_inference_ms": 0.6081343606117996, "mean_action_processing_ms": 0.20484418423374598, "mean_env_wait_ms": 1.323806407724419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004855791727701823, "StateBufferConnector_ms": 0.0032345453898111978, "ViewRequirementAgentConnector_ms": 0.09639263153076172}}, "episode_reward_max": 26.380314769721366, "episode_reward_min": 9.442897069674476, "episode_reward_mean": 5.231382704531091, "episode_len_mean": 1229.0, "episodes_this_iter": 2, "policy_reward_min": {"default": -7.696558404176836}, "policy_reward_max": {"default": 14.212589162106731}, "policy_reward_mean": {"default": 5.231382704531091}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476], "episode_lengths": [1000, 1514, 1173], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3851240618918202, "mean_inference_ms": 0.6081343606117996, "mean_action_processing_ms": 0.20484418423374598, "mean_env_wait_ms": 1.323806407724419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004855791727701823, "StateBufferConnector_ms": 0.0032345453898111978, "ViewRequirementAgentConnector_ms": 0.09639263153076172}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8838, "num_agent_steps_trained": 8838, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 393.5471391717428, "num_env_steps_trained_throughput_per_sec": 393.5471391717428, "timesteps_total": 4000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 8838, "timers": {"training_iteration_time_ms": 5733.268, "sample_time_ms": 5063.517, "load_time_ms": 9.076, "load_throughput": 220364.305, "learn_time_ms": 658.466, "learn_throughput": 3037.363, "synch_weights_time_ms": 1.573}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 8838, "num_agent_steps_trained": 8838}, "done": false, "episodes_total": 3, "training_iteration": 2, "trial_id": "3f391_00000", "date": "2023-12-26_23-20-34", "timestamp": 1703604034, "time_this_iter_s": 5.08532977104187, "time_total_s": 11.472423315048218, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11.472423315048218, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 15.9, "ram_util_percent": 59.89999999999999}, "success": 0.0, "crash": 0.0, "out": 0.38888888888888884, "max_step": 0.611111111111111, "length": 1229.0, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 15.694148113593267}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.37499999999999994, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.6666666666666666, "max_step_rate_mean": 0.625, "max_step_rate_min": 0.3333333333333333, "max_step_rate_max": 1.0, "velocity_mean": 0.2189601860882553, "velocity_min": 0.20766922923956896, "velocity_max": 0.22799306167523586, "steering_mean": -0.0463895556841826, "steering_min": -0.09470507073235679, "steering_max": 0.004365405878863177, "step_reward_mean": 0.012758991095969844, "step_reward_min": 0.011427863783562257, "step_reward_max": 0.013728345136531131, "acceleration_mean": -0.00016720001727988168, "acceleration_min": -0.02547706769622115, "acceleration_max": 0.02444842687019935, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 770.8333333333334, "episode_length_min": 615.0, "episode_length_max": 999.0, "episode_reward_mean": 9.854069613581315, "episode_reward_min": 7.805667457084747, "episode_reward_max": 13.174425643886972, "num_neighbours_mean": 0.15744155718181133, "num_neighbours_min": 0.0, "num_neighbours_max": 0.3951219512195122, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 28.22001929404339, "environment_reward_total_min": 25.86125574220137, "environment_reward_total_max": 31.222669828338987}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999996, "cur_lr": 0.0003, "total_loss": 1.5647511887550354, "policy_loss": -0.0012661680579185487, "vf_loss": 1.5648325395584106, "vf_explained_var": 0.0008732569217681885, "kl": 0.005924008722067811, "entropy": 2.8393333101272584, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 105.5, "diff_num_grad_updates_vs_sampler_policy": 24.5}}, "num_env_steps_sampled": 6000, "num_env_steps_trained": 6000, "num_agent_steps_sampled": 14108, "num_agent_steps_trained": 14108}, "sampler_results": {"episode_reward_max": 26.380314769721366, "episode_reward_min": 9.442897069674476, "episode_reward_mean": 15.73870416562524, "episode_len_mean": 1244.5, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -7.696558404176836}, "policy_reward_max": {"default": 14.212589162106731}, "policy_reward_mean": {"default": 5.246234721875081}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.37499999999999994, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.6666666666666666, "max_step_rate_mean": 0.625, "max_step_rate_min": 0.3333333333333333, "max_step_rate_max": 1.0, "velocity_mean": 0.2189601860882553, "velocity_min": 0.20766922923956896, "velocity_max": 0.22799306167523586, "steering_mean": -0.0463895556841826, "steering_min": -0.09470507073235679, "steering_max": 0.004365405878863177, "step_reward_mean": 0.012758991095969844, "step_reward_min": 0.011427863783562257, "step_reward_max": 0.013728345136531131, "acceleration_mean": -0.00016720001727988168, "acceleration_min": -0.02547706769622115, "acceleration_max": 0.02444842687019935, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 770.8333333333334, "episode_length_min": 615.0, "episode_length_max": 999.0, "episode_reward_mean": 9.854069613581315, "episode_reward_min": 7.805667457084747, "episode_reward_max": 13.174425643886972, "num_neighbours_mean": 0.15744155718181133, "num_neighbours_min": 0.0, "num_neighbours_max": 0.3951219512195122, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 28.22001929404339, "environment_reward_total_min": 25.86125574220137, "environment_reward_total_max": 31.222669828338987}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155], "episode_lengths": [1000, 1514, 1173, 1291], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38654228009837355, "mean_inference_ms": 0.6076103543590712, "mean_action_processing_ms": 0.20399640111336415, "mean_env_wait_ms": 1.3188392429478974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004500150680541992, "StateBufferConnector_ms": 0.003165006637573242, "ViewRequirementAgentConnector_ms": 0.09275078773498535}}, "episode_reward_max": 26.380314769721366, "episode_reward_min": 9.442897069674476, "episode_reward_mean": 5.246234721875081, "episode_len_mean": 1244.5, "episodes_this_iter": 1, "policy_reward_min": {"default": -7.696558404176836}, "policy_reward_max": {"default": 14.212589162106731}, "policy_reward_mean": {"default": 5.246234721875081}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155], "episode_lengths": [1000, 1514, 1173, 1291], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38654228009837355, "mean_inference_ms": 0.6076103543590712, "mean_action_processing_ms": 0.20399640111336415, "mean_env_wait_ms": 1.3188392429478974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004500150680541992, "StateBufferConnector_ms": 0.003165006637573242, "ViewRequirementAgentConnector_ms": 0.09275078773498535}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14108, "num_agent_steps_trained": 14108, "num_env_steps_sampled": 6000, "num_env_steps_trained": 6000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 356.8099048831094, "num_env_steps_trained_throughput_per_sec": 356.8099048831094, "timesteps_total": 6000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 14108, "timers": {"training_iteration_time_ms": 5690.582, "sample_time_ms": 5118.639, "load_time_ms": 7.313, "load_throughput": 273482.113, "learn_time_ms": 562.473, "learn_throughput": 3555.728, "synch_weights_time_ms": 1.539}, "counters": {"num_env_steps_sampled": 6000, "num_env_steps_trained": 6000, "num_agent_steps_sampled": 14108, "num_agent_steps_trained": 14108}, "done": false, "episodes_total": 4, "training_iteration": 3, "trial_id": "3f391_00000", "date": "2023-12-26_23-20-40", "timestamp": 1703604040, "time_this_iter_s": 5.608112096786499, "time_total_s": 17.080535411834717, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 17.080535411834717, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 16.9375, "ram_util_percent": 59.849999999999994}, "success": 0.0, "crash": 0.0, "out": 0.37499999999999994, "max_step": 0.625, "length": 1244.5, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 15.73870416562524}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.38888888888888884, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.6666666666666666, "max_step_rate_mean": 0.611111111111111, "max_step_rate_min": 0.3333333333333333, "max_step_rate_max": 1.0, "velocity_mean": 0.2177879352761255, "velocity_min": 0.20766922923956896, "velocity_max": 0.22799306167523586, "steering_mean": -0.0442935570460572, "steering_min": -0.09470507073235679, "steering_max": 0.004365405878863177, "step_reward_mean": 0.012607067646506834, "step_reward_min": 0.011427863783562257, "step_reward_max": 0.013728345136531131, "acceleration_mean": -0.006141659882686473, "acceleration_min": -0.02547706769622115, "acceleration_max": 0.02444842687019935, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 753.888888888889, "episode_length_min": 615.0, "episode_length_max": 999.0, "episode_reward_mean": 9.522883696340477, "episode_reward_min": 7.805667457084747, "episode_reward_max": 13.174425643886972, "num_neighbours_mean": 0.10496103812120755, "num_neighbours_min": 0.0, "num_neighbours_max": 0.3951219512195122, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.1666666666666665, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 29.10135451919938, "environment_reward_total_min": 25.86125574220137, "environment_reward_total_max": 34.259915071479824}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.1999999999999999, "cur_lr": 0.00030000000000000003, "total_loss": 2.4073618720878254, "policy_loss": 0.010205174779350108, "vf_loss": 2.3965220521796833, "vf_explained_var": 0.0005395412445068359, "kl": 0.0031732553110818094, "entropy": 2.8646033893931997, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 158.0, "diff_num_grad_updates_vs_sampler_policy": 27.0}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 20003, "num_agent_steps_trained": 20003}, "sampler_results": {"episode_reward_max": 26.380314769721366, "episode_reward_min": 9.442897069674476, "episode_reward_mean": 15.780818562684658, "episode_len_mean": 1301.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"default": -7.696558404176836}, "policy_reward_max": {"default": 14.212589162106731}, "policy_reward_mean": {"default": 4.9834163882162095}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.38888888888888884, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.6666666666666666, "max_step_rate_mean": 0.611111111111111, "max_step_rate_min": 0.3333333333333333, "max_step_rate_max": 1.0, "velocity_mean": 0.2177879352761255, "velocity_min": 0.20766922923956896, "velocity_max": 0.22799306167523586, "steering_mean": -0.0442935570460572, "steering_min": -0.09470507073235679, "steering_max": 0.004365405878863177, "step_reward_mean": 0.012607067646506834, "step_reward_min": 0.011427863783562257, "step_reward_max": 0.013728345136531131, "acceleration_mean": -0.006141659882686473, "acceleration_min": -0.02547706769622115, "acceleration_max": 0.02444842687019935, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 753.888888888889, "episode_length_min": 615.0, "episode_length_max": 999.0, "episode_reward_mean": 9.522883696340477, "episode_reward_min": 7.805667457084747, "episode_reward_max": 13.174425643886972, "num_neighbours_mean": 0.10496103812120755, "num_neighbours_min": 0.0, "num_neighbours_max": 0.3951219512195122, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.1666666666666665, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 29.10135451919938, "environment_reward_total_min": 25.86125574220137, "environment_reward_total_max": 34.259915071479824}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3920157666716992, "mean_inference_ms": 0.606643332055127, "mean_action_processing_ms": 0.20219571167033737, "mean_env_wait_ms": 1.306993621911093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004780292510986328, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.08659760157267253}}, "episode_reward_max": 26.380314769721366, "episode_reward_min": 9.442897069674476, "episode_reward_mean": 4.9834163882162095, "episode_len_mean": 1301.0, "episodes_this_iter": 2, "policy_reward_min": {"default": -7.696558404176836}, "policy_reward_max": {"default": 14.212589162106731}, "policy_reward_mean": {"default": 4.9834163882162095}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3920157666716992, "mean_inference_ms": 0.606643332055127, "mean_action_processing_ms": 0.20219571167033737, "mean_env_wait_ms": 1.306993621911093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004780292510986328, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.08659760157267253}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20003, "num_agent_steps_trained": 20003, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 356.6281627145582, "num_env_steps_trained_throughput_per_sec": 356.6281627145582, "timesteps_total": 8000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 20003, "timers": {"training_iteration_time_ms": 5669.952, "sample_time_ms": 5117.545, "load_time_ms": 6.757, "load_throughput": 295993.649, "learn_time_ms": 543.517, "learn_throughput": 3679.739, "synch_weights_time_ms": 1.563}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 20003, "num_agent_steps_trained": 20003}, "done": false, "episodes_total": 6, "training_iteration": 4, "trial_id": "3f391_00000", "date": "2023-12-26_23-20-46", "timestamp": 1703604046, "time_this_iter_s": 5.61135721206665, "time_total_s": 22.691892623901367, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 22.691892623901367, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 16.7875, "ram_util_percent": 59.8125}, "success": 0.0, "crash": 0.0, "out": 0.38888888888888884, "max_step": 0.611111111111111, "length": 1301.0, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 15.780818562684658}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.3333333333333333, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.6666666666666666, "max_step_rate_mean": 0.6666666666666666, "max_step_rate_min": 0.3333333333333333, "max_step_rate_max": 1.0, "velocity_mean": 0.21571188962718107, "velocity_min": 0.2032556157335147, "velocity_max": 0.22799306167523586, "steering_mean": -0.04240421433549983, "steering_min": -0.09470507073235679, "steering_max": 0.004365405878863177, "step_reward_mean": 0.01230258644592599, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.013728345136531131, "acceleration_mean": -0.01067103791348954, "acceleration_min": -0.037847306098307935, "acceleration_max": 0.02444842687019935, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 788.904761904762, "episode_length_min": 615.0, "episode_length_max": 999.0, "episode_reward_mean": 9.657503674463047, "episode_reward_min": 7.805667457084747, "episode_reward_max": 13.174425643886972, "num_neighbours_mean": 0.08996660410389219, "num_neighbours_min": 0.0, "num_neighbours_max": 0.3951219512195122, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 27.934082028799033, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 34.259915071479824}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 0.7787203315645457, "policy_loss": 0.0061759427189826965, "vf_loss": 0.7715071075363085, "vf_explained_var": 0.006942428648471832, "kl": 0.010372627474134824, "entropy": 2.8931903898715974, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 205.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_agent_steps_sampled": 24225, "num_agent_steps_trained": 24225}, "sampler_results": {"episode_reward_max": 26.380314769721366, "episode_reward_min": 9.442897069674476, "episode_reward_mean": 16.51762100558702, "episode_len_mean": 1258.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -7.696558404176836}, "policy_reward_max": {"default": 14.212589162106731}, "policy_reward_mean": {"default": 5.505873668529006}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.3333333333333333, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.6666666666666666, "max_step_rate_mean": 0.6666666666666666, "max_step_rate_min": 0.3333333333333333, "max_step_rate_max": 1.0, "velocity_mean": 0.21571188962718107, "velocity_min": 0.2032556157335147, "velocity_max": 0.22799306167523586, "steering_mean": -0.04240421433549983, "steering_min": -0.09470507073235679, "steering_max": 0.004365405878863177, "step_reward_mean": 0.01230258644592599, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.013728345136531131, "acceleration_mean": -0.01067103791348954, "acceleration_min": -0.037847306098307935, "acceleration_max": 0.02444842687019935, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 788.904761904762, "episode_length_min": 615.0, "episode_length_max": 999.0, "episode_reward_mean": 9.657503674463047, "episode_reward_min": 7.805667457084747, "episode_reward_max": 13.174425643886972, "num_neighbours_mean": 0.08996660410389219, "num_neighbours_min": 0.0, "num_neighbours_max": 0.3951219512195122, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 27.934082028799033, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 34.259915071479824}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3925906173905699, "mean_inference_ms": 0.6059991248000761, "mean_action_processing_ms": 0.20184973315578117, "mean_env_wait_ms": 1.3037937218879598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048433031354631695, "StateBufferConnector_ms": 0.003249304635184152, "ViewRequirementAgentConnector_ms": 0.09589195251464844}}, "episode_reward_max": 26.380314769721366, "episode_reward_min": 9.442897069674476, "episode_reward_mean": 5.505873668529006, "episode_len_mean": 1258.0, "episodes_this_iter": 1, "policy_reward_min": {"default": -7.696558404176836}, "policy_reward_max": {"default": 14.212589162106731}, "policy_reward_mean": {"default": 5.505873668529006}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3925906173905699, "mean_inference_ms": 0.6059991248000761, "mean_action_processing_ms": 0.20184973315578117, "mean_env_wait_ms": 1.3037937218879598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048433031354631695, "StateBufferConnector_ms": 0.003249304635184152, "ViewRequirementAgentConnector_ms": 0.09589195251464844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24225, "num_agent_steps_trained": 24225, "num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 378.3488812117075, "num_env_steps_trained_throughput_per_sec": 378.3488812117075, "timesteps_total": 10000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 24225, "timers": {"training_iteration_time_ms": 5593.183, "sample_time_ms": 5096.56, "load_time_ms": 6.206, "load_throughput": 322281.78, "learn_time_ms": 488.363, "learn_throughput": 4095.317, "synch_weights_time_ms": 1.533}, "counters": {"num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_agent_steps_sampled": 24225, "num_agent_steps_trained": 24225}, "done": false, "episodes_total": 7, "training_iteration": 5, "trial_id": "3f391_00000", "date": "2023-12-26_23-20-51", "timestamp": 1703604051, "time_this_iter_s": 5.289481163024902, "time_total_s": 27.98137378692627, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 27.98137378692627, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 15.5, "ram_util_percent": 59.87142857142856}, "success": 0.0, "crash": 0.0, "out": 0.3333333333333333, "max_step": 0.6666666666666666, "length": 1258.0, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 16.51762100558702}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.3333333333333333, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.6666666666666666, "max_step_rate_mean": 0.6666666666666666, "max_step_rate_min": 0.3333333333333333, "max_step_rate_max": 1.0, "velocity_mean": 0.21638642146243434, "velocity_min": 0.2032556157335147, "velocity_max": 0.22799306167523586, "steering_mean": -0.04247417030520889, "steering_min": -0.09470507073235679, "steering_max": 0.006405850321970369, "step_reward_mean": 0.012335892281579714, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.013728345136531131, "acceleration_mean": -0.01242586247585217, "acceleration_min": -0.037847306098307935, "acceleration_max": 0.02444842687019935, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 803.4074074074074, "episode_length_min": 615.0, "episode_length_max": 999.0, "episode_reward_mean": 9.873924246609201, "episode_reward_min": 7.805667457084747, "episode_reward_max": 13.174425643886972, "num_neighbours_mean": 0.10797420053015272, "num_neighbours_min": 0.0, "num_neighbours_max": 0.3951219512195122, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 28.8141057440353, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 34.259915071479824}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09999999999999996, "cur_lr": 0.0003, "total_loss": 1.381461297472318, "policy_loss": -0.004530698806047439, "vf_loss": 1.3855514587627518, "vf_explained_var": 0.0007526238759358723, "kl": 0.004405317440654925, "entropy": 2.893975257873535, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 248.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 28845, "num_agent_steps_trained": 28845}, "sampler_results": {"episode_reward_max": 26.380314769721366, "episode_reward_min": 9.442897069674476, "episode_reward_mean": 17.716036930649153, "episode_len_mean": 1331.888888888889, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"default": -7.696558404176836}, "policy_reward_max": {"default": 14.44400489366709}, "policy_reward_mean": {"default": 5.90534564354972}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.3333333333333333, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.6666666666666666, "max_step_rate_mean": 0.6666666666666666, "max_step_rate_min": 0.3333333333333333, "max_step_rate_max": 1.0, "velocity_mean": 0.21638642146243434, "velocity_min": 0.2032556157335147, "velocity_max": 0.22799306167523586, "steering_mean": -0.04247417030520889, "steering_min": -0.09470507073235679, "steering_max": 0.006405850321970369, "step_reward_mean": 0.012335892281579714, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.013728345136531131, "acceleration_mean": -0.01242586247585217, "acceleration_min": -0.037847306098307935, "acceleration_max": 0.02444842687019935, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 803.4074074074074, "episode_length_min": 615.0, "episode_length_max": 999.0, "episode_reward_mean": 9.873924246609201, "episode_reward_min": 7.805667457084747, "episode_reward_max": 13.174425643886972, "num_neighbours_mean": 0.10797420053015272, "num_neighbours_min": 0.0, "num_neighbours_max": 0.3951219512195122, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 28.8141057440353, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 34.259915071479824}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3926653050274236, "mean_inference_ms": 0.6042842152180081, "mean_action_processing_ms": 0.20030099650488864, "mean_env_wait_ms": 1.292329992297797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0045299530029296875, "StateBufferConnector_ms": 0.0031683180067274305, "ViewRequirementAgentConnector_ms": 0.09246932135687934}}, "episode_reward_max": 26.380314769721366, "episode_reward_min": 9.442897069674476, "episode_reward_mean": 5.90534564354972, "episode_len_mean": 1331.888888888889, "episodes_this_iter": 2, "policy_reward_min": {"default": -7.696558404176836}, "policy_reward_max": {"default": 14.44400489366709}, "policy_reward_mean": {"default": 5.90534564354972}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3926653050274236, "mean_inference_ms": 0.6042842152180081, "mean_action_processing_ms": 0.20030099650488864, "mean_env_wait_ms": 1.292329992297797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0045299530029296875, "StateBufferConnector_ms": 0.0031683180067274305, "ViewRequirementAgentConnector_ms": 0.09246932135687934}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28845, "num_agent_steps_trained": 28845, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 406.31852162314715, "num_env_steps_trained_throughput_per_sec": 406.31852162314715, "timesteps_total": 12000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 28845, "timers": {"training_iteration_time_ms": 5481.357, "sample_time_ms": 5003.93, "load_time_ms": 7.963, "load_throughput": 251162.195, "learn_time_ms": 467.449, "learn_throughput": 4278.543, "synch_weights_time_ms": 1.499}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 28845, "num_agent_steps_trained": 28845}, "done": false, "episodes_total": 9, "training_iteration": 6, "trial_id": "3f391_00000", "date": "2023-12-26_23-20-56", "timestamp": 1703604056, "time_this_iter_s": 4.926539421081543, "time_total_s": 32.90791320800781, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 32.90791320800781, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 15.771428571428572, "ram_util_percent": 59.857142857142854}, "success": 0.0, "crash": 0.0, "out": 0.3333333333333333, "max_step": 0.6666666666666666, "length": 1331.888888888889, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 17.716036930649153}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.35, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.6666666666666666, "max_step_rate_mean": 0.65, "max_step_rate_min": 0.3333333333333333, "max_step_rate_max": 1.0, "velocity_mean": 0.21621574933494064, "velocity_min": 0.2032556157335147, "velocity_max": 0.22799306167523586, "steering_mean": -0.04493210573206683, "steering_min": -0.09470507073235679, "steering_max": 0.006405850321970369, "step_reward_mean": 0.012321518522581803, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.013728345136531131, "acceleration_mean": -0.013548122557774244, "acceleration_min": -0.037847306098307935, "acceleration_max": 0.02444842687019935, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 791.9416666666667, "episode_length_min": 615.0, "episode_length_max": 999.0, "episode_reward_mean": 9.726266476332274, "episode_reward_min": 7.805667457084747, "episode_reward_max": 13.174425643886972, "num_neighbours_mean": 0.11104247920672003, "num_neighbours_min": 0.0, "num_neighbours_max": 0.3951219512195122, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.1, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 29.291633787167733, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 34.259915071479824}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.049999999999999975, "cur_lr": 0.00030000000000000003, "total_loss": 1.9459884172474795, "policy_loss": -0.0031969558108936656, "vf_loss": 1.9489408739588476, "vf_explained_var": 0.016090407154776835, "kl": 0.004890298392009883, "entropy": 2.8611184163527055, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 298.0, "diff_num_grad_updates_vs_sampler_policy": 27.0}}, "num_env_steps_sampled": 14000, "num_env_steps_trained": 14000, "num_agent_steps_sampled": 34590, "num_agent_steps_trained": 34590}, "sampler_results": {"episode_reward_max": 26.380314769721366, "episode_reward_min": 9.442897069674476, "episode_reward_mean": 17.30390737716032, "episode_len_mean": 1379.6, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -7.696558404176836}, "policy_reward_max": {"default": 14.44400489366709}, "policy_reward_mean": {"default": 5.581905605535589}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.35, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.6666666666666666, "max_step_rate_mean": 0.65, "max_step_rate_min": 0.3333333333333333, "max_step_rate_max": 1.0, "velocity_mean": 0.21621574933494064, "velocity_min": 0.2032556157335147, "velocity_max": 0.22799306167523586, "steering_mean": -0.04493210573206683, "steering_min": -0.09470507073235679, "steering_max": 0.006405850321970369, "step_reward_mean": 0.012321518522581803, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.013728345136531131, "acceleration_mean": -0.013548122557774244, "acceleration_min": -0.037847306098307935, "acceleration_max": 0.02444842687019935, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 791.9416666666667, "episode_length_min": 615.0, "episode_length_max": 999.0, "episode_reward_mean": 9.726266476332274, "episode_reward_min": 7.805667457084747, "episode_reward_max": 13.174425643886972, "num_neighbours_mean": 0.11104247920672003, "num_neighbours_min": 0.0, "num_neighbours_max": 0.3951219512195122, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.1, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 29.291633787167733, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 34.259915071479824}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39269838121410816, "mean_inference_ms": 0.6033998674491092, "mean_action_processing_ms": 0.19949647145161484, "mean_env_wait_ms": 1.2866351353996084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004446506500244141, "StateBufferConnector_ms": 0.0031518936157226562, "ViewRequirementAgentConnector_ms": 0.09092092514038086}}, "episode_reward_max": 26.380314769721366, "episode_reward_min": 9.442897069674476, "episode_reward_mean": 5.581905605535589, "episode_len_mean": 1379.6, "episodes_this_iter": 1, "policy_reward_min": {"default": -7.696558404176836}, "policy_reward_max": {"default": 14.44400489366709}, "policy_reward_mean": {"default": 5.581905605535589}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39269838121410816, "mean_inference_ms": 0.6033998674491092, "mean_action_processing_ms": 0.19949647145161484, "mean_env_wait_ms": 1.2866351353996084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004446506500244141, "StateBufferConnector_ms": 0.0031518936157226562, "ViewRequirementAgentConnector_ms": 0.09092092514038086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34590, "num_agent_steps_trained": 34590, "num_env_steps_sampled": 14000, "num_env_steps_trained": 14000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 394.35626264799686, "num_env_steps_trained_throughput_per_sec": 394.35626264799686, "timesteps_total": 14000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 34590, "timers": {"training_iteration_time_ms": 5422.809, "sample_time_ms": 4959.102, "load_time_ms": 7.362, "load_throughput": 271655.584, "learn_time_ms": 454.372, "learn_throughput": 4401.676, "synch_weights_time_ms": 1.479}, "counters": {"num_env_steps_sampled": 14000, "num_env_steps_trained": 14000, "num_agent_steps_sampled": 34590, "num_agent_steps_trained": 34590}, "done": false, "episodes_total": 10, "training_iteration": 7, "trial_id": "3f391_00000", "date": "2023-12-26_23-21-01", "timestamp": 1703604061, "time_this_iter_s": 5.075484752655029, "time_total_s": 37.98339796066284, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 37.98339796066284, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 15.450000000000001, "ram_util_percent": 59.849999999999994}, "success": 0.0, "crash": 0.0, "out": 0.35, "max_step": 0.65, "length": 1379.6, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 17.30390737716032}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.3484848484848485, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.6666666666666666, "max_step_rate_mean": 0.6515151515151515, "max_step_rate_min": 0.3333333333333333, "max_step_rate_max": 1.0, "velocity_mean": 0.21751543734205836, "velocity_min": 0.2032556157335147, "velocity_max": 0.2305123174132356, "steering_mean": -0.04474401318758713, "steering_min": -0.09470507073235679, "steering_max": 0.006405850321970369, "step_reward_mean": 0.012451519216359286, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.013751526154134122, "acceleration_mean": -0.012187703296324136, "acceleration_min": -0.037847306098307935, "acceleration_max": 0.02444842687019935, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 791.6439393939395, "episode_length_min": 615.0, "episode_length_max": 999.0, "episode_reward_mean": 9.82800318698938, "episode_reward_min": 7.805667457084747, "episode_reward_max": 13.174425643886972, "num_neighbours_mean": 0.10094770836974548, "num_neighbours_min": 0.0, "num_neighbours_max": 0.3951219512195122, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.090909090909091, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 29.586586250214427, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 34.259915071479824}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.02499999999999999, "cur_lr": 0.0003, "total_loss": 1.498319411277771, "policy_loss": 0.009991262522008684, "vf_loss": 1.4879888870649867, "vf_explained_var": 0.011214676168229845, "kl": 0.01357019416884422, "entropy": 2.924878787994385, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 348.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 39435, "num_agent_steps_trained": 39435}, "sampler_results": {"episode_reward_max": 26.380314769721366, "episode_reward_min": 9.442897069674476, "episode_reward_mean": 17.77924173807639, "episode_len_mean": 1380.909090909091, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -7.696558404176836}, "policy_reward_max": {"default": 15.95668745966219}, "policy_reward_mean": {"default": 5.752107621142363}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.3484848484848485, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.6666666666666666, "max_step_rate_mean": 0.6515151515151515, "max_step_rate_min": 0.3333333333333333, "max_step_rate_max": 1.0, "velocity_mean": 0.21751543734205836, "velocity_min": 0.2032556157335147, "velocity_max": 0.2305123174132356, "steering_mean": -0.04474401318758713, "steering_min": -0.09470507073235679, "steering_max": 0.006405850321970369, "step_reward_mean": 0.012451519216359286, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.013751526154134122, "acceleration_mean": -0.012187703296324136, "acceleration_min": -0.037847306098307935, "acceleration_max": 0.02444842687019935, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 791.6439393939395, "episode_length_min": 615.0, "episode_length_max": 999.0, "episode_reward_mean": 9.82800318698938, "episode_reward_min": 7.805667457084747, "episode_reward_max": 13.174425643886972, "num_neighbours_mean": 0.10094770836974548, "num_neighbours_min": 0.0, "num_neighbours_max": 0.3951219512195122, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.090909090909091, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 29.586586250214427, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 34.259915071479824}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39255480889140465, "mean_inference_ms": 0.6026427657912875, "mean_action_processing_ms": 0.19888478271542417, "mean_env_wait_ms": 1.2821361235936928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004640492525967685, "StateBufferConnector_ms": 0.003134120594371449, "ViewRequirementAgentConnector_ms": 0.08922273462468927}}, "episode_reward_max": 26.380314769721366, "episode_reward_min": 9.442897069674476, "episode_reward_mean": 5.752107621142363, "episode_len_mean": 1380.909090909091, "episodes_this_iter": 1, "policy_reward_min": {"default": -7.696558404176836}, "policy_reward_max": {"default": 15.95668745966219}, "policy_reward_mean": {"default": 5.752107621142363}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39255480889140465, "mean_inference_ms": 0.6026427657912875, "mean_action_processing_ms": 0.19888478271542417, "mean_env_wait_ms": 1.2821361235936928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004640492525967685, "StateBufferConnector_ms": 0.003134120594371449, "ViewRequirementAgentConnector_ms": 0.08922273462468927}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39435, "num_agent_steps_trained": 39435, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 373.9861632473948, "num_env_steps_trained_throughput_per_sec": 373.9861632473948, "timesteps_total": 16000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 39435, "timers": {"training_iteration_time_ms": 5413.429, "sample_time_ms": 4968.586, "load_time_ms": 6.959, "load_throughput": 287379.514, "learn_time_ms": 435.956, "learn_throughput": 4587.62, "synch_weights_time_ms": 1.459}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 39435, "num_agent_steps_trained": 39435}, "done": false, "episodes_total": 11, "training_iteration": 8, "trial_id": "3f391_00000", "date": "2023-12-26_23-21-06", "timestamp": 1703604066, "time_this_iter_s": 5.3516881465911865, "time_total_s": 43.33508610725403, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 43.33508610725403, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 16.67142857142857, "ram_util_percent": 59.89999999999999}, "success": 0.0, "crash": 0.0, "out": 0.3484848484848485, "max_step": 0.6515151515151515, "length": 1380.909090909091, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 17.77924173807639}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.34722222222222227, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.6666666666666666, "max_step_rate_mean": 0.6527777777777778, "max_step_rate_min": 0.3333333333333333, "max_step_rate_max": 1.0, "velocity_mean": 0.219476780528188, "velocity_min": 0.2032556157335147, "velocity_max": 0.24105155557561422, "steering_mean": -0.04610293596817239, "steering_min": -0.09470507073235679, "steering_max": 0.006405850321970369, "step_reward_mean": 0.012687998309382212, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.015289268332634396, "acceleration_mean": -0.008239952058633065, "acceleration_min": -0.037847306098307935, "acceleration_max": 0.03518531155596872, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 787.9791666666666, "episode_length_min": 615.0, "episode_length_max": 999.0, "episode_reward_mean": 9.961609278909679, "episode_reward_min": 7.805667457084747, "episode_reward_max": 13.174425643886972, "num_neighbours_mean": 0.09253539933893336, "num_neighbours_min": 0.0, "num_neighbours_max": 0.3951219512195122, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0833333333333335, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 29.978856468538137, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 34.29382887009892}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0003, "total_loss": 1.5312477570559297, "policy_loss": -0.014136048832109996, "vf_loss": 1.545009481055396, "vf_explained_var": -0.025534817150660923, "kl": 0.014973190972315522, "entropy": 2.9381986209324427, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 388.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 43410, "num_agent_steps_trained": 43410}, "sampler_results": {"episode_reward_max": 26.380314769721366, "episode_reward_min": 9.442897069674476, "episode_reward_mean": 18.32244119235418, "episode_len_mean": 1371.75, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -7.696558404176836}, "policy_reward_max": {"default": 17.692941992036356}, "policy_reward_mean": {"default": 5.942413359682437}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.34722222222222227, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.6666666666666666, "max_step_rate_mean": 0.6527777777777778, "max_step_rate_min": 0.3333333333333333, "max_step_rate_max": 1.0, "velocity_mean": 0.219476780528188, "velocity_min": 0.2032556157335147, "velocity_max": 0.24105155557561422, "steering_mean": -0.04610293596817239, "steering_min": -0.09470507073235679, "steering_max": 0.006405850321970369, "step_reward_mean": 0.012687998309382212, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.015289268332634396, "acceleration_mean": -0.008239952058633065, "acceleration_min": -0.037847306098307935, "acceleration_max": 0.03518531155596872, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 787.9791666666666, "episode_length_min": 615.0, "episode_length_max": 999.0, "episode_reward_mean": 9.961609278909679, "episode_reward_min": 7.805667457084747, "episode_reward_max": 13.174425643886972, "num_neighbours_mean": 0.09253539933893336, "num_neighbours_min": 0.0, "num_neighbours_max": 0.3951219512195122, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0833333333333335, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 29.978856468538137, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 34.29382887009892}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39192615589292207, "mean_inference_ms": 0.6018880407227702, "mean_action_processing_ms": 0.19824620464838083, "mean_env_wait_ms": 1.2779077028322556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0045359134674072266, "StateBufferConnector_ms": 0.0031212965647379556, "ViewRequirementAgentConnector_ms": 0.08815924326578777}}, "episode_reward_max": 26.380314769721366, "episode_reward_min": 9.442897069674476, "episode_reward_mean": 5.942413359682437, "episode_len_mean": 1371.75, "episodes_this_iter": 1, "policy_reward_min": {"default": -7.696558404176836}, "policy_reward_max": {"default": 17.692941992036356}, "policy_reward_mean": {"default": 5.942413359682437}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39192615589292207, "mean_inference_ms": 0.6018880407227702, "mean_action_processing_ms": 0.19824620464838083, "mean_env_wait_ms": 1.2779077028322556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0045359134674072266, "StateBufferConnector_ms": 0.0031212965647379556, "ViewRequirementAgentConnector_ms": 0.08815924326578777}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43410, "num_agent_steps_trained": 43410, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 407.63247666256973, "num_env_steps_trained_throughput_per_sec": 407.63247666256973, "timesteps_total": 18000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 43410, "timers": {"training_iteration_time_ms": 5357.088, "sample_time_ms": 4934.66, "load_time_ms": 6.576, "load_throughput": 304126.07, "learn_time_ms": 413.937, "learn_throughput": 4831.657, "synch_weights_time_ms": 1.46}, "counters": {"num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 43410, "num_agent_steps_trained": 43410}, "done": false, "episodes_total": 12, "training_iteration": 9, "trial_id": "3f391_00000", "date": "2023-12-26_23-21-11", "timestamp": 1703604071, "time_this_iter_s": 4.910247087478638, "time_total_s": 48.245333194732666, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 48.245333194732666, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 15.685714285714285, "ram_util_percent": 59.871428571428574}, "success": 0.0, "crash": 0.0, "out": 0.34722222222222227, "max_step": 0.6527777777777778, "length": 1371.75, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 18.32244119235418}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.36904761904761907, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.6666666666666666, "max_step_rate_mean": 0.630952380952381, "max_step_rate_min": 0.3333333333333333, "max_step_rate_max": 1.0, "velocity_mean": 0.22292159305548415, "velocity_min": 0.2032556157335147, "velocity_max": 0.250083505648223, "steering_mean": -0.0381447855516979, "steering_min": -0.09470507073235679, "steering_max": 0.036365765195201946, "step_reward_mean": 0.013031216017934012, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.015659696871625366, "acceleration_mean": -0.005126979307961238, "acceleration_min": -0.037847306098307935, "acceleration_max": 0.037879840312180696, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 788.4107142857143, "episode_length_min": 615.0, "episode_length_max": 999.0, "episode_reward_mean": 10.237978198808815, "episode_reward_min": 7.805667457084747, "episode_reward_max": 13.174425643886972, "num_neighbours_mean": 0.09376197415439676, "num_neighbours_min": 0.0, "num_neighbours_max": 0.3951219512195122, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0714285714285716, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 30.79453056654853, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 37.55220506651101}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0003, "total_loss": 1.022367186365383, "policy_loss": 0.01171874680689403, "vf_loss": 1.010527132291879, "vf_explained_var": -0.004463762896401542, "kl": 0.004853366907420044, "entropy": 3.000916085924421, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 423.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 47293, "num_agent_steps_trained": 47293}, "sampler_results": {"episode_reward_max": 27.56203973161316, "episode_reward_min": 9.442897069674476, "episode_reward_mean": 18.662233085155645, "episode_len_mean": 1375.9285714285713, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"default": -7.696558404176836}, "policy_reward_max": {"default": 17.692941992036356}, "policy_reward_mean": {"default": 6.076075888190211}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.36904761904761907, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.6666666666666666, "max_step_rate_mean": 0.630952380952381, "max_step_rate_min": 0.3333333333333333, "max_step_rate_max": 1.0, "velocity_mean": 0.22292159305548415, "velocity_min": 0.2032556157335147, "velocity_max": 0.250083505648223, "steering_mean": -0.0381447855516979, "steering_min": -0.09470507073235679, "steering_max": 0.036365765195201946, "step_reward_mean": 0.013031216017934012, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.015659696871625366, "acceleration_mean": -0.005126979307961238, "acceleration_min": -0.037847306098307935, "acceleration_max": 0.037879840312180696, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 788.4107142857143, "episode_length_min": 615.0, "episode_length_max": 999.0, "episode_reward_mean": 10.237978198808815, "episode_reward_min": 7.805667457084747, "episode_reward_max": 13.174425643886972, "num_neighbours_mean": 0.09376197415439676, "num_neighbours_min": 0.0, "num_neighbours_max": 0.3951219512195122, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0714285714285716, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 30.79453056654853, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 37.55220506651101}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3908379117037604, "mean_inference_ms": 0.600513531250679, "mean_action_processing_ms": 0.19731856691444966, "mean_env_wait_ms": 1.2717113235124813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004657677241734096, "StateBufferConnector_ms": 0.003124986376081194, "ViewRequirementAgentConnector_ms": 0.08660895483834403}}, "episode_reward_max": 27.56203973161316, "episode_reward_min": 9.442897069674476, "episode_reward_mean": 6.076075888190211, "episode_len_mean": 1375.9285714285713, "episodes_this_iter": 2, "policy_reward_min": {"default": -7.696558404176836}, "policy_reward_max": {"default": 17.692941992036356}, "policy_reward_mean": {"default": 6.076075888190211}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3908379117037604, "mean_inference_ms": 0.600513531250679, "mean_action_processing_ms": 0.19731856691444966, "mean_env_wait_ms": 1.2717113235124813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004657677241734096, "StateBufferConnector_ms": 0.003124986376081194, "ViewRequirementAgentConnector_ms": 0.08660895483834403}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47293, "num_agent_steps_trained": 47293, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 386.2914955811327, "num_env_steps_trained_throughput_per_sec": 386.2914955811327, "timesteps_total": 20000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 47293, "timers": {"training_iteration_time_ms": 5339.121, "sample_time_ms": 4934.564, "load_time_ms": 6.265, "load_throughput": 319236.445, "learn_time_ms": 396.406, "learn_throughput": 5045.33, "synch_weights_time_ms": 1.445}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 47293, "num_agent_steps_trained": 47293}, "done": false, "episodes_total": 14, "training_iteration": 10, "trial_id": "3f391_00000", "date": "2023-12-26_23-21-17", "timestamp": 1703604077, "time_this_iter_s": 5.181549310684204, "time_total_s": 53.42688250541687, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 53.42688250541687, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 15.375, "ram_util_percent": 59.9}, "success": 0.0, "crash": 0.0, "out": 0.36904761904761907, "max_step": 0.630952380952381, "length": 1375.9285714285713, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 18.662233085155645}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.3645833333333333, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.6666666666666666, "max_step_rate_mean": 0.6354166666666666, "max_step_rate_min": 0.3333333333333333, "max_step_rate_max": 1.0, "velocity_mean": 0.22536574130801545, "velocity_min": 0.2032556157335147, "velocity_max": 0.250083505648223, "steering_mean": -0.031227750801877938, "steering_min": -0.09470507073235679, "steering_max": 0.036365765195201946, "step_reward_mean": 0.013226551916628365, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.015659696871625366, "acceleration_mean": -0.005451676639345916, "acceleration_min": -0.037847306098307935, "acceleration_max": 0.037879840312180696, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 805.1927083333334, "episode_length_min": 615.0, "episode_length_max": 999.0, "episode_reward_mean": 10.639743588803901, "episode_reward_min": 7.805667457084747, "episode_reward_max": 14.406468684637044, "num_neighbours_mean": 0.10978394873208416, "num_neighbours_min": 0.0, "num_neighbours_max": 0.44387554155179204, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 31.089347947478714, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 37.55220506651101}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0003, "total_loss": 1.969117910521371, "policy_loss": -0.003276183349745614, "vf_loss": 1.9723465842860086, "vf_explained_var": 0.0025677595819745746, "kl": 0.0038054420030675827, "entropy": 2.9447458267211912, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 458.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 22000, "num_env_steps_trained": 22000, "num_agent_steps_sampled": 50940, "num_agent_steps_trained": 50940}, "sampler_results": {"episode_reward_max": 28.81252676068306, "episode_reward_min": 9.442897069674476, "episode_reward_mean": 19.222987421801985, "episode_len_mean": 1365.75, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"default": -7.696558404176836}, "policy_reward_max": {"default": 17.692941992036356}, "policy_reward_mean": {"default": 6.407662473933994}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.3645833333333333, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.6666666666666666, "max_step_rate_mean": 0.6354166666666666, "max_step_rate_min": 0.3333333333333333, "max_step_rate_max": 1.0, "velocity_mean": 0.22536574130801545, "velocity_min": 0.2032556157335147, "velocity_max": 0.250083505648223, "steering_mean": -0.031227750801877938, "steering_min": -0.09470507073235679, "steering_max": 0.036365765195201946, "step_reward_mean": 0.013226551916628365, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.015659696871625366, "acceleration_mean": -0.005451676639345916, "acceleration_min": -0.037847306098307935, "acceleration_max": 0.037879840312180696, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 805.1927083333334, "episode_length_min": 615.0, "episode_length_max": 999.0, "episode_reward_mean": 10.639743588803901, "episode_reward_min": 7.805667457084747, "episode_reward_max": 14.406468684637044, "num_neighbours_mean": 0.10978394873208416, "num_neighbours_min": 0.0, "num_neighbours_max": 0.44387554155179204, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 31.089347947478714, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 37.55220506651101}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38978379098482824, "mean_inference_ms": 0.5993414761571442, "mean_action_processing_ms": 0.1965521959981486, "mean_env_wait_ms": 1.2666460441472178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004556775093078613, "StateBufferConnector_ms": 0.0031575560569763184, "ViewRequirementAgentConnector_ms": 0.08807778358459473}}, "episode_reward_max": 28.81252676068306, "episode_reward_min": 9.442897069674476, "episode_reward_mean": 6.407662473933994, "episode_len_mean": 1365.75, "episodes_this_iter": 2, "policy_reward_min": {"default": -7.696558404176836}, "policy_reward_max": {"default": 17.692941992036356}, "policy_reward_mean": {"default": 6.407662473933994}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38978379098482824, "mean_inference_ms": 0.5993414761571442, "mean_action_processing_ms": 0.1965521959981486, "mean_env_wait_ms": 1.2666460441472178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004556775093078613, "StateBufferConnector_ms": 0.0031575560569763184, "ViewRequirementAgentConnector_ms": 0.08807778358459473}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50940, "num_agent_steps_trained": 50940, "num_env_steps_sampled": 22000, "num_env_steps_trained": 22000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 400.89409917863765, "num_env_steps_trained_throughput_per_sec": 400.89409917863765, "timesteps_total": 22000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 50940, "timers": {"training_iteration_time_ms": 5199.546, "sample_time_ms": 4875.245, "load_time_ms": 5.15, "load_throughput": 388363.279, "learn_time_ms": 317.302, "learn_throughput": 6303.149, "synch_weights_time_ms": 1.445}, "counters": {"num_env_steps_sampled": 22000, "num_env_steps_trained": 22000, "num_agent_steps_sampled": 50940, "num_agent_steps_trained": 50940}, "done": false, "episodes_total": 16, "training_iteration": 11, "trial_id": "3f391_00000", "date": "2023-12-26_23-21-22", "timestamp": 1703604082, "time_this_iter_s": 4.993303537368774, "time_total_s": 58.420186042785645, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 58.420186042785645, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 15.899999999999997, "ram_util_percent": 59.89999999999999}, "success": 0.0, "crash": 0.0, "out": 0.3645833333333333, "max_step": 0.6354166666666666, "length": 1365.75, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 19.222987421801985}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.3627450980392157, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.6666666666666666, "max_step_rate_mean": 0.6372549019607843, "max_step_rate_min": 0.3333333333333333, "max_step_rate_max": 1.0, "velocity_mean": 0.2259073754980292, "velocity_min": 0.2032556157335147, "velocity_max": 0.250083505648223, "steering_mean": -0.02846327513930411, "steering_min": -0.09470507073235679, "steering_max": 0.036365765195201946, "step_reward_mean": 0.013258283981370605, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.015659696871625366, "acceleration_mean": -0.007540752233665358, "acceleration_min": -0.04096596174277642, "acceleration_max": 0.037879840312180696, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 802.671568627451, "episode_length_min": 615.0, "episode_length_max": 999.0, "episode_reward_mean": 10.631186812569213, "episode_reward_min": 7.805667457084747, "episode_reward_max": 14.406468684637044, "num_neighbours_mean": 0.13856360122442513, "num_neighbours_min": 0.0, "num_neighbours_max": 0.5990380411018802, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 31.112494255182476, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 37.55220506651101}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00625, "cur_lr": 0.0003, "total_loss": 1.1534614911302925, "policy_loss": 0.008832301199436187, "vf_loss": 1.14450387340039, "vf_explained_var": 0.01808571070432663, "kl": 0.02004875691491196, "entropy": 2.990075045824051, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 495.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 55362, "num_agent_steps_trained": 55362}, "sampler_results": {"episode_reward_max": 28.81252676068306, "episode_reward_min": 9.442897069674476, "episode_reward_mean": 19.356987483346906, "episode_len_mean": 1362.764705882353, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -7.696558404176836}, "policy_reward_max": {"default": 17.692941992036356}, "policy_reward_mean": {"default": 6.452329161115635}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.3627450980392157, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.6666666666666666, "max_step_rate_mean": 0.6372549019607843, "max_step_rate_min": 0.3333333333333333, "max_step_rate_max": 1.0, "velocity_mean": 0.2259073754980292, "velocity_min": 0.2032556157335147, "velocity_max": 0.250083505648223, "steering_mean": -0.02846327513930411, "steering_min": -0.09470507073235679, "steering_max": 0.036365765195201946, "step_reward_mean": 0.013258283981370605, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.015659696871625366, "acceleration_mean": -0.007540752233665358, "acceleration_min": -0.04096596174277642, "acceleration_max": 0.037879840312180696, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 802.671568627451, "episode_length_min": 615.0, "episode_length_max": 999.0, "episode_reward_mean": 10.631186812569213, "episode_reward_min": 7.805667457084747, "episode_reward_max": 14.406468684637044, "num_neighbours_mean": 0.13856360122442513, "num_neighbours_min": 0.0, "num_neighbours_max": 0.5990380411018802, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 31.112494255182476, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 37.55220506651101}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38928499802674194, "mean_inference_ms": 0.5988532712073569, "mean_action_processing_ms": 0.19626936312434978, "mean_env_wait_ms": 1.265019867911336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004483671749339384, "StateBufferConnector_ms": 0.0031387104707605697, "ViewRequirementAgentConnector_ms": 0.0870957094080308}}, "episode_reward_max": 28.81252676068306, "episode_reward_min": 9.442897069674476, "episode_reward_mean": 6.452329161115635, "episode_len_mean": 1362.764705882353, "episodes_this_iter": 1, "policy_reward_min": {"default": -7.696558404176836}, "policy_reward_max": {"default": 17.692941992036356}, "policy_reward_mean": {"default": 6.452329161115635}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38928499802674194, "mean_inference_ms": 0.5988532712073569, "mean_action_processing_ms": 0.19626936312434978, "mean_env_wait_ms": 1.265019867911336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004483671749339384, "StateBufferConnector_ms": 0.0031387104707605697, "ViewRequirementAgentConnector_ms": 0.0870957094080308}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55362, "num_agent_steps_trained": 55362, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 374.14315808084183, "num_env_steps_trained_throughput_per_sec": 374.14315808084183, "timesteps_total": 24000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 55362, "timers": {"training_iteration_time_ms": 5225.903, "sample_time_ms": 4904.089, "load_time_ms": 5.107, "load_throughput": 391593.944, "learn_time_ms": 314.901, "learn_throughput": 6351.206, "synch_weights_time_ms": 1.421}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 55362, "num_agent_steps_trained": 55362}, "done": false, "episodes_total": 17, "training_iteration": 12, "trial_id": "3f391_00000", "date": "2023-12-26_23-21-27", "timestamp": 1703604087, "time_this_iter_s": 5.350122928619385, "time_total_s": 63.77030897140503, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 63.77030897140503, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 16.45, "ram_util_percent": 59.9}, "success": 0.0, "crash": 0.0, "out": 0.3627450980392157, "max_step": 0.6372549019607843, "length": 1362.764705882353, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 19.356987483346906}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.3421052631578947, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.6666666666666666, "max_step_rate_mean": 0.6578947368421052, "max_step_rate_min": 0.3333333333333333, "max_step_rate_max": 1.0, "velocity_mean": 0.22726495814742834, "velocity_min": 0.2032556157335147, "velocity_max": 0.250083505648223, "steering_mean": -0.018382165569940722, "steering_min": -0.09470507073235679, "steering_max": 0.10954199594427576, "step_reward_mean": 0.013330304630116085, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.015659696871625366, "acceleration_mean": -0.009892238767124273, "acceleration_min": -0.04369895616383469, "acceleration_max": 0.037879840312180696, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 809.8991228070175, "episode_length_min": 615.0, "episode_length_max": 999.0, "episode_reward_mean": 10.805406564630474, "episode_reward_min": 7.805667457084747, "episode_reward_max": 15.006258535275341, "num_neighbours_mean": 0.15953983665741595, "num_neighbours_min": 0.0, "num_neighbours_max": 0.6756756756756757, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 2.9473684210526314, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 30.927567923459673, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 37.55220506651101}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.009375000000000003, "cur_lr": 0.0003, "total_loss": 0.11659224810344833, "policy_loss": -0.07479433800492968, "vf_loss": 0.19124155741717133, "vf_explained_var": 0.003197893074580601, "kl": 0.015469574411482816, "entropy": 2.9634010519300187, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 533.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 26000, "num_env_steps_trained": 26000, "num_agent_steps_sampled": 59396, "num_agent_steps_trained": 59396}, "sampler_results": {"episode_reward_max": 30.018049864673408, "episode_reward_min": 9.442897069674476, "episode_reward_mean": 19.888753099199523, "episode_len_mean": 1338.2105263157894, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"default": -7.696558404176836}, "policy_reward_max": {"default": 18.20812944317377}, "policy_reward_mean": {"default": 6.747969801514125}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.3421052631578947, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.6666666666666666, "max_step_rate_mean": 0.6578947368421052, "max_step_rate_min": 0.3333333333333333, "max_step_rate_max": 1.0, "velocity_mean": 0.22726495814742834, "velocity_min": 0.2032556157335147, "velocity_max": 0.250083505648223, "steering_mean": -0.018382165569940722, "steering_min": -0.09470507073235679, "steering_max": 0.10954199594427576, "step_reward_mean": 0.013330304630116085, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.015659696871625366, "acceleration_mean": -0.009892238767124273, "acceleration_min": -0.04369895616383469, "acceleration_max": 0.037879840312180696, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 809.8991228070175, "episode_length_min": 615.0, "episode_length_max": 999.0, "episode_reward_mean": 10.805406564630474, "episode_reward_min": 7.805667457084747, "episode_reward_max": 15.006258535275341, "num_neighbours_mean": 0.15953983665741595, "num_neighbours_min": 0.0, "num_neighbours_max": 0.6756756756756757, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 2.9473684210526314, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 30.927567923459673, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 37.55220506651101}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38855940428499114, "mean_inference_ms": 0.5980956165143582, "mean_action_processing_ms": 0.19585846792495204, "mean_env_wait_ms": 1.2626135649938253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004482269287109375, "StateBufferConnector_ms": 0.0032512765181692024, "ViewRequirementAgentConnector_ms": 0.08902173293264289}}, "episode_reward_max": 30.018049864673408, "episode_reward_min": 9.442897069674476, "episode_reward_mean": 6.747969801514125, "episode_len_mean": 1338.2105263157894, "episodes_this_iter": 2, "policy_reward_min": {"default": -7.696558404176836}, "policy_reward_max": {"default": 18.20812944317377}, "policy_reward_mean": {"default": 6.747969801514125}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38855940428499114, "mean_inference_ms": 0.5980956165143582, "mean_action_processing_ms": 0.19585846792495204, "mean_env_wait_ms": 1.2626135649938253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004482269287109375, "StateBufferConnector_ms": 0.0032512765181692024, "ViewRequirementAgentConnector_ms": 0.08902173293264289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59396, "num_agent_steps_trained": 59396, "num_env_steps_sampled": 26000, "num_env_steps_trained": 26000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 372.60271538755893, "num_env_steps_trained_throughput_per_sec": 372.60271538755893, "timesteps_total": 26000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 59396, "timers": {"training_iteration_time_ms": 5202.145, "sample_time_ms": 4886.457, "load_time_ms": 5.232, "load_throughput": 382259.487, "learn_time_ms": 308.625, "learn_throughput": 6480.362, "synch_weights_time_ms": 1.461}, "counters": {"num_env_steps_sampled": 26000, "num_env_steps_trained": 26000, "num_agent_steps_sampled": 59396, "num_agent_steps_trained": 59396}, "done": false, "episodes_total": 19, "training_iteration": 13, "trial_id": "3f391_00000", "date": "2023-12-26_23-21-32", "timestamp": 1703604092, "time_this_iter_s": 5.373791217803955, "time_total_s": 69.14410018920898, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 69.14410018920898, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 15.942857142857145, "ram_util_percent": 59.89999999999999}, "success": 0.0, "crash": 0.0, "out": 0.3421052631578947, "max_step": 0.6578947368421052, "length": 1338.2105263157894, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 19.888753099199523}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.36249999999999993, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.6375, "max_step_rate_min": 0.25, "max_step_rate_max": 1.0, "velocity_mean": 0.2300757814153093, "velocity_min": 0.2032556157335147, "velocity_max": 0.28348142350504724, "steering_mean": -0.013289678523028073, "steering_min": -0.09470507073235679, "steering_max": 0.10954199594427576, "step_reward_mean": 0.013650000187219674, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.019724215772187883, "acceleration_mean": -0.004012535512538166, "acceleration_min": -0.04369895616383469, "acceleration_max": 0.10770182632459789, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 806.4916666666667, "episode_length_min": 615.0, "episode_length_max": 999.0, "episode_reward_mean": 10.996658088849967, "episode_reward_min": 7.805667457084747, "episode_reward_max": 15.006258535275341, "num_neighbours_mean": 0.1546636200183436, "num_neighbours_min": 0.0, "num_neighbours_max": 0.6756756756756757, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 32.30727693709076, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 58.52174819608146}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.009375000000000001, "cur_lr": 0.0003, "total_loss": 3.1907563614845276, "policy_loss": -0.024972570687532426, "vf_loss": 3.215564286708832, "vf_explained_var": 0.0181242311000824, "kl": 0.0175632308376953, "entropy": 2.974593787193298, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 575.5, "diff_num_grad_updates_vs_sampler_policy": 24.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 64997, "num_agent_steps_trained": 64997}, "sampler_results": {"episode_reward_max": 30.018049864673408, "episode_reward_min": 9.442897069674476, "episode_reward_mean": 20.320185867364508, "episode_len_mean": 1369.75, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -7.696558404176836}, "policy_reward_max": {"default": 22.01267560237666}, "policy_reward_mean": {"default": 6.773395289121504}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.36249999999999993, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.6375, "max_step_rate_min": 0.25, "max_step_rate_max": 1.0, "velocity_mean": 0.2300757814153093, "velocity_min": 0.2032556157335147, "velocity_max": 0.28348142350504724, "steering_mean": -0.013289678523028073, "steering_min": -0.09470507073235679, "steering_max": 0.10954199594427576, "step_reward_mean": 0.013650000187219674, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.019724215772187883, "acceleration_mean": -0.004012535512538166, "acceleration_min": -0.04369895616383469, "acceleration_max": 0.10770182632459789, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 806.4916666666667, "episode_length_min": 615.0, "episode_length_max": 999.0, "episode_reward_mean": 10.996658088849967, "episode_reward_min": 7.805667457084747, "episode_reward_max": 15.006258535275341, "num_neighbours_mean": 0.1546636200183436, "num_neighbours_min": 0.0, "num_neighbours_max": 0.6756756756756757, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0, "num_active_agents_min": 2, "num_active_agents_max": 4, "environment_reward_total_mean": 32.30727693709076, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 58.52174819608146}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38830173872604234, "mean_inference_ms": 0.5978866394396622, "mean_action_processing_ms": 0.19563009226653416, "mean_env_wait_ms": 1.2615160156034453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044536590576171875, "StateBufferConnector_ms": 0.003243684768676758, "ViewRequirementAgentConnector_ms": 0.08835077285766602}}, "episode_reward_max": 30.018049864673408, "episode_reward_min": 9.442897069674476, "episode_reward_mean": 6.773395289121504, "episode_len_mean": 1369.75, "episodes_this_iter": 1, "policy_reward_min": {"default": -7.696558404176836}, "policy_reward_max": {"default": 22.01267560237666}, "policy_reward_mean": {"default": 6.773395289121504}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38830173872604234, "mean_inference_ms": 0.5978866394396622, "mean_action_processing_ms": 0.19563009226653416, "mean_env_wait_ms": 1.2615160156034453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044536590576171875, "StateBufferConnector_ms": 0.003243684768676758, "ViewRequirementAgentConnector_ms": 0.08835077285766602}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64997, "num_agent_steps_trained": 64997, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 367.7437735886609, "num_env_steps_trained_throughput_per_sec": 367.7437735886609, "timesteps_total": 28000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 64997, "timers": {"training_iteration_time_ms": 5185.194, "sample_time_ms": 4880.107, "load_time_ms": 5.153, "load_throughput": 388138.661, "learn_time_ms": 298.113, "learn_throughput": 6708.874, "synch_weights_time_ms": 1.448}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 64997, "num_agent_steps_trained": 64997}, "done": false, "episodes_total": 20, "training_iteration": 14, "trial_id": "3f391_00000", "date": "2023-12-26_23-21-38", "timestamp": 1703604098, "time_this_iter_s": 5.443507432937622, "time_total_s": 74.5876076221466, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 74.5876076221466, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 21.0125, "ram_util_percent": 59.95}, "success": 0.0, "crash": 0.0, "out": 0.36249999999999993, "max_step": 0.6375, "length": 1369.75, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 20.320185867364508}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.376984126984127, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.6230158730158729, "max_step_rate_min": 0.25, "max_step_rate_max": 1.0, "velocity_mean": 0.23241581382757476, "velocity_min": 0.2032556157335147, "velocity_max": 0.28348142350504724, "steering_mean": -0.00843136339291957, "steering_min": -0.09470507073235679, "steering_max": 0.10954199594427576, "step_reward_mean": 0.013917203713343948, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.019724215772187883, "acceleration_mean": 0.0005219951693121575, "acceleration_min": -0.04369895616383469, "acceleration_max": 0.10770182632459789, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 791.9761904761905, "episode_length_min": 501.6666666666667, "episode_length_max": 999.0, "episode_reward_mean": 10.933138143744785, "episode_reward_min": 7.805667457084747, "episode_reward_max": 15.006258535275341, "num_neighbours_mean": 0.1567908546923633, "num_neighbours_min": 0.0, "num_neighbours_max": 0.6756756756756757, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.142857142857143, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 33.529617818650564, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 58.52174819608146}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.009375000000000001, "cur_lr": 0.0003, "total_loss": 3.517764456455524, "policy_loss": -0.0018495798110961914, "vf_loss": 3.5194401044111987, "vf_explained_var": 0.012874410702632023, "kl": 0.018550066467231417, "entropy": 3.1030128222245437, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 633.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}}, "num_env_steps_sampled": 30000, "num_env_steps_trained": 30000, "num_agent_steps_sampled": 72043, "num_agent_steps_trained": 72043}, "sampler_results": {"episode_reward_max": 30.018049864673408, "episode_reward_min": 9.442897069674476, "episode_reward_mean": 20.211007656822773, "episode_len_mean": 1390.7619047619048, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -8.288700573004}, "policy_reward_max": {"default": 22.01267560237666}, "policy_reward_mean": {"default": 6.430775163534521}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.376984126984127, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.6230158730158729, "max_step_rate_min": 0.25, "max_step_rate_max": 1.0, "velocity_mean": 0.23241581382757476, "velocity_min": 0.2032556157335147, "velocity_max": 0.28348142350504724, "steering_mean": -0.00843136339291957, "steering_min": -0.09470507073235679, "steering_max": 0.10954199594427576, "step_reward_mean": 0.013917203713343948, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.019724215772187883, "acceleration_mean": 0.0005219951693121575, "acceleration_min": -0.04369895616383469, "acceleration_max": 0.10770182632459789, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 791.9761904761905, "episode_length_min": 501.6666666666667, "episode_length_max": 999.0, "episode_reward_mean": 10.933138143744785, "episode_reward_min": 7.805667457084747, "episode_reward_max": 15.006258535275341, "num_neighbours_mean": 0.1567908546923633, "num_neighbours_min": 0.0, "num_neighbours_max": 0.6756756756756757, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.142857142857143, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 33.529617818650564, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 58.52174819608146}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3883058743051337, "mean_inference_ms": 0.5977852095591301, "mean_action_processing_ms": 0.19543289114399864, "mean_env_wait_ms": 1.260654889156869, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004441397530691964, "StateBufferConnector_ms": 0.0032402220226469495, "ViewRequirementAgentConnector_ms": 0.08800143287295387}}, "episode_reward_max": 30.018049864673408, "episode_reward_min": 9.442897069674476, "episode_reward_mean": 6.430775163534521, "episode_len_mean": 1390.7619047619048, "episodes_this_iter": 1, "policy_reward_min": {"default": -8.288700573004}, "policy_reward_max": {"default": 22.01267560237666}, "policy_reward_mean": {"default": 6.430775163534521}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3883058743051337, "mean_inference_ms": 0.5977852095591301, "mean_action_processing_ms": 0.19543289114399864, "mean_env_wait_ms": 1.260654889156869, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004441397530691964, "StateBufferConnector_ms": 0.0032402220226469495, "ViewRequirementAgentConnector_ms": 0.08800143287295387}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72043, "num_agent_steps_trained": 72043, "num_env_steps_sampled": 30000, "num_env_steps_trained": 30000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 349.2280384144648, "num_env_steps_trained_throughput_per_sec": 349.2280384144648, "timesteps_total": 30000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 72043, "timers": {"training_iteration_time_ms": 5229.272, "sample_time_ms": 4904.786, "load_time_ms": 5.212, "load_throughput": 383694.969, "learn_time_ms": 317.339, "learn_throughput": 6302.405, "synch_weights_time_ms": 1.55}, "counters": {"num_env_steps_sampled": 30000, "num_env_steps_trained": 30000, "num_agent_steps_sampled": 72043, "num_agent_steps_trained": 72043}, "done": false, "episodes_total": 21, "training_iteration": 15, "trial_id": "3f391_00000", "date": "2023-12-26_23-21-44", "timestamp": 1703604104, "time_this_iter_s": 5.731745481491089, "time_total_s": 80.3193531036377, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 80.3193531036377, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 17.7375, "ram_util_percent": 59.9}, "success": 0.0, "crash": 0.0, "out": 0.376984126984127, "max_step": 0.6230158730158729, "length": 1390.7619047619048, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 20.211007656822773}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.40942028985507245, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.5905797101449275, "max_step_rate_min": 0.25, "max_step_rate_max": 1.0, "velocity_mean": 0.23248835237942908, "velocity_min": 0.2032556157335147, "velocity_max": 0.28348142350504724, "steering_mean": -0.001623454377161207, "steering_min": -0.09470507073235679, "steering_max": 0.10954199594427576, "step_reward_mean": 0.013891435282359242, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.019724215772187883, "acceleration_mean": 0.0002539071960170436, "acceleration_min": -0.04369895616383469, "acceleration_max": 0.10770182632459789, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 775.195652173913, "episode_length_min": 484.75, "episode_length_max": 999.0, "episode_reward_mean": 10.693155008014218, "episode_reward_min": 6.541477996005698, "episode_reward_max": 15.006258535275341, "num_neighbours_mean": 0.16138329564887552, "num_neighbours_min": 0.0, "num_neighbours_max": 0.6756756756756757, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.217391304347826, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 33.456896993669915, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 58.52174819608146}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.009375000000000003, "cur_lr": 0.0003000000000000001, "total_loss": 2.0725558936595916, "policy_loss": -0.005774952905873458, "vf_loss": 2.0782126267751058, "vf_explained_var": 0.08034068246682485, "kl": 0.012609735544538125, "entropy": 3.0873752673467, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 695.5, "diff_num_grad_updates_vs_sampler_policy": 29.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 78241, "num_agent_steps_trained": 78241}, "sampler_results": {"episode_reward_max": 30.018049864673408, "episode_reward_min": -3.8213334200070115, "episode_reward_mean": 18.69020796521142, "episode_len_mean": 1380.695652173913, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"default": -8.288700573004}, "policy_reward_max": {"default": 22.01267560237666}, "policy_reward_mean": {"default": 5.809118691890037}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.40942028985507245, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.5905797101449275, "max_step_rate_min": 0.25, "max_step_rate_max": 1.0, "velocity_mean": 0.23248835237942908, "velocity_min": 0.2032556157335147, "velocity_max": 0.28348142350504724, "steering_mean": -0.001623454377161207, "steering_min": -0.09470507073235679, "steering_max": 0.10954199594427576, "step_reward_mean": 0.013891435282359242, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.019724215772187883, "acceleration_mean": 0.0002539071960170436, "acceleration_min": -0.04369895616383469, "acceleration_max": 0.10770182632459789, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 775.195652173913, "episode_length_min": 484.75, "episode_length_max": 999.0, "episode_reward_mean": 10.693155008014218, "episode_reward_min": 6.541477996005698, "episode_reward_max": 15.006258535275341, "num_neighbours_mean": 0.16138329564887552, "num_neighbours_min": 0.0, "num_neighbours_max": 0.6756756756756757, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.217391304347826, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 33.456896993669915, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 58.52174819608146}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3887695438539734, "mean_inference_ms": 0.5976038817304498, "mean_action_processing_ms": 0.19514673278956607, "mean_env_wait_ms": 1.259583636312464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004391048265540082, "StateBufferConnector_ms": 0.003232126650602921, "ViewRequirementAgentConnector_ms": 0.08761986442234206}}, "episode_reward_max": 30.018049864673408, "episode_reward_min": -3.8213334200070115, "episode_reward_mean": 5.809118691890037, "episode_len_mean": 1380.695652173913, "episodes_this_iter": 2, "policy_reward_min": {"default": -8.288700573004}, "policy_reward_max": {"default": 22.01267560237666}, "policy_reward_mean": {"default": 5.809118691890037}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3887695438539734, "mean_inference_ms": 0.5976038817304498, "mean_action_processing_ms": 0.19514673278956607, "mean_env_wait_ms": 1.259583636312464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004391048265540082, "StateBufferConnector_ms": 0.003232126650602921, "ViewRequirementAgentConnector_ms": 0.08761986442234206}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78241, "num_agent_steps_trained": 78241, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 346.9005249653714, "num_env_steps_trained_throughput_per_sec": 346.9005249653714, "timesteps_total": 32000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 78241, "timers": {"training_iteration_time_ms": 5313.582, "sample_time_ms": 4982.194, "load_time_ms": 4.085, "load_throughput": 489556.991, "learn_time_ms": 325.347, "learn_throughput": 6147.285, "synch_weights_time_ms": 1.558}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 78241, "num_agent_steps_trained": 78241}, "done": false, "episodes_total": 23, "training_iteration": 16, "trial_id": "3f391_00000", "date": "2023-12-26_23-21-49", "timestamp": 1703604109, "time_this_iter_s": 5.770540475845337, "time_total_s": 86.08989357948303, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 86.08989357948303, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 17.5, "ram_util_percent": 59.94444444444444}, "success": 0.0, "crash": 0.0, "out": 0.40942028985507245, "max_step": 0.5905797101449275, "length": 1380.695652173913, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 18.69020796521142}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.40625, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.59375, "max_step_rate_min": 0.25, "max_step_rate_max": 1.0, "velocity_mean": 0.23314442164469362, "velocity_min": 0.2032556157335147, "velocity_max": 0.28348142350504724, "steering_mean": 0.0007127341842408699, "steering_min": -0.09470507073235679, "steering_max": 0.10954199594427576, "step_reward_mean": 0.013938232539783034, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.019724215772187883, "acceleration_mean": 0.0011058626656643977, "acceleration_min": -0.04369895616383469, "acceleration_max": 0.10770182632459789, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 781.6458333333334, "episode_length_min": 484.75, "episode_length_max": 999.0, "episode_reward_mean": 10.829421449275836, "episode_reward_min": 6.541477996005698, "episode_reward_max": 15.006258535275341, "num_neighbours_mean": 0.1546589916635057, "num_neighbours_min": 0.0, "num_neighbours_max": 0.6756756756756757, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.2083333333333335, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 33.8083033187203, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 58.52174819608146}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.009375000000000001, "cur_lr": 0.0003, "total_loss": 0.991389831667766, "policy_loss": -0.02335942778736353, "vf_loss": 1.0146771190688013, "vf_explained_var": -9.262561798095703e-05, "kl": 0.007695000965032124, "entropy": 3.2182276487350463, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 745.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 34000, "num_env_steps_trained": 34000, "num_agent_steps_sampled": 82742, "num_agent_steps_trained": 82742}, "sampler_results": {"episode_reward_max": 31.900555185665503, "episode_reward_min": -3.8213334200070115, "episode_reward_mean": 19.24063909939701, "episode_len_mean": 1398.9166666666667, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -8.288700573004}, "policy_reward_max": {"default": 22.01267560237666}, "policy_reward_mean": {"default": 5.997082316695174}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.40625, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.75, "max_step_rate_mean": 0.59375, "max_step_rate_min": 0.25, "max_step_rate_max": 1.0, "velocity_mean": 0.23314442164469362, "velocity_min": 0.2032556157335147, "velocity_max": 0.28348142350504724, "steering_mean": 0.0007127341842408699, "steering_min": -0.09470507073235679, "steering_max": 0.10954199594427576, "step_reward_mean": 0.013938232539783034, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.019724215772187883, "acceleration_mean": 0.0011058626656643977, "acceleration_min": -0.04369895616383469, "acceleration_max": 0.10770182632459789, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 781.6458333333334, "episode_length_min": 484.75, "episode_length_max": 999.0, "episode_reward_mean": 10.829421449275836, "episode_reward_min": 6.541477996005698, "episode_reward_max": 15.006258535275341, "num_neighbours_mean": 0.1546589916635057, "num_neighbours_min": 0.0, "num_neighbours_max": 0.6756756756756757, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.2083333333333335, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 33.8083033187203, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 58.52174819608146}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3889070358002605, "mean_inference_ms": 0.5976172802602876, "mean_action_processing_ms": 0.19499784182959545, "mean_env_wait_ms": 1.2589796210934283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044087568918863935, "StateBufferConnector_ms": 0.0033020973205566406, "ViewRequirementAgentConnector_ms": 0.08788704872131348}}, "episode_reward_max": 31.900555185665503, "episode_reward_min": -3.8213334200070115, "episode_reward_mean": 5.997082316695174, "episode_len_mean": 1398.9166666666667, "episodes_this_iter": 1, "policy_reward_min": {"default": -8.288700573004}, "policy_reward_max": {"default": 22.01267560237666}, "policy_reward_mean": {"default": 5.997082316695174}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3889070358002605, "mean_inference_ms": 0.5976172802602876, "mean_action_processing_ms": 0.19499784182959545, "mean_env_wait_ms": 1.2589796210934283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044087568918863935, "StateBufferConnector_ms": 0.0033020973205566406, "ViewRequirementAgentConnector_ms": 0.08788704872131348}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82742, "num_agent_steps_trained": 82742, "num_env_steps_sampled": 34000, "num_env_steps_trained": 34000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 380.3655116554218, "num_env_steps_trained_throughput_per_sec": 380.3655116554218, "timesteps_total": 34000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 82742, "timers": {"training_iteration_time_ms": 5332.238, "sample_time_ms": 5009.314, "load_time_ms": 4.16, "load_throughput": 480805.181, "learn_time_ms": 316.811, "learn_throughput": 6312.921, "synch_weights_time_ms": 1.554}, "counters": {"num_env_steps_sampled": 34000, "num_env_steps_trained": 34000, "num_agent_steps_sampled": 82742, "num_agent_steps_trained": 82742}, "done": false, "episodes_total": 24, "training_iteration": 17, "trial_id": "3f391_00000", "date": "2023-12-26_23-21-55", "timestamp": 1703604115, "time_this_iter_s": 5.263514995574951, "time_total_s": 91.35340857505798, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 91.35340857505798, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 22.157142857142855, "ram_util_percent": 59.98571428571428}, "success": 0.0, "crash": 0.0, "out": 0.40625, "max_step": 0.59375, "length": 1398.9166666666667, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 19.24063909939701}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.42200000000000004, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.8, "max_step_rate_mean": 0.578, "max_step_rate_min": 0.2, "max_step_rate_max": 1.0, "velocity_mean": 0.23379528933981067, "velocity_min": 0.2032556157335147, "velocity_max": 0.28348142350504724, "steering_mean": 0.0027450632676933495, "steering_min": -0.09470507073235679, "steering_max": 0.10954199594427576, "step_reward_mean": 0.014015281366017634, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.019724215772187883, "acceleration_mean": 0.0025989412469148428, "acceleration_min": -0.04369895616383469, "acceleration_max": 0.10770182632459789, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 770.9639999999999, "episode_length_min": 484.75, "episode_length_max": 999.0, "episode_reward_mean": 10.722798495884021, "episode_reward_min": 6.541477996005698, "episode_reward_max": 15.006258535275341, "num_neighbours_mean": 0.16871359585238715, "num_neighbours_min": 0.0, "num_neighbours_max": 0.6756756756756757, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.28, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 34.08874070886758, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 58.52174819608146}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.009375000000000003, "cur_lr": 0.0003, "total_loss": 2.572280748685201, "policy_loss": 0.0032694626185629104, "vf_loss": 2.5686862230300904, "vf_explained_var": 0.12591360542509292, "kl": 0.03467445002558331, "entropy": 3.010773966047499, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 788.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 87843, "num_agent_steps_trained": 87843}, "sampler_results": {"episode_reward_max": 31.900555185665503, "episode_reward_min": -3.8213334200070115, "episode_reward_mean": 18.503860181941782, "episode_len_mean": 1398.8, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -8.288700573004}, "policy_reward_max": {"default": 22.01267560237666}, "policy_reward_mean": {"default": 5.641420787177374}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.42200000000000004, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.8, "max_step_rate_mean": 0.578, "max_step_rate_min": 0.2, "max_step_rate_max": 1.0, "velocity_mean": 0.23379528933981067, "velocity_min": 0.2032556157335147, "velocity_max": 0.28348142350504724, "steering_mean": 0.0027450632676933495, "steering_min": -0.09470507073235679, "steering_max": 0.10954199594427576, "step_reward_mean": 0.014015281366017634, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.019724215772187883, "acceleration_mean": 0.0025989412469148428, "acceleration_min": -0.04369895616383469, "acceleration_max": 0.10770182632459789, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 770.9639999999999, "episode_length_min": 484.75, "episode_length_max": 999.0, "episode_reward_mean": 10.722798495884021, "episode_reward_min": 6.541477996005698, "episode_reward_max": 15.006258535275341, "num_neighbours_mean": 0.16871359585238715, "num_neighbours_min": 0.0, "num_neighbours_max": 0.6756756756756757, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.28, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 34.08874070886758, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 58.52174819608146}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3892011364756068, "mean_inference_ms": 0.5978755974019798, "mean_action_processing_ms": 0.19493971750123887, "mean_env_wait_ms": 1.2591191027033262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043849945068359375, "StateBufferConnector_ms": 0.0032968521118164062, "ViewRequirementAgentConnector_ms": 0.08797836303710938}}, "episode_reward_max": 31.900555185665503, "episode_reward_min": -3.8213334200070115, "episode_reward_mean": 5.641420787177374, "episode_len_mean": 1398.8, "episodes_this_iter": 1, "policy_reward_min": {"default": -8.288700573004}, "policy_reward_max": {"default": 22.01267560237666}, "policy_reward_mean": {"default": 5.641420787177374}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3892011364756068, "mean_inference_ms": 0.5978755974019798, "mean_action_processing_ms": 0.19493971750123887, "mean_env_wait_ms": 1.2591191027033262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043849945068359375, "StateBufferConnector_ms": 0.0032968521118164062, "ViewRequirementAgentConnector_ms": 0.08797836303710938}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 87843, "num_agent_steps_trained": 87843, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 313.4006463251711, "num_env_steps_trained_throughput_per_sec": 313.4006463251711, "timesteps_total": 36000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 87843, "timers": {"training_iteration_time_ms": 5435.619, "sample_time_ms": 5111.559, "load_time_ms": 4.135, "load_throughput": 483710.717, "learn_time_ms": 317.96, "learn_throughput": 6290.101, "synch_weights_time_ms": 1.561}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 87843, "num_agent_steps_trained": 87843}, "done": false, "episodes_total": 25, "training_iteration": 18, "trial_id": "3f391_00000", "date": "2023-12-26_23-22-01", "timestamp": 1703604121, "time_this_iter_s": 6.386730194091797, "time_total_s": 97.74013876914978, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 97.74013876914978, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 33.3, "ram_util_percent": 60.01111111111111}, "success": 0.0, "crash": 0.0, "out": 0.42200000000000004, "max_step": 0.578, "length": 1398.8, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 18.503860181941782}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.4277777777777778, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.8, "max_step_rate_mean": 0.5722222222222222, "max_step_rate_min": 0.2, "max_step_rate_max": 1.0, "velocity_mean": 0.23469920646245696, "velocity_min": 0.2032556157335147, "velocity_max": 0.28348142350504724, "steering_mean": 0.01113930536942305, "steering_min": -0.09470507073235679, "steering_max": 0.1239347741446423, "step_reward_mean": 0.014070939294678697, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.019724215772187883, "acceleration_mean": 0.002466890288401502, "acceleration_min": -0.04369895616383469, "acceleration_max": 0.10770182632459789, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 773.6827160493826, "episode_length_min": 484.75, "episode_length_max": 999.0, "episode_reward_mean": 10.813303743547046, "episode_reward_min": 6.541477996005698, "episode_reward_max": 15.006258535275341, "num_neighbours_mean": 0.17610067083085845, "num_neighbours_min": 0.0, "num_neighbours_max": 0.6756756756756757, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.259259259259259, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 34.21800865769254, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 58.52174819608146}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.014062500000000002, "cur_lr": 0.0003, "total_loss": 1.5665834243642167, "policy_loss": 0.013380755670368671, "vf_loss": 1.5530383203178644, "vf_explained_var": 0.04105403274297714, "kl": 0.011687348093619437, "entropy": 2.960492867231369, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 830.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 38000, "num_env_steps_trained": 38000, "num_agent_steps_sampled": 92170, "num_agent_steps_trained": 92170}, "sampler_results": {"episode_reward_max": 31.900555185665503, "episode_reward_min": -3.8213334200070115, "episode_reward_mean": 18.678078933825386, "episode_len_mean": 1402.9259259259259, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"default": -8.288700573004}, "policy_reward_max": {"default": 22.01267560237666}, "policy_reward_mean": {"default": 5.730774218332789}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.4277777777777778, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.8, "max_step_rate_mean": 0.5722222222222222, "max_step_rate_min": 0.2, "max_step_rate_max": 1.0, "velocity_mean": 0.23469920646245696, "velocity_min": 0.2032556157335147, "velocity_max": 0.28348142350504724, "steering_mean": 0.01113930536942305, "steering_min": -0.09470507073235679, "steering_max": 0.1239347741446423, "step_reward_mean": 0.014070939294678697, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.019724215772187883, "acceleration_mean": 0.002466890288401502, "acceleration_min": -0.04369895616383469, "acceleration_max": 0.10770182632459789, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 773.6827160493826, "episode_length_min": 484.75, "episode_length_max": 999.0, "episode_reward_mean": 10.813303743547046, "episode_reward_min": 6.541477996005698, "episode_reward_max": 15.006258535275341, "num_neighbours_mean": 0.17610067083085845, "num_neighbours_min": 0.0, "num_neighbours_max": 0.6756756756756757, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.259259259259259, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 34.21800865769254, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 58.52174819608146}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.389619630005718, "mean_inference_ms": 0.598210792536308, "mean_action_processing_ms": 0.19474763329046163, "mean_env_wait_ms": 1.2587682731368304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044769710964626735, "StateBufferConnector_ms": 0.003264568470142506, "ViewRequirementAgentConnector_ms": 0.08677553247522425}}, "episode_reward_max": 31.900555185665503, "episode_reward_min": -3.8213334200070115, "episode_reward_mean": 5.730774218332789, "episode_len_mean": 1402.9259259259259, "episodes_this_iter": 2, "policy_reward_min": {"default": -8.288700573004}, "policy_reward_max": {"default": 22.01267560237666}, "policy_reward_mean": {"default": 5.730774218332789}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.389619630005718, "mean_inference_ms": 0.598210792536308, "mean_action_processing_ms": 0.19474763329046163, "mean_env_wait_ms": 1.2587682731368304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044769710964626735, "StateBufferConnector_ms": 0.003264568470142506, "ViewRequirementAgentConnector_ms": 0.08677553247522425}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92170, "num_agent_steps_trained": 92170, "num_env_steps_sampled": 38000, "num_env_steps_trained": 38000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 414.53914894678957, "num_env_steps_trained_throughput_per_sec": 414.53914894678957, "timesteps_total": 38000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 92170, "timers": {"training_iteration_time_ms": 5427.444, "sample_time_ms": 5099.945, "load_time_ms": 4.171, "load_throughput": 479521.656, "learn_time_ms": 321.367, "learn_throughput": 6223.409, "synch_weights_time_ms": 1.559}, "counters": {"num_env_steps_sampled": 38000, "num_env_steps_trained": 38000, "num_agent_steps_sampled": 92170, "num_agent_steps_trained": 92170}, "done": false, "episodes_total": 27, "training_iteration": 19, "trial_id": "3f391_00000", "date": "2023-12-26_23-22-06", "timestamp": 1703604126, "time_this_iter_s": 4.83066463470459, "time_total_s": 102.57080340385437, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 102.57080340385437, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 15.371428571428572, "ram_util_percent": 60.05714285714286}, "success": 0.0, "crash": 0.0, "out": 0.4277777777777778, "max_step": 0.5722222222222222, "length": 1402.9259259259259, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 18.678078933825386}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.42440476190476195, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.8, "max_step_rate_mean": 0.5755952380952382, "max_step_rate_min": 0.2, "max_step_rate_max": 1.0, "velocity_mean": 0.23433008961093252, "velocity_min": 0.2032556157335147, "velocity_max": 0.28348142350504724, "steering_mean": 0.011263814964486248, "steering_min": -0.09470507073235679, "steering_max": 0.1239347741446423, "step_reward_mean": 0.014029866208009407, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.019724215772187883, "acceleration_mean": 0.0024648795226813137, "acceleration_min": -0.04369895616383469, "acceleration_max": 0.10770182632459789, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 772.0630952380951, "episode_length_min": 484.75, "episode_length_max": 999.0, "episode_reward_mean": 10.763211358854244, "episode_reward_min": 6.541477996005698, "episode_reward_max": 15.006258535275341, "num_neighbours_mean": 0.1698113611583278, "num_neighbours_min": 0.0, "num_neighbours_max": 0.6756756756756757, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.25, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 34.00422802407659, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 58.52174819608146}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0140625, "cur_lr": 0.0003, "total_loss": 1.4365234480963813, "policy_loss": -0.01739667471912172, "vf_loss": 1.4536792463726467, "vf_explained_var": 0.14191555976867676, "kl": 0.017127747374211792, "entropy": 2.993266481823391, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 873.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 96866, "num_agent_steps_trained": 96866}, "sampler_results": {"episode_reward_max": 31.900555185665503, "episode_reward_min": -3.8213334200070115, "episode_reward_mean": 18.662255169971708, "episode_len_mean": 1396.142857142857, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -8.288700573004}, "policy_reward_max": {"default": 22.01267560237666}, "policy_reward_mean": {"default": 5.742232359991296}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.42440476190476195, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.8, "max_step_rate_mean": 0.5755952380952382, "max_step_rate_min": 0.2, "max_step_rate_max": 1.0, "velocity_mean": 0.23433008961093252, "velocity_min": 0.2032556157335147, "velocity_max": 0.28348142350504724, "steering_mean": 0.011263814964486248, "steering_min": -0.09470507073235679, "steering_max": 0.1239347741446423, "step_reward_mean": 0.014029866208009407, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.019724215772187883, "acceleration_mean": 0.0024648795226813137, "acceleration_min": -0.04369895616383469, "acceleration_max": 0.10770182632459789, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 772.0630952380951, "episode_length_min": 484.75, "episode_length_max": 999.0, "episode_reward_mean": 10.763211358854244, "episode_reward_min": 6.541477996005698, "episode_reward_max": 15.006258535275341, "num_neighbours_mean": 0.1698113611583278, "num_neighbours_min": 0.0, "num_neighbours_max": 0.6756756756756757, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.25, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 34.00422802407659, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 58.52174819608146}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236, 18.23501354592249], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542, 1213], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853, -6.660251282774001, 12.91050315568116, 11.984761673015342]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3898140246117644, "mean_inference_ms": 0.5983813048416995, "mean_action_processing_ms": 0.194684367964078, "mean_env_wait_ms": 1.2588511296575955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044558729444231305, "StateBufferConnector_ms": 0.0032569680895124164, "ViewRequirementAgentConnector_ms": 0.08636031832013812}}, "episode_reward_max": 31.900555185665503, "episode_reward_min": -3.8213334200070115, "episode_reward_mean": 5.742232359991296, "episode_len_mean": 1396.142857142857, "episodes_this_iter": 1, "policy_reward_min": {"default": -8.288700573004}, "policy_reward_max": {"default": 22.01267560237666}, "policy_reward_mean": {"default": 5.742232359991296}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236, 18.23501354592249], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542, 1213], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853, -6.660251282774001, 12.91050315568116, 11.984761673015342]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3898140246117644, "mean_inference_ms": 0.5983813048416995, "mean_action_processing_ms": 0.194684367964078, "mean_env_wait_ms": 1.2588511296575955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044558729444231305, "StateBufferConnector_ms": 0.0032569680895124164, "ViewRequirementAgentConnector_ms": 0.08636031832013812}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96866, "num_agent_steps_trained": 96866, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 353.9610254201379, "num_env_steps_trained_throughput_per_sec": 353.9610254201379, "timesteps_total": 40000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 96866, "timers": {"training_iteration_time_ms": 5474.735, "sample_time_ms": 5139.315, "load_time_ms": 4.198, "load_throughput": 476465.73, "learn_time_ms": 329.242, "learn_throughput": 6074.558, "synch_weights_time_ms": 1.572}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 96866, "num_agent_steps_trained": 96866}, "done": false, "episodes_total": 28, "training_iteration": 20, "trial_id": "3f391_00000", "date": "2023-12-26_23-22-12", "timestamp": 1703604132, "time_this_iter_s": 5.656133651733398, "time_total_s": 108.22693705558777, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 108.22693705558777, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 19.0375, "ram_util_percent": 60.0125}, "success": 0.0, "crash": 0.0, "out": 0.42440476190476195, "max_step": 0.5755952380952382, "length": 1396.142857142857, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 18.662255169971708}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.4270114942528736, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.8, "max_step_rate_mean": 0.5729885057471265, "max_step_rate_min": 0.2, "max_step_rate_max": 1.0, "velocity_mean": 0.2338938110933245, "velocity_min": 0.2032556157335147, "velocity_max": 0.28348142350504724, "steering_mean": 0.011614592444679484, "steering_min": -0.09470507073235679, "steering_max": 0.1239347741446423, "step_reward_mean": 0.013963182054034266, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.019724215772187883, "acceleration_mean": -0.00025988384136969183, "acceleration_min": -0.07655325803479784, "acceleration_max": 0.10770182632459789, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 769.1902298850573, "episode_length_min": 484.75, "episode_length_max": 999.0, "episode_reward_mean": 10.679346750973252, "episode_reward_min": 6.541477996005698, "episode_reward_max": 15.006258535275341, "num_neighbours_mean": 0.18294321797050384, "num_neighbours_min": 0.0, "num_neighbours_max": 0.6756756756756757, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.2758620689655173, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 33.98079088259884, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 58.52174819608146}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0140625, "cur_lr": 0.0003, "total_loss": 1.6249496989780001, "policy_loss": -0.017544945205251374, "vf_loss": 1.6422068119049071, "vf_explained_var": 0.2193878385755751, "kl": 0.020467433411007128, "entropy": 2.991071017583211, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 918.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_agent_steps_sampled": 101663, "num_agent_steps_trained": 101663}, "sampler_results": {"episode_reward_max": 31.900555185665503, "episode_reward_min": -3.8213334200070115, "episode_reward_mean": 18.47849658123775, "episode_len_mean": 1410.3793103448277, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -8.288700573004}, "policy_reward_max": {"default": 22.01267560237666}, "policy_reward_mean": {"default": 5.6408042195357355}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.4270114942528736, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.8, "max_step_rate_mean": 0.5729885057471265, "max_step_rate_min": 0.2, "max_step_rate_max": 1.0, "velocity_mean": 0.2338938110933245, "velocity_min": 0.2032556157335147, "velocity_max": 0.28348142350504724, "steering_mean": 0.011614592444679484, "steering_min": -0.09470507073235679, "steering_max": 0.1239347741446423, "step_reward_mean": 0.013963182054034266, "step_reward_min": 0.010475699242440914, "step_reward_max": 0.019724215772187883, "acceleration_mean": -0.00025988384136969183, "acceleration_min": -0.07655325803479784, "acceleration_max": 0.10770182632459789, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 769.1902298850573, "episode_length_min": 484.75, "episode_length_max": 999.0, "episode_reward_mean": 10.679346750973252, "episode_reward_min": 6.541477996005698, "episode_reward_max": 15.006258535275341, "num_neighbours_mean": 0.18294321797050384, "num_neighbours_min": 0.0, "num_neighbours_max": 0.6756756756756757, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.2758620689655173, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 33.98079088259884, "environment_reward_total_min": 20.93044708639694, "environment_reward_total_max": 58.52174819608146}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236, 18.23501354592249, 13.33325609668692], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542, 1213, 1809], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853, -6.660251282774001, 12.91050315568116, 11.984761673015342, -4.994833021592723, 11.279824438188427, -3.6587820114353233, 10.70704669152651]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38992900403923914, "mean_inference_ms": 0.5984913239772504, "mean_action_processing_ms": 0.19458735341959735, "mean_env_wait_ms": 1.2586233568992047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004422253575818292, "StateBufferConnector_ms": 0.0032457812079067887, "ViewRequirementAgentConnector_ms": 0.08631410269901671}}, "episode_reward_max": 31.900555185665503, "episode_reward_min": -3.8213334200070115, "episode_reward_mean": 5.6408042195357355, "episode_len_mean": 1410.3793103448277, "episodes_this_iter": 1, "policy_reward_min": {"default": -8.288700573004}, "policy_reward_max": {"default": 22.01267560237666}, "policy_reward_mean": {"default": 5.6408042195357355}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236, 18.23501354592249, 13.33325609668692], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542, 1213, 1809], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853, -6.660251282774001, 12.91050315568116, 11.984761673015342, -4.994833021592723, 11.279824438188427, -3.6587820114353233, 10.70704669152651]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38992900403923914, "mean_inference_ms": 0.5984913239772504, "mean_action_processing_ms": 0.19458735341959735, "mean_env_wait_ms": 1.2586233568992047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004422253575818292, "StateBufferConnector_ms": 0.0032457812079067887, "ViewRequirementAgentConnector_ms": 0.08631410269901671}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 101663, "num_agent_steps_trained": 101663, "num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 418.9150297846075, "num_env_steps_trained_throughput_per_sec": 418.9150297846075, "timesteps_total": 42000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 101663, "timers": {"training_iteration_time_ms": 5453.274, "sample_time_ms": 5110.371, "load_time_ms": 4.26, "load_throughput": 469455.587, "learn_time_ms": 336.688, "learn_throughput": 5940.215, "synch_weights_time_ms": 1.554}, "counters": {"num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_agent_steps_sampled": 101663, "num_agent_steps_trained": 101663}, "done": false, "episodes_total": 29, "training_iteration": 21, "trial_id": "3f391_00000", "date": "2023-12-26_23-22-17", "timestamp": 1703604137, "time_this_iter_s": 4.779985189437866, "time_total_s": 113.00692224502563, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 113.00692224502563, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 16.657142857142855, "ram_util_percent": 59.97142857142857}, "success": 0.0, "crash": 0.0, "out": 0.4270114942528736, "max_step": 0.5729885057471265, "length": 1410.3793103448277, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 18.47849658123775}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.4155913978494624, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.8, "max_step_rate_mean": 0.5844086021505377, "max_step_rate_min": 0.2, "max_step_rate_max": 1.0, "velocity_mean": 0.2318713721943853, "velocity_min": 0.1973882618846178, "velocity_max": 0.28348142350504724, "steering_mean": 0.01358014127670347, "steering_min": -0.09470507073235679, "steering_max": 0.1239347741446423, "step_reward_mean": 0.013663647948234391, "step_reward_min": 0.008585643748023957, "step_reward_max": 0.019724215772187883, "acceleration_mean": -0.008991950415494474, "acceleration_min": -0.13942851056088437, "acceleration_max": 0.10770182632459789, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 773.395698924731, "episode_length_min": 484.75, "episode_length_max": 999.0, "episode_reward_mean": 10.484276108241827, "episode_reward_min": 6.541477996005698, "episode_reward_max": 15.006258535275341, "num_neighbours_mean": 0.17114042971434232, "num_neighbours_min": 0.0, "num_neighbours_max": 0.6756756756756757, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.2580645161290325, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 33.21080108696464, "environment_reward_total_min": 17.15411620855185, "environment_reward_total_max": 58.52174819608146}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.021093750000000005, "cur_lr": 0.0003, "total_loss": 1.2540012575419885, "policy_loss": -0.012831357760088785, "vf_loss": 1.2666907967201302, "vf_explained_var": 0.059079044205801824, "kl": 0.0067244774562173655, "entropy": 2.960326283318656, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 958.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 105533, "num_agent_steps_trained": 105533}, "sampler_results": {"episode_reward_max": 31.900555185665503, "episode_reward_min": -3.8213334200070115, "episode_reward_mean": 18.06380725295908, "episode_len_mean": 1407.5483870967741, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"default": -8.288700573004}, "policy_reward_max": {"default": 22.01267560237666}, "policy_reward_mean": {"default": 5.544336879621103}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.4155913978494624, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.8, "max_step_rate_mean": 0.5844086021505377, "max_step_rate_min": 0.2, "max_step_rate_max": 1.0, "velocity_mean": 0.2318713721943853, "velocity_min": 0.1973882618846178, "velocity_max": 0.28348142350504724, "steering_mean": 0.01358014127670347, "steering_min": -0.09470507073235679, "steering_max": 0.1239347741446423, "step_reward_mean": 0.013663647948234391, "step_reward_min": 0.008585643748023957, "step_reward_max": 0.019724215772187883, "acceleration_mean": -0.008991950415494474, "acceleration_min": -0.13942851056088437, "acceleration_max": 0.10770182632459789, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 773.395698924731, "episode_length_min": 484.75, "episode_length_max": 999.0, "episode_reward_mean": 10.484276108241827, "episode_reward_min": 6.541477996005698, "episode_reward_max": 15.006258535275341, "num_neighbours_mean": 0.17114042971434232, "num_neighbours_min": 0.0, "num_neighbours_max": 0.6756756756756757, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.2580645161290325, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 33.21080108696464, "environment_reward_total_min": 17.15411620855185, "environment_reward_total_max": 58.52174819608146}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236, 18.23501354592249, 13.33325609668692, 6.935479801018442, 17.16614418481819], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542, 1213, 1809, 1733, 1000], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853, -6.660251282774001, 12.91050315568116, 11.984761673015342, -4.994833021592723, 11.279824438188427, -3.6587820114353233, 10.70704669152651, -7.283873030490177, 9.38039162970067, -6.271561439661893, 11.110522641469858, 8.437247012705916, 8.728897172112251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3900740120761459, "mean_inference_ms": 0.5986440952027124, "mean_action_processing_ms": 0.19439456218701534, "mean_env_wait_ms": 1.2579524192027136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004395361869565902, "StateBufferConnector_ms": 0.003254029058641003, "ViewRequirementAgentConnector_ms": 0.08731272912794544}}, "episode_reward_max": 31.900555185665503, "episode_reward_min": -3.8213334200070115, "episode_reward_mean": 5.544336879621103, "episode_len_mean": 1407.5483870967741, "episodes_this_iter": 2, "policy_reward_min": {"default": -8.288700573004}, "policy_reward_max": {"default": 22.01267560237666}, "policy_reward_mean": {"default": 5.544336879621103}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236, 18.23501354592249, 13.33325609668692, 6.935479801018442, 17.16614418481819], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542, 1213, 1809, 1733, 1000], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853, -6.660251282774001, 12.91050315568116, 11.984761673015342, -4.994833021592723, 11.279824438188427, -3.6587820114353233, 10.70704669152651, -7.283873030490177, 9.38039162970067, -6.271561439661893, 11.110522641469858, 8.437247012705916, 8.728897172112251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3900740120761459, "mean_inference_ms": 0.5986440952027124, "mean_action_processing_ms": 0.19439456218701534, "mean_env_wait_ms": 1.2579524192027136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004395361869565902, "StateBufferConnector_ms": 0.003254029058641003, "ViewRequirementAgentConnector_ms": 0.08731272912794544}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 105533, "num_agent_steps_trained": 105533, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 403.13445558830824, "num_env_steps_trained_throughput_per_sec": 403.13445558830824, "timesteps_total": 44000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 105533, "timers": {"training_iteration_time_ms": 5414.831, "sample_time_ms": 5074.297, "load_time_ms": 4.321, "load_throughput": 462840.181, "learn_time_ms": 334.22, "learn_throughput": 5984.075, "synch_weights_time_ms": 1.582}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 105533, "num_agent_steps_trained": 105533}, "done": false, "episodes_total": 31, "training_iteration": 22, "trial_id": "3f391_00000", "date": "2023-12-26_23-22-22", "timestamp": 1703604142, "time_this_iter_s": 4.967536449432373, "time_total_s": 117.97445869445801, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 117.97445869445801, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 15.757142857142856, "ram_util_percent": 59.91428571428571}, "success": 0.0, "crash": 0.0, "out": 0.4155913978494624, "max_step": 0.5844086021505377, "length": 1407.5483870967741, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 18.06380725295908}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.4106060606060606, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.8, "max_step_rate_mean": 0.5893939393939394, "max_step_rate_min": 0.2, "max_step_rate_max": 1.0, "velocity_mean": 0.23027669052514926, "velocity_min": 0.1973882618846178, "velocity_max": 0.28348142350504724, "steering_mean": 0.016806299050213185, "steering_min": -0.09470507073235679, "steering_max": 0.1239347741446423, "step_reward_mean": 0.013416374240991598, "step_reward_min": 0.008585643748023957, "step_reward_max": 0.019724215772187883, "acceleration_mean": -0.017009195436966686, "acceleration_min": -0.15862792446925952, "acceleration_max": 0.10770182632459789, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 779.4121212121212, "episode_length_min": 484.75, "episode_length_max": 999.0, "episode_reward_mean": 10.351570729296123, "episode_reward_min": 6.541477996005698, "episode_reward_max": 15.006258535275341, "num_neighbours_mean": 0.16076828245892763, "num_neighbours_min": 0.0, "num_neighbours_max": 0.6756756756756757, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.212121212121212, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 32.432475650726936, "environment_reward_total_min": 17.15411620855185, "environment_reward_total_max": 58.52174819608146}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.021093750000000005, "cur_lr": 0.0003, "total_loss": 0.6853702147092138, "policy_loss": -0.07275161445140839, "vf_loss": 0.7580060631568942, "vf_explained_var": 0.684260414327894, "kl": 0.0054877457741121655, "entropy": 3.001575061253139, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 993.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 46000, "num_env_steps_trained": 46000, "num_agent_steps_sampled": 109346, "num_agent_steps_trained": 109346}, "sampler_results": {"episode_reward_max": 31.900555185665503, "episode_reward_min": -3.8213334200070115, "episode_reward_mean": 17.598211460387617, "episode_len_mean": 1390.939393939394, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"default": -8.288700573004}, "policy_reward_max": {"default": 22.01267560237666}, "policy_reward_mean": {"default": 5.4786884735168995}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.4106060606060606, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.8, "max_step_rate_mean": 0.5893939393939394, "max_step_rate_min": 0.2, "max_step_rate_max": 1.0, "velocity_mean": 0.23027669052514926, "velocity_min": 0.1973882618846178, "velocity_max": 0.28348142350504724, "steering_mean": 0.016806299050213185, "steering_min": -0.09470507073235679, "steering_max": 0.1239347741446423, "step_reward_mean": 0.013416374240991598, "step_reward_min": 0.008585643748023957, "step_reward_max": 0.019724215772187883, "acceleration_mean": -0.017009195436966686, "acceleration_min": -0.15862792446925952, "acceleration_max": 0.10770182632459789, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 779.4121212121212, "episode_length_min": 484.75, "episode_length_max": 999.0, "episode_reward_mean": 10.351570729296123, "episode_reward_min": 6.541477996005698, "episode_reward_max": 15.006258535275341, "num_neighbours_mean": 0.16076828245892763, "num_neighbours_min": 0.0, "num_neighbours_max": 0.6756756756756757, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.212121212121212, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 32.432475650726936, "environment_reward_total_min": 17.15411620855185, "environment_reward_total_max": 58.52174819608146}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236, 18.23501354592249, 13.33325609668692, 6.935479801018442, 17.16614418481819, 18.067523481298345, 2.6954298697616377], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542, 1213, 1809, 1733, 1000, 1000, 1267], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853, -6.660251282774001, 12.91050315568116, 11.984761673015342, -4.994833021592723, 11.279824438188427, -3.6587820114353233, 10.70704669152651, -7.283873030490177, 9.38039162970067, -6.271561439661893, 11.110522641469858, 8.437247012705916, 8.728897172112251, 8.252004543879714, 9.815518937418636, 11.31551583114322, -4.295583177315908, -4.324502784065705]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3901630311810714, "mean_inference_ms": 0.5987196465681215, "mean_action_processing_ms": 0.19423814846223028, "mean_env_wait_ms": 1.2573307749733533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00439773906360973, "StateBufferConnector_ms": 0.0032706694169477983, "ViewRequirementAgentConnector_ms": 0.08901755015055339}}, "episode_reward_max": 31.900555185665503, "episode_reward_min": -3.8213334200070115, "episode_reward_mean": 5.4786884735168995, "episode_len_mean": 1390.939393939394, "episodes_this_iter": 2, "policy_reward_min": {"default": -8.288700573004}, "policy_reward_max": {"default": 22.01267560237666}, "policy_reward_mean": {"default": 5.4786884735168995}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236, 18.23501354592249, 13.33325609668692, 6.935479801018442, 17.16614418481819, 18.067523481298345, 2.6954298697616377], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542, 1213, 1809, 1733, 1000, 1000, 1267], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853, -6.660251282774001, 12.91050315568116, 11.984761673015342, -4.994833021592723, 11.279824438188427, -3.6587820114353233, 10.70704669152651, -7.283873030490177, 9.38039162970067, -6.271561439661893, 11.110522641469858, 8.437247012705916, 8.728897172112251, 8.252004543879714, 9.815518937418636, 11.31551583114322, -4.295583177315908, -4.324502784065705]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3901630311810714, "mean_inference_ms": 0.5987196465681215, "mean_action_processing_ms": 0.19423814846223028, "mean_env_wait_ms": 1.2573307749733533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00439773906360973, "StateBufferConnector_ms": 0.0032706694169477983, "ViewRequirementAgentConnector_ms": 0.08901755015055339}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 109346, "num_agent_steps_trained": 109346, "num_env_steps_sampled": 46000, "num_env_steps_trained": 46000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 383.29079272297406, "num_env_steps_trained_throughput_per_sec": 383.29079272297406, "timesteps_total": 46000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 109346, "timers": {"training_iteration_time_ms": 5399.864, "sample_time_ms": 5065.633, "load_time_ms": 4.197, "load_throughput": 476579.421, "learn_time_ms": 328.09, "learn_throughput": 6095.886, "synch_weights_time_ms": 1.536}, "counters": {"num_env_steps_sampled": 46000, "num_env_steps_trained": 46000, "num_agent_steps_sampled": 109346, "num_agent_steps_trained": 109346}, "done": false, "episodes_total": 33, "training_iteration": 23, "trial_id": "3f391_00000", "date": "2023-12-26_23-22-27", "timestamp": 1703604147, "time_this_iter_s": 5.224093437194824, "time_total_s": 123.19855213165283, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 123.19855213165283, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 16.7, "ram_util_percent": 60.0}, "success": 0.0, "crash": 0.0, "out": 0.4106060606060606, "max_step": 0.5893939393939394, "length": 1390.939393939394, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 17.598211460387617}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.4083333333333333, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.8, "max_step_rate_mean": 0.5916666666666667, "max_step_rate_min": 0.2, "max_step_rate_max": 1.0, "velocity_mean": 0.22982392413514016, "velocity_min": 0.1973882618846178, "velocity_max": 0.28348142350504724, "steering_mean": 0.017080743770941972, "steering_min": -0.09470507073235679, "steering_max": 0.1239347741446423, "step_reward_mean": 0.01332839741619541, "step_reward_min": 0.008585643748023957, "step_reward_max": 0.019724215772187883, "acceleration_mean": -0.020047439208476178, "acceleration_min": -0.15862792446925952, "acceleration_max": 0.10770182632459789, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 776.9686274509803, "episode_length_min": 484.75, "episode_length_max": 999.0, "episode_reward_mean": 10.260624176782091, "episode_reward_min": 6.541477996005698, "episode_reward_max": 15.006258535275341, "num_neighbours_mean": 0.1560398035630768, "num_neighbours_min": 0.0, "num_neighbours_max": 0.6756756756756757, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.2058823529411766, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 32.119113538395474, "environment_reward_total_min": 17.15411620855185, "environment_reward_total_max": 58.52174819608146}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.02109375, "cur_lr": 0.0003, "total_loss": 1.3199405489489435, "policy_loss": -0.022437966987490655, "vf_loss": 1.3419837523251772, "vf_explained_var": 0.0818649873137474, "kl": 0.01871335280011408, "entropy": 2.9183447659015656, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1030.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 113839, "num_agent_steps_trained": 113839}, "sampler_results": {"episode_reward_max": 31.900555185665503, "episode_reward_min": -3.8213334200070115, "episode_reward_mean": 17.427128362523593, "episode_len_mean": 1382.8823529411766, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -8.649120273257797}, "policy_reward_max": {"default": 22.01267560237666}, "policy_reward_mean": {"default": 5.435984993814698}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.4083333333333333, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.8, "max_step_rate_mean": 0.5916666666666667, "max_step_rate_min": 0.2, "max_step_rate_max": 1.0, "velocity_mean": 0.22982392413514016, "velocity_min": 0.1973882618846178, "velocity_max": 0.28348142350504724, "steering_mean": 0.017080743770941972, "steering_min": -0.09470507073235679, "steering_max": 0.1239347741446423, "step_reward_mean": 0.01332839741619541, "step_reward_min": 0.008585643748023957, "step_reward_max": 0.019724215772187883, "acceleration_mean": -0.020047439208476178, "acceleration_min": -0.15862792446925952, "acceleration_max": 0.10770182632459789, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 776.9686274509803, "episode_length_min": 484.75, "episode_length_max": 999.0, "episode_reward_mean": 10.260624176782091, "episode_reward_min": 6.541477996005698, "episode_reward_max": 15.006258535275341, "num_neighbours_mean": 0.1560398035630768, "num_neighbours_min": 0.0, "num_neighbours_max": 0.6756756756756757, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.2058823529411766, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 32.119113538395474, "environment_reward_total_min": 17.15411620855185, "environment_reward_total_max": 58.52174819608146}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236, 18.23501354592249, 13.33325609668692, 6.935479801018442, 17.16614418481819, 18.067523481298345, 2.6954298697616377, 11.781386133010816], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542, 1213, 1809, 1733, 1000, 1000, 1267, 1117], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853, -6.660251282774001, 12.91050315568116, 11.984761673015342, -4.994833021592723, 11.279824438188427, -3.6587820114353233, 10.70704669152651, -7.283873030490177, 9.38039162970067, -6.271561439661893, 11.110522641469858, 8.437247012705916, 8.728897172112251, 8.252004543879714, 9.815518937418636, 11.31551583114322, -4.295583177315908, -4.324502784065705, 9.497297364748194, -8.649120273257797, 10.933209041520417]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39017889739448597, "mean_inference_ms": 0.598728549210079, "mean_action_processing_ms": 0.19418106663957313, "mean_env_wait_ms": 1.2570664906254236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004363761228673598, "StateBufferConnector_ms": 0.0032565172980813417, "ViewRequirementAgentConnector_ms": 0.0884708236245548}}, "episode_reward_max": 31.900555185665503, "episode_reward_min": -3.8213334200070115, "episode_reward_mean": 5.435984993814698, "episode_len_mean": 1382.8823529411766, "episodes_this_iter": 1, "policy_reward_min": {"default": -8.649120273257797}, "policy_reward_max": {"default": 22.01267560237666}, "policy_reward_mean": {"default": 5.435984993814698}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236, 18.23501354592249, 13.33325609668692, 6.935479801018442, 17.16614418481819, 18.067523481298345, 2.6954298697616377, 11.781386133010816], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542, 1213, 1809, 1733, 1000, 1000, 1267, 1117], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853, -6.660251282774001, 12.91050315568116, 11.984761673015342, -4.994833021592723, 11.279824438188427, -3.6587820114353233, 10.70704669152651, -7.283873030490177, 9.38039162970067, -6.271561439661893, 11.110522641469858, 8.437247012705916, 8.728897172112251, 8.252004543879714, 9.815518937418636, 11.31551583114322, -4.295583177315908, -4.324502784065705, 9.497297364748194, -8.649120273257797, 10.933209041520417]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39017889739448597, "mean_inference_ms": 0.598728549210079, "mean_action_processing_ms": 0.19418106663957313, "mean_env_wait_ms": 1.2570664906254236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004363761228673598, "StateBufferConnector_ms": 0.0032565172980813417, "ViewRequirementAgentConnector_ms": 0.0884708236245548}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 113839, "num_agent_steps_trained": 113839, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 383.60825552201743, "num_env_steps_trained_throughput_per_sec": 383.60825552201743, "timesteps_total": 48000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 113839, "timers": {"training_iteration_time_ms": 5377.371, "sample_time_ms": 5054.494, "load_time_ms": 4.118, "load_throughput": 485628.904, "learn_time_ms": 316.842, "learn_throughput": 6312.288, "synch_weights_time_ms": 1.518}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 113839, "num_agent_steps_trained": 113839}, "done": false, "episodes_total": 34, "training_iteration": 24, "trial_id": "3f391_00000", "date": "2023-12-26_23-22-32", "timestamp": 1703604152, "time_this_iter_s": 5.219845771789551, "time_total_s": 128.41839790344238, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 128.41839790344238, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 15.071428571428571, "ram_util_percent": 60.0}, "success": 0.0, "crash": 0.0, "out": 0.4083333333333333, "max_step": 0.5916666666666667, "length": 1382.8823529411766, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 17.427128362523593}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.4041666666666666, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.8, "max_step_rate_mean": 0.5958333333333333, "max_step_rate_min": 0.2, "max_step_rate_max": 1.0, "velocity_mean": 0.22872526892126277, "velocity_min": 0.1931768426294123, "velocity_max": 0.28348142350504724, "steering_mean": 0.017131514090651983, "steering_min": -0.09470507073235679, "steering_max": 0.1239347741446423, "step_reward_mean": 0.013182034620457651, "step_reward_min": 0.00823634063339666, "step_reward_max": 0.019724215772187883, "acceleration_mean": -0.023991573436434176, "acceleration_min": -0.15862792446925952, "acceleration_max": 0.10770182632459789, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 784.8037037037036, "episode_length_min": 484.75, "episode_length_max": 999.0, "episode_reward_mean": 10.247035591100735, "episode_reward_min": 6.541477996005698, "episode_reward_max": 15.006258535275341, "num_neighbours_mean": 0.14737092558735032, "num_neighbours_min": 0.0, "num_neighbours_max": 0.6756756756756757, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.1666666666666665, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 31.639105443157494, "environment_reward_total_min": 17.15411620855185, "environment_reward_total_max": 58.52174819608146}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.021093750000000005, "cur_lr": 0.0003, "total_loss": 0.8874297384704862, "policy_loss": 0.003323859189237867, "vf_loss": 0.8835718608328275, "vf_explained_var": 0.2439523560660226, "kl": 0.025317652247447253, "entropy": 2.8043515750340053, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1068.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 50000, "num_env_steps_trained": 50000, "num_agent_steps_sampled": 117555, "num_agent_steps_trained": 117555}, "sampler_results": {"episode_reward_max": 31.900555185665503, "episode_reward_min": -3.8213334200070115, "episode_reward_mean": 17.208446219870357, "episode_len_mean": 1376.5833333333333, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"default": -8.649120273257797}, "policy_reward_max": {"default": 22.01267560237666}, "policy_reward_mean": {"default": 5.434246174695902}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0, "crash_rate_min": 0.0, "crash_rate_max": 0.0, "out_of_road_rate_mean": 0.4041666666666666, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.8, "max_step_rate_mean": 0.5958333333333333, "max_step_rate_min": 0.2, "max_step_rate_max": 1.0, "velocity_mean": 0.22872526892126277, "velocity_min": 0.1931768426294123, "velocity_max": 0.28348142350504724, "steering_mean": 0.017131514090651983, "steering_min": -0.09470507073235679, "steering_max": 0.1239347741446423, "step_reward_mean": 0.013182034620457651, "step_reward_min": 0.00823634063339666, "step_reward_max": 0.019724215772187883, "acceleration_mean": -0.023991573436434176, "acceleration_min": -0.15862792446925952, "acceleration_max": 0.10770182632459789, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 784.8037037037036, "episode_length_min": 484.75, "episode_length_max": 999.0, "episode_reward_mean": 10.247035591100735, "episode_reward_min": 6.541477996005698, "episode_reward_max": 15.006258535275341, "num_neighbours_mean": 0.14737092558735032, "num_neighbours_min": 0.0, "num_neighbours_max": 0.6756756756756757, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.1666666666666665, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 31.639105443157494, "environment_reward_total_min": 17.15411620855185, "environment_reward_total_max": 58.52174819608146}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236, 18.23501354592249, 13.33325609668692, 6.935479801018442, 17.16614418481819, 18.067523481298345, 2.6954298697616377, 11.781386133010816, 0.6839377686500008, 26.297761820880662], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542, 1213, 1809, 1733, 1000, 1000, 1267, 1117, 1539, 1000], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853, -6.660251282774001, 12.91050315568116, 11.984761673015342, -4.994833021592723, 11.279824438188427, -3.6587820114353233, 10.70704669152651, -7.283873030490177, 9.38039162970067, -6.271561439661893, 11.110522641469858, 8.437247012705916, 8.728897172112251, 8.252004543879714, 9.815518937418636, 11.31551583114322, -4.295583177315908, -4.324502784065705, 9.497297364748194, -8.649120273257797, 10.933209041520417, 8.00668118550423, -5.192834847381596, -2.1299085694726356, 13.875389906288977, 12.422371914591638]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39018098032806275, "mean_inference_ms": 0.5986861609053049, "mean_action_processing_ms": 0.19406273320793688, "mean_env_wait_ms": 1.2565880462895709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004333919949001736, "StateBufferConnector_ms": 0.0033193164401584202, "ViewRequirementAgentConnector_ms": 0.08940233124627008}}, "episode_reward_max": 31.900555185665503, "episode_reward_min": -3.8213334200070115, "episode_reward_mean": 5.434246174695902, "episode_len_mean": 1376.5833333333333, "episodes_this_iter": 2, "policy_reward_min": {"default": -8.649120273257797}, "policy_reward_max": {"default": 22.01267560237666}, "policy_reward_mean": {"default": 5.434246174695902}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236, 18.23501354592249, 13.33325609668692, 6.935479801018442, 17.16614418481819, 18.067523481298345, 2.6954298697616377, 11.781386133010816, 0.6839377686500008, 26.297761820880662], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542, 1213, 1809, 1733, 1000, 1000, 1267, 1117, 1539, 1000], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853, -6.660251282774001, 12.91050315568116, 11.984761673015342, -4.994833021592723, 11.279824438188427, -3.6587820114353233, 10.70704669152651, -7.283873030490177, 9.38039162970067, -6.271561439661893, 11.110522641469858, 8.437247012705916, 8.728897172112251, 8.252004543879714, 9.815518937418636, 11.31551583114322, -4.295583177315908, -4.324502784065705, 9.497297364748194, -8.649120273257797, 10.933209041520417, 8.00668118550423, -5.192834847381596, -2.1299085694726356, 13.875389906288977, 12.422371914591638]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39018098032806275, "mean_inference_ms": 0.5986861609053049, "mean_action_processing_ms": 0.19406273320793688, "mean_env_wait_ms": 1.2565880462895709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004333919949001736, "StateBufferConnector_ms": 0.0033193164401584202, "ViewRequirementAgentConnector_ms": 0.08940233124627008}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 117555, "num_agent_steps_trained": 117555, "num_env_steps_sampled": 50000, "num_env_steps_trained": 50000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 390.83812861183407, "num_env_steps_trained_throughput_per_sec": 390.83812861183407, "timesteps_total": 50000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 117555, "timers": {"training_iteration_time_ms": 5316.401, "sample_time_ms": 5015.931, "load_time_ms": 4.04, "load_throughput": 495022.867, "learn_time_ms": 294.63, "learn_throughput": 6788.172, "synch_weights_time_ms": 1.412}, "counters": {"num_env_steps_sampled": 50000, "num_env_steps_trained": 50000, "num_agent_steps_sampled": 117555, "num_agent_steps_trained": 117555}, "done": false, "episodes_total": 36, "training_iteration": 25, "trial_id": "3f391_00000", "date": "2023-12-26_23-22-37", "timestamp": 1703604157, "time_this_iter_s": 5.123702764511108, "time_total_s": 133.5421006679535, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 133.5421006679535, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 16.200000000000003, "ram_util_percent": 60.0}, "success": 0.0, "crash": 0.0, "out": 0.4041666666666666, "max_step": 0.5958333333333333, "length": 1376.5833333333333, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 17.208446219870357}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.02564102564102564, "crash_rate_min": 0.0, "crash_rate_max": 1.0, "out_of_road_rate_mean": 0.37307692307692303, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.8, "max_step_rate_mean": 0.6012820512820513, "max_step_rate_min": 0.0, "max_step_rate_max": 1.0, "velocity_mean": 0.22920773285326165, "velocity_min": 0.1931768426294123, "velocity_max": 0.28348142350504724, "steering_mean": 0.017424125566534675, "steering_min": -0.09470507073235679, "steering_max": 0.1239347741446423, "step_reward_mean": 0.013209786096208079, "step_reward_min": 0.00823634063339666, "step_reward_max": 0.019724215772187883, "acceleration_mean": -0.025374921192529615, "acceleration_min": -0.15862792446925952, "acceleration_max": 0.10770182632459789, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 779.6393162393161, "episode_length_min": 155.0, "episode_length_max": 999.0, "episode_reward_mean": 10.18456686104163, "episode_reward_min": 2.2557562665879147, "episode_reward_max": 15.006258535275341, "num_neighbours_mean": 0.1873167518242208, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.076923076923077, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 30.656857655273434, "environment_reward_total_min": 4.5115125331758295, "environment_reward_total_max": 58.52174819608146}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03164062500000001, "cur_lr": 0.0003, "total_loss": 0.4944007240634944, "policy_loss": 0.009216199389525823, "vf_loss": 0.4846842441175665, "vf_explained_var": 0.1430400814328875, "kl": 0.015809503184365647, "entropy": 2.9666204520634243, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1103.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 121555, "num_agent_steps_trained": 121555}, "sampler_results": {"episode_reward_max": 31.900555185665503, "episode_reward_min": -15.488487466824171, "episode_reward_mean": 16.823734155961567, "episode_len_mean": 1325.974358974359, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {"default": -8.825791796730428}, "policy_reward_max": {"default": 22.01267560237666}, "policy_reward_mean": {"default": 5.467713600687509}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.02564102564102564, "crash_rate_min": 0.0, "crash_rate_max": 1.0, "out_of_road_rate_mean": 0.37307692307692303, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 0.8, "max_step_rate_mean": 0.6012820512820513, "max_step_rate_min": 0.0, "max_step_rate_max": 1.0, "velocity_mean": 0.22920773285326165, "velocity_min": 0.1931768426294123, "velocity_max": 0.28348142350504724, "steering_mean": 0.017424125566534675, "steering_min": -0.09470507073235679, "steering_max": 0.1239347741446423, "step_reward_mean": 0.013209786096208079, "step_reward_min": 0.00823634063339666, "step_reward_max": 0.019724215772187883, "acceleration_mean": -0.025374921192529615, "acceleration_min": -0.15862792446925952, "acceleration_max": 0.10770182632459789, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 779.6393162393161, "episode_length_min": 155.0, "episode_length_max": 999.0, "episode_reward_mean": 10.18456686104163, "episode_reward_min": 2.2557562665879147, "episode_reward_max": 15.006258535275341, "num_neighbours_mean": 0.1873167518242208, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.076923076923077, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 30.656857655273434, "environment_reward_total_min": 4.5115125331758295, "environment_reward_total_max": 58.52174819608146}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236, 18.23501354592249, 13.33325609668692, 6.935479801018442, 17.16614418481819, 18.067523481298345, 2.6954298697616377, 11.781386133010816, 0.6839377686500008, 26.297761820880662, 28.766281620541164, 23.343774013451306, -15.488487466824171], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542, 1213, 1809, 1733, 1000, 1000, 1267, 1117, 1539, 1000, 1000, 1000, 156], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853, -6.660251282774001, 12.91050315568116, 11.984761673015342, -4.994833021592723, 11.279824438188427, -3.6587820114353233, 10.70704669152651, -7.283873030490177, 9.38039162970067, -6.271561439661893, 11.110522641469858, 8.437247012705916, 8.728897172112251, 8.252004543879714, 9.815518937418636, 11.31551583114322, -4.295583177315908, -4.324502784065705, 9.497297364748194, -8.649120273257797, 10.933209041520417, 8.00668118550423, -5.192834847381596, -2.1299085694726356, 13.875389906288977, 12.422371914591638, 14.971830334114072, 13.794451286427158, 16.42294999819064, 6.920824015260627, -6.662695670093742, -8.825791796730428]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39036409491707563, "mean_inference_ms": 0.5986386362630726, "mean_action_processing_ms": 0.1939708298816791, "mean_env_wait_ms": 1.2563699999410525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004338606809958434, "StateBufferConnector_ms": 0.003361090635642027, "ViewRequirementAgentConnector_ms": 0.09221663841834435}}, "episode_reward_max": 31.900555185665503, "episode_reward_min": -15.488487466824171, "episode_reward_mean": 5.467713600687509, "episode_len_mean": 1325.974358974359, "episodes_this_iter": 3, "policy_reward_min": {"default": -8.825791796730428}, "policy_reward_max": {"default": 22.01267560237666}, "policy_reward_mean": {"default": 5.467713600687509}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236, 18.23501354592249, 13.33325609668692, 6.935479801018442, 17.16614418481819, 18.067523481298345, 2.6954298697616377, 11.781386133010816, 0.6839377686500008, 26.297761820880662, 28.766281620541164, 23.343774013451306, -15.488487466824171], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542, 1213, 1809, 1733, 1000, 1000, 1267, 1117, 1539, 1000, 1000, 1000, 156], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853, -6.660251282774001, 12.91050315568116, 11.984761673015342, -4.994833021592723, 11.279824438188427, -3.6587820114353233, 10.70704669152651, -7.283873030490177, 9.38039162970067, -6.271561439661893, 11.110522641469858, 8.437247012705916, 8.728897172112251, 8.252004543879714, 9.815518937418636, 11.31551583114322, -4.295583177315908, -4.324502784065705, 9.497297364748194, -8.649120273257797, 10.933209041520417, 8.00668118550423, -5.192834847381596, -2.1299085694726356, 13.875389906288977, 12.422371914591638, 14.971830334114072, 13.794451286427158, 16.42294999819064, 6.920824015260627, -6.662695670093742, -8.825791796730428]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39036409491707563, "mean_inference_ms": 0.5986386362630726, "mean_action_processing_ms": 0.1939708298816791, "mean_env_wait_ms": 1.2563699999410525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004338606809958434, "StateBufferConnector_ms": 0.003361090635642027, "ViewRequirementAgentConnector_ms": 0.09221663841834435}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 121555, "num_agent_steps_trained": 121555, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 354.34283081829267, "num_env_steps_trained_throughput_per_sec": 354.34283081829267, "timesteps_total": 52000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 121555, "timers": {"training_iteration_time_ms": 5304.292, "sample_time_ms": 5025.073, "load_time_ms": 3.815, "load_throughput": 524288.0, "learn_time_ms": 273.647, "learn_throughput": 7308.674, "synch_weights_time_ms": 1.401}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 121555, "num_agent_steps_trained": 121555}, "done": false, "episodes_total": 39, "training_iteration": 26, "trial_id": "3f391_00000", "date": "2023-12-26_23-22-43", "timestamp": 1703604163, "time_this_iter_s": 5.650992393493652, "time_total_s": 139.19309306144714, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 139.19309306144714, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 17.0875, "ram_util_percent": 60.075}, "success": 0.0, "crash": 0.02564102564102564, "out": 0.37307692307692303, "max_step": 0.6012820512820513, "length": 1325.974358974359, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 16.823734155961567}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.024390243902439025, "crash_rate_min": 0.0, "crash_rate_max": 1.0, "out_of_road_rate_mean": 0.3955284552845528, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 1.0, "max_step_rate_mean": 0.5800813008130081, "max_step_rate_min": 0.0, "max_step_rate_max": 1.0, "velocity_mean": 0.2315432121083171, "velocity_min": 0.1931768426294123, "velocity_max": 0.31834091771364775, "steering_mean": 0.015948109371431027, "steering_min": -0.09470507073235679, "steering_max": 0.1239347741446423, "step_reward_mean": 0.013480620187051656, "step_reward_min": 0.00823634063339666, "step_reward_max": 0.023470633957415905, "acceleration_mean": -0.021094319294463256, "acceleration_min": -0.15862792446925952, "acceleration_max": 0.1347554800669094, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 779.7747967479675, "episode_length_min": 155.0, "episode_length_max": 999.0, "episode_reward_mean": 10.412776297323594, "episode_reward_min": 2.2557562665879147, "episode_reward_max": 19.277214023690938, "num_neighbours_mean": 0.19262146206149355, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.048780487804878, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 31.081612287771765, "environment_reward_total_min": 4.5115125331758295, "environment_reward_total_max": 58.52174819608146}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03164062500000001, "cur_lr": 0.0003, "total_loss": 1.6494423727904046, "policy_loss": -0.004256940207311086, "vf_loss": 1.6533791261059898, "vf_explained_var": -0.10338382039751326, "kl": 0.010119560434084117, "entropy": 2.9512694154466903, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1138.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 125216, "num_agent_steps_trained": 125216}, "sampler_results": {"episode_reward_max": 37.941302895314664, "episode_reward_min": -15.488487466824171, "episode_reward_mean": 16.950340198773695, "episode_len_mean": 1315.878048780488, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"default": -8.825791796730428}, "policy_reward_max": {"default": 22.94033648613103}, "policy_reward_mean": {"default": 5.559711585197771}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.024390243902439025, "crash_rate_min": 0.0, "crash_rate_max": 1.0, "out_of_road_rate_mean": 0.3955284552845528, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 1.0, "max_step_rate_mean": 0.5800813008130081, "max_step_rate_min": 0.0, "max_step_rate_max": 1.0, "velocity_mean": 0.2315432121083171, "velocity_min": 0.1931768426294123, "velocity_max": 0.31834091771364775, "steering_mean": 0.015948109371431027, "steering_min": -0.09470507073235679, "steering_max": 0.1239347741446423, "step_reward_mean": 0.013480620187051656, "step_reward_min": 0.00823634063339666, "step_reward_max": 0.023470633957415905, "acceleration_mean": -0.021094319294463256, "acceleration_min": -0.15862792446925952, "acceleration_max": 0.1347554800669094, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 779.7747967479675, "episode_length_min": 155.0, "episode_length_max": 999.0, "episode_reward_mean": 10.412776297323594, "episode_reward_min": 2.2557562665879147, "episode_reward_max": 19.277214023690938, "num_neighbours_mean": 0.19262146206149355, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.048780487804878, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 31.081612287771765, "environment_reward_total_min": 4.5115125331758295, "environment_reward_total_max": 58.52174819608146}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236, 18.23501354592249, 13.33325609668692, 6.935479801018442, 17.16614418481819, 18.067523481298345, 2.6954298697616377, 11.781386133010816, 0.6839377686500008, 26.297761820880662, 28.766281620541164, 23.343774013451306, -15.488487466824171, 0.897013171905634, 37.941302895314664], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542, 1213, 1809, 1733, 1000, 1000, 1267, 1117, 1539, 1000, 1000, 1000, 156, 746, 1492], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853, -6.660251282774001, 12.91050315568116, 11.984761673015342, -4.994833021592723, 11.279824438188427, -3.6587820114353233, 10.70704669152651, -7.283873030490177, 9.38039162970067, -6.271561439661893, 11.110522641469858, 8.437247012705916, 8.728897172112251, 8.252004543879714, 9.815518937418636, 11.31551583114322, -4.295583177315908, -4.324502784065705, 9.497297364748194, -8.649120273257797, 10.933209041520417, 8.00668118550423, -5.192834847381596, -2.1299085694726356, 13.875389906288977, 12.422371914591638, 14.971830334114072, 13.794451286427158, 16.42294999819064, 6.920824015260627, -6.662695670093742, -8.825791796730428, 3.269437524578274, -2.372424352672648, 6.936094661805679, 22.94033648613103, 8.064871747377914]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.390423151142917, "mean_inference_ms": 0.5985805086692945, "mean_action_processing_ms": 0.19390947248552257, "mean_env_wait_ms": 1.2562800221180335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004314794773008765, "StateBufferConnector_ms": 0.003353560843118807, "ViewRequirementAgentConnector_ms": 0.09232090740669065}}, "episode_reward_max": 37.941302895314664, "episode_reward_min": -15.488487466824171, "episode_reward_mean": 5.559711585197771, "episode_len_mean": 1315.878048780488, "episodes_this_iter": 2, "policy_reward_min": {"default": -8.825791796730428}, "policy_reward_max": {"default": 22.94033648613103}, "policy_reward_mean": {"default": 5.559711585197771}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236, 18.23501354592249, 13.33325609668692, 6.935479801018442, 17.16614418481819, 18.067523481298345, 2.6954298697616377, 11.781386133010816, 0.6839377686500008, 26.297761820880662, 28.766281620541164, 23.343774013451306, -15.488487466824171, 0.897013171905634, 37.941302895314664], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542, 1213, 1809, 1733, 1000, 1000, 1267, 1117, 1539, 1000, 1000, 1000, 156, 746, 1492], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853, -6.660251282774001, 12.91050315568116, 11.984761673015342, -4.994833021592723, 11.279824438188427, -3.6587820114353233, 10.70704669152651, -7.283873030490177, 9.38039162970067, -6.271561439661893, 11.110522641469858, 8.437247012705916, 8.728897172112251, 8.252004543879714, 9.815518937418636, 11.31551583114322, -4.295583177315908, -4.324502784065705, 9.497297364748194, -8.649120273257797, 10.933209041520417, 8.00668118550423, -5.192834847381596, -2.1299085694726356, 13.875389906288977, 12.422371914591638, 14.971830334114072, 13.794451286427158, 16.42294999819064, 6.920824015260627, -6.662695670093742, -8.825791796730428, 3.269437524578274, -2.372424352672648, 6.936094661805679, 22.94033648613103, 8.064871747377914]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.390423151142917, "mean_inference_ms": 0.5985805086692945, "mean_action_processing_ms": 0.19390947248552257, "mean_env_wait_ms": 1.2562800221180335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004314794773008765, "StateBufferConnector_ms": 0.003353560843118807, "ViewRequirementAgentConnector_ms": 0.09232090740669065}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 125216, "num_agent_steps_trained": 125216, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 387.4468915691053, "num_env_steps_trained_throughput_per_sec": 387.4468915691053, "timesteps_total": 54000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 125216, "timers": {"training_iteration_time_ms": 5294.681, "sample_time_ms": 5020.715, "load_time_ms": 3.737, "load_throughput": 535117.439, "learn_time_ms": 268.457, "learn_throughput": 7449.99, "synch_weights_time_ms": 1.411}, "counters": {"num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 125216, "num_agent_steps_trained": 125216}, "done": false, "episodes_total": 41, "training_iteration": 27, "trial_id": "3f391_00000", "date": "2023-12-26_23-22-48", "timestamp": 1703604168, "time_this_iter_s": 5.16870903968811, "time_total_s": 144.36180210113525, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 144.36180210113525, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 15.77142857142857, "ram_util_percent": 60.25714285714286}, "success": 0.0, "crash": 0.024390243902439025, "out": 0.3955284552845528, "max_step": 0.5800813008130081, "length": 1315.878048780488, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 16.950340198773695}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.023809523809523808, "crash_rate_min": 0.0, "crash_rate_max": 1.0, "out_of_road_rate_mean": 0.398015873015873, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 1.0, "max_step_rate_mean": 0.5781746031746031, "max_step_rate_min": 0.0, "max_step_rate_max": 1.0, "velocity_mean": 0.2321102234323799, "velocity_min": 0.1931768426294123, "velocity_max": 0.31834091771364775, "steering_mean": 0.014981888822258002, "steering_min": -0.09470507073235679, "steering_max": 0.1239347741446423, "step_reward_mean": 0.013533160019481304, "step_reward_min": 0.00823634063339666, "step_reward_max": 0.023470633957415905, "acceleration_mean": -0.0205529150067265, "acceleration_min": -0.15862792446925952, "acceleration_max": 0.1347554800669094, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 778.0539682539683, "episode_length_min": 155.0, "episode_length_max": 999.0, "episode_reward_mean": 10.429109240315556, "episode_reward_min": 2.2557562665879147, "episode_reward_max": 19.277214023690938, "num_neighbours_mean": 0.18964216929997557, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0714285714285716, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 31.398598652633012, "environment_reward_total_min": 4.5115125331758295, "environment_reward_total_max": 58.52174819608146}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03164062500000001, "cur_lr": 0.0003, "total_loss": 2.5455928087234496, "policy_loss": -0.009703031075852258, "vf_loss": 2.5545331069401334, "vf_explained_var": -0.005588666030338832, "kl": 0.024104775575168397, "entropy": 3.002312251499721, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1173.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 129177, "num_agent_steps_trained": 129177}, "sampler_results": {"episode_reward_max": 37.941302895314664, "episode_reward_min": -15.488487466824171, "episode_reward_mean": 17.128064868034404, "episode_len_mean": 1329.404761904762, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -8.825791796730428}, "policy_reward_max": {"default": 22.94033648613103}, "policy_reward_mean": {"default": 5.576579259360037}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.023809523809523808, "crash_rate_min": 0.0, "crash_rate_max": 1.0, "out_of_road_rate_mean": 0.398015873015873, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 1.0, "max_step_rate_mean": 0.5781746031746031, "max_step_rate_min": 0.0, "max_step_rate_max": 1.0, "velocity_mean": 0.2321102234323799, "velocity_min": 0.1931768426294123, "velocity_max": 0.31834091771364775, "steering_mean": 0.014981888822258002, "steering_min": -0.09470507073235679, "steering_max": 0.1239347741446423, "step_reward_mean": 0.013533160019481304, "step_reward_min": 0.00823634063339666, "step_reward_max": 0.023470633957415905, "acceleration_mean": -0.0205529150067265, "acceleration_min": -0.15862792446925952, "acceleration_max": 0.1347554800669094, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 778.0539682539683, "episode_length_min": 155.0, "episode_length_max": 999.0, "episode_reward_mean": 10.429109240315556, "episode_reward_min": 2.2557562665879147, "episode_reward_max": 19.277214023690938, "num_neighbours_mean": 0.18964216929997557, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0714285714285716, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 31.398598652633012, "environment_reward_total_min": 4.5115125331758295, "environment_reward_total_max": 58.52174819608146}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236, 18.23501354592249, 13.33325609668692, 6.935479801018442, 17.16614418481819, 18.067523481298345, 2.6954298697616377, 11.781386133010816, 0.6839377686500008, 26.297761820880662, 28.766281620541164, 23.343774013451306, -15.488487466824171, 0.897013171905634, 37.941302895314664, 24.414776307723375], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542, 1213, 1809, 1733, 1000, 1000, 1267, 1117, 1539, 1000, 1000, 1000, 156, 746, 1492, 1884], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853, -6.660251282774001, 12.91050315568116, 11.984761673015342, -4.994833021592723, 11.279824438188427, -3.6587820114353233, 10.70704669152651, -7.283873030490177, 9.38039162970067, -6.271561439661893, 11.110522641469858, 8.437247012705916, 8.728897172112251, 8.252004543879714, 9.815518937418636, 11.31551583114322, -4.295583177315908, -4.324502784065705, 9.497297364748194, -8.649120273257797, 10.933209041520417, 8.00668118550423, -5.192834847381596, -2.1299085694726356, 13.875389906288977, 12.422371914591638, 14.971830334114072, 13.794451286427158, 16.42294999819064, 6.920824015260627, -6.662695670093742, -8.825791796730428, 3.269437524578274, -2.372424352672648, 6.936094661805679, 22.94033648613103, 8.064871747377914, -8.238884349472102, 17.642727568887942, 4.099784811955448, 10.911148276352217]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3903983335412342, "mean_inference_ms": 0.5985272799906944, "mean_action_processing_ms": 0.19386145341076766, "mean_env_wait_ms": 1.2561700770042556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042921020871117006, "StateBufferConnector_ms": 0.0033412660871233258, "ViewRequirementAgentConnector_ms": 0.09190582093738374}}, "episode_reward_max": 37.941302895314664, "episode_reward_min": -15.488487466824171, "episode_reward_mean": 5.576579259360037, "episode_len_mean": 1329.404761904762, "episodes_this_iter": 1, "policy_reward_min": {"default": -8.825791796730428}, "policy_reward_max": {"default": 22.94033648613103}, "policy_reward_mean": {"default": 5.576579259360037}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236, 18.23501354592249, 13.33325609668692, 6.935479801018442, 17.16614418481819, 18.067523481298345, 2.6954298697616377, 11.781386133010816, 0.6839377686500008, 26.297761820880662, 28.766281620541164, 23.343774013451306, -15.488487466824171, 0.897013171905634, 37.941302895314664, 24.414776307723375], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542, 1213, 1809, 1733, 1000, 1000, 1267, 1117, 1539, 1000, 1000, 1000, 156, 746, 1492, 1884], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853, -6.660251282774001, 12.91050315568116, 11.984761673015342, -4.994833021592723, 11.279824438188427, -3.6587820114353233, 10.70704669152651, -7.283873030490177, 9.38039162970067, -6.271561439661893, 11.110522641469858, 8.437247012705916, 8.728897172112251, 8.252004543879714, 9.815518937418636, 11.31551583114322, -4.295583177315908, -4.324502784065705, 9.497297364748194, -8.649120273257797, 10.933209041520417, 8.00668118550423, -5.192834847381596, -2.1299085694726356, 13.875389906288977, 12.422371914591638, 14.971830334114072, 13.794451286427158, 16.42294999819064, 6.920824015260627, -6.662695670093742, -8.825791796730428, 3.269437524578274, -2.372424352672648, 6.936094661805679, 22.94033648613103, 8.064871747377914, -8.238884349472102, 17.642727568887942, 4.099784811955448, 10.911148276352217]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3903983335412342, "mean_inference_ms": 0.5985272799906944, "mean_action_processing_ms": 0.19386145341076766, "mean_env_wait_ms": 1.2561700770042556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042921020871117006, "StateBufferConnector_ms": 0.0033412660871233258, "ViewRequirementAgentConnector_ms": 0.09190582093738374}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 129177, "num_agent_steps_trained": 129177, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 414.15665342231625, "num_env_steps_trained_throughput_per_sec": 414.15665342231625, "timesteps_total": 56000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 129177, "timers": {"training_iteration_time_ms": 5139.43, "sample_time_ms": 4873.789, "load_time_ms": 3.693, "load_throughput": 541553.399, "learn_time_ms": 260.173, "learn_throughput": 7687.197, "synch_weights_time_ms": 1.417}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 129177, "num_agent_steps_trained": 129177}, "done": false, "episodes_total": 42, "training_iteration": 28, "trial_id": "3f391_00000", "date": "2023-12-26_23-22-53", "timestamp": 1703604173, "time_this_iter_s": 4.83648419380188, "time_total_s": 149.19828629493713, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 149.19828629493713, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 15.728571428571428, "ram_util_percent": 60.10000000000001}, "success": 0.0, "crash": 0.023809523809523808, "out": 0.398015873015873, "max_step": 0.5781746031746031, "length": 1329.404761904762, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 17.128064868034404}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.022727272727272728, "crash_rate_min": 0.0, "crash_rate_max": 1.0, "out_of_road_rate_mean": 0.3799242424242424, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 1.0, "max_step_rate_mean": 0.5973484848484848, "max_step_rate_min": 0.0, "max_step_rate_max": 1.0, "velocity_mean": 0.23191994078611902, "velocity_min": 0.1931768426294123, "velocity_max": 0.31834091771364775, "steering_mean": 0.016548438972721072, "steering_min": -0.09470507073235679, "steering_max": 0.1239347741446423, "step_reward_mean": 0.0134636517798435, "step_reward_min": 0.00823634063339666, "step_reward_max": 0.023470633957415905, "acceleration_mean": -0.023504305346127984, "acceleration_min": -0.15862792446925952, "acceleration_max": 0.1347554800669094, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 788.0969696969696, "episode_length_min": 155.0, "episode_length_max": 999.0, "episode_reward_mean": 10.500148582514948, "episode_reward_min": 2.2557562665879147, "episode_reward_max": 19.277214023690938, "num_neighbours_mean": 0.20545559512895564, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.022727272727273, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 31.061569147395346, "environment_reward_total_min": 4.5115125331758295, "environment_reward_total_max": 58.52174819608146}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0474609375, "cur_lr": 0.0003, "total_loss": 0.019009671200598988, "policy_loss": -0.002518931669848306, "vf_loss": 0.020443772431463003, "vf_explained_var": 0.1758263877459935, "kl": 0.022857449636130005, "entropy": 3.138100174495152, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1208.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 58000, "num_env_steps_trained": 58000, "num_agent_steps_sampled": 133177, "num_agent_steps_trained": 133177}, "sampler_results": {"episode_reward_max": 37.941302895314664, "episode_reward_min": -15.488487466824171, "episode_reward_mean": 17.44023017090466, "episode_len_mean": 1314.4318181818182, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"default": -8.825791796730428}, "policy_reward_max": {"default": 22.94033648613103}, "policy_reward_mean": {"default": 5.769700206915827}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.022727272727272728, "crash_rate_min": 0.0, "crash_rate_max": 1.0, "out_of_road_rate_mean": 0.3799242424242424, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 1.0, "max_step_rate_mean": 0.5973484848484848, "max_step_rate_min": 0.0, "max_step_rate_max": 1.0, "velocity_mean": 0.23191994078611902, "velocity_min": 0.1931768426294123, "velocity_max": 0.31834091771364775, "steering_mean": 0.016548438972721072, "steering_min": -0.09470507073235679, "steering_max": 0.1239347741446423, "step_reward_mean": 0.0134636517798435, "step_reward_min": 0.00823634063339666, "step_reward_max": 0.023470633957415905, "acceleration_mean": -0.023504305346127984, "acceleration_min": -0.15862792446925952, "acceleration_max": 0.1347554800669094, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 788.0969696969696, "episode_length_min": 155.0, "episode_length_max": 999.0, "episode_reward_mean": 10.500148582514948, "episode_reward_min": 2.2557562665879147, "episode_reward_max": 19.277214023690938, "num_neighbours_mean": 0.20545559512895564, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.022727272727273, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 31.061569147395346, "environment_reward_total_min": 4.5115125331758295, "environment_reward_total_max": 58.52174819608146}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236, 18.23501354592249, 13.33325609668692, 6.935479801018442, 17.16614418481819, 18.067523481298345, 2.6954298697616377, 11.781386133010816, 0.6839377686500008, 26.297761820880662, 28.766281620541164, 23.343774013451306, -15.488487466824171, 0.897013171905634, 37.941302895314664, 24.414776307723375, 22.373284272793352, 25.618118789566694], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542, 1213, 1809, 1733, 1000, 1000, 1267, 1117, 1539, 1000, 1000, 1000, 156, 746, 1492, 1884, 1000, 1000], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853, -6.660251282774001, 12.91050315568116, 11.984761673015342, -4.994833021592723, 11.279824438188427, -3.6587820114353233, 10.70704669152651, -7.283873030490177, 9.38039162970067, -6.271561439661893, 11.110522641469858, 8.437247012705916, 8.728897172112251, 8.252004543879714, 9.815518937418636, 11.31551583114322, -4.295583177315908, -4.324502784065705, 9.497297364748194, -8.649120273257797, 10.933209041520417, 8.00668118550423, -5.192834847381596, -2.1299085694726356, 13.875389906288977, 12.422371914591638, 14.971830334114072, 13.794451286427158, 16.42294999819064, 6.920824015260627, -6.662695670093742, -8.825791796730428, 3.269437524578274, -2.372424352672648, 6.936094661805679, 22.94033648613103, 8.064871747377914, -8.238884349472102, 17.642727568887942, 4.099784811955448, 10.911148276352217, 10.033557856591916, 12.339726416201444, 9.777045476421103, 15.841073313145609]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39036204869333413, "mean_inference_ms": 0.5984169479871483, "mean_action_processing_ms": 0.1938007430078913, "mean_env_wait_ms": 1.2562211458838903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00429966232993386, "StateBufferConnector_ms": 0.003361160104924982, "ViewRequirementAgentConnector_ms": 0.09345195510170677}}, "episode_reward_max": 37.941302895314664, "episode_reward_min": -15.488487466824171, "episode_reward_mean": 5.769700206915827, "episode_len_mean": 1314.4318181818182, "episodes_this_iter": 2, "policy_reward_min": {"default": -8.825791796730428}, "policy_reward_max": {"default": 22.94033648613103}, "policy_reward_mean": {"default": 5.769700206915827}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236, 18.23501354592249, 13.33325609668692, 6.935479801018442, 17.16614418481819, 18.067523481298345, 2.6954298697616377, 11.781386133010816, 0.6839377686500008, 26.297761820880662, 28.766281620541164, 23.343774013451306, -15.488487466824171, 0.897013171905634, 37.941302895314664, 24.414776307723375, 22.373284272793352, 25.618118789566694], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542, 1213, 1809, 1733, 1000, 1000, 1267, 1117, 1539, 1000, 1000, 1000, 156, 746, 1492, 1884, 1000, 1000], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853, -6.660251282774001, 12.91050315568116, 11.984761673015342, -4.994833021592723, 11.279824438188427, -3.6587820114353233, 10.70704669152651, -7.283873030490177, 9.38039162970067, -6.271561439661893, 11.110522641469858, 8.437247012705916, 8.728897172112251, 8.252004543879714, 9.815518937418636, 11.31551583114322, -4.295583177315908, -4.324502784065705, 9.497297364748194, -8.649120273257797, 10.933209041520417, 8.00668118550423, -5.192834847381596, -2.1299085694726356, 13.875389906288977, 12.422371914591638, 14.971830334114072, 13.794451286427158, 16.42294999819064, 6.920824015260627, -6.662695670093742, -8.825791796730428, 3.269437524578274, -2.372424352672648, 6.936094661805679, 22.94033648613103, 8.064871747377914, -8.238884349472102, 17.642727568887942, 4.099784811955448, 10.911148276352217, 10.033557856591916, 12.339726416201444, 9.777045476421103, 15.841073313145609]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39036204869333413, "mean_inference_ms": 0.5984169479871483, "mean_action_processing_ms": 0.1938007430078913, "mean_env_wait_ms": 1.2562211458838903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00429966232993386, "StateBufferConnector_ms": 0.003361160104924982, "ViewRequirementAgentConnector_ms": 0.09345195510170677}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 133177, "num_agent_steps_trained": 133177, "num_env_steps_sampled": 58000, "num_env_steps_trained": 58000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 353.94479123053526, "num_env_steps_trained_throughput_per_sec": 353.94479123053526, "timesteps_total": 58000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 133177, "timers": {"training_iteration_time_ms": 5222.027, "sample_time_ms": 4960.14, "load_time_ms": 3.661, "load_throughput": 546343.192, "learn_time_ms": 256.47, "learn_throughput": 7798.171, "synch_weights_time_ms": 1.397}, "counters": {"num_env_steps_sampled": 58000, "num_env_steps_trained": 58000, "num_agent_steps_sampled": 133177, "num_agent_steps_trained": 133177}, "done": false, "episodes_total": 44, "training_iteration": 29, "trial_id": "3f391_00000", "date": "2023-12-26_23-22-59", "timestamp": 1703604179, "time_this_iter_s": 5.65763521194458, "time_total_s": 154.8559215068817, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 154.8559215068817, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 16.0625, "ram_util_percent": 60.1}, "success": 0.0, "crash": 0.022727272727272728, "out": 0.3799242424242424, "max_step": 0.5973484848484848, "length": 1314.4318181818182, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 17.44023017090466}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.03623188405797101, "crash_rate_min": 0.0, "crash_rate_max": 1.0, "out_of_road_rate_mean": 0.3706521739130434, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 1.0, "max_step_rate_mean": 0.5931159420289854, "max_step_rate_min": 0.0, "max_step_rate_max": 1.0, "velocity_mean": 0.23304143333067776, "velocity_min": 0.1931768426294123, "velocity_max": 0.31834091771364775, "steering_mean": 0.016798501282697543, "steering_min": -0.09470507073235679, "steering_max": 0.1239347741446423, "step_reward_mean": 0.013579622773788177, "step_reward_min": 0.00823634063339666, "step_reward_max": 0.023470633957415905, "acceleration_mean": -0.02289650564178993, "acceleration_min": -0.15862792446925952, "acceleration_max": 0.1347554800669094, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 785.723188405797, "episode_length_min": 155.0, "episode_length_max": 999.0, "episode_reward_mean": 10.57265392531923, "episode_reward_min": 2.2557562665879147, "episode_reward_max": 19.277214023690938, "num_neighbours_mean": 0.20353686431138307, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 30.92038471647047, "environment_reward_total_min": 4.5115125331758295, "environment_reward_total_max": 58.52174819608146}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.07119140625000002, "cur_lr": 0.0003, "total_loss": 0.9863054552248546, "policy_loss": 0.02319257663828986, "vf_loss": 0.9608430692659957, "vf_explained_var": 0.05459451505116054, "kl": 0.03188276800626394, "entropy": 2.975166150501796, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1243.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 137251, "num_agent_steps_trained": 137251}, "sampler_results": {"episode_reward_max": 37.941302895314664, "episode_reward_min": -15.488487466824171, "episode_reward_mean": 17.240154360342896, "episode_len_mean": 1294.5869565217392, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"default": -8.825791796730428}, "policy_reward_max": {"default": 22.94033648613103}, "policy_reward_mean": {"default": 5.7467181201142985}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.03623188405797101, "crash_rate_min": 0.0, "crash_rate_max": 1.0, "out_of_road_rate_mean": 0.3706521739130434, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 1.0, "max_step_rate_mean": 0.5931159420289854, "max_step_rate_min": 0.0, "max_step_rate_max": 1.0, "velocity_mean": 0.23304143333067776, "velocity_min": 0.1931768426294123, "velocity_max": 0.31834091771364775, "steering_mean": 0.016798501282697543, "steering_min": -0.09470507073235679, "steering_max": 0.1239347741446423, "step_reward_mean": 0.013579622773788177, "step_reward_min": 0.00823634063339666, "step_reward_max": 0.023470633957415905, "acceleration_mean": -0.02289650564178993, "acceleration_min": -0.15862792446925952, "acceleration_max": 0.1347554800669094, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 785.723188405797, "episode_length_min": 155.0, "episode_length_max": 999.0, "episode_reward_mean": 10.57265392531923, "episode_reward_min": 2.2557562665879147, "episode_reward_max": 19.277214023690938, "num_neighbours_mean": 0.20353686431138307, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 30.92038471647047, "environment_reward_total_min": 4.5115125331758295, "environment_reward_total_max": 58.52174819608146}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236, 18.23501354592249, 13.33325609668692, 6.935479801018442, 17.16614418481819, 18.067523481298345, 2.6954298697616377, 11.781386133010816, 0.6839377686500008, 26.297761820880662, 28.766281620541164, 23.343774013451306, -15.488487466824171, 0.897013171905634, 37.941302895314664, 24.414776307723375, 22.373284272793352, 25.618118789566694, -9.127294187421432, 34.804267243389674], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542, 1213, 1809, 1733, 1000, 1000, 1267, 1117, 1539, 1000, 1000, 1000, 156, 746, 1492, 1884, 1000, 1000, 716, 1000], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853, -6.660251282774001, 12.91050315568116, 11.984761673015342, -4.994833021592723, 11.279824438188427, -3.6587820114353233, 10.70704669152651, -7.283873030490177, 9.38039162970067, -6.271561439661893, 11.110522641469858, 8.437247012705916, 8.728897172112251, 8.252004543879714, 9.815518937418636, 11.31551583114322, -4.295583177315908, -4.324502784065705, 9.497297364748194, -8.649120273257797, 10.933209041520417, 8.00668118550423, -5.192834847381596, -2.1299085694726356, 13.875389906288977, 12.422371914591638, 14.971830334114072, 13.794451286427158, 16.42294999819064, 6.920824015260627, -6.662695670093742, -8.825791796730428, 3.269437524578274, -2.372424352672648, 6.936094661805679, 22.94033648613103, 8.064871747377914, -8.238884349472102, 17.642727568887942, 4.099784811955448, 10.911148276352217, 10.033557856591916, 12.339726416201444, 9.777045476421103, 15.841073313145609, -4.051016771185636, 0.09927974902510783, -5.175557165260891, 12.09224119228355, 22.712026051106108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3903570809563387, "mean_inference_ms": 0.5983172342124657, "mean_action_processing_ms": 0.19377408466922247, "mean_env_wait_ms": 1.256472305892823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004305010256559953, "StateBufferConnector_ms": 0.0033803608106530232, "ViewRequirementAgentConnector_ms": 0.09533477866131326}}, "episode_reward_max": 37.941302895314664, "episode_reward_min": -15.488487466824171, "episode_reward_mean": 5.7467181201142985, "episode_len_mean": 1294.5869565217392, "episodes_this_iter": 2, "policy_reward_min": {"default": -8.825791796730428}, "policy_reward_max": {"default": 22.94033648613103}, "policy_reward_mean": {"default": 5.7467181201142985}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236, 18.23501354592249, 13.33325609668692, 6.935479801018442, 17.16614418481819, 18.067523481298345, 2.6954298697616377, 11.781386133010816, 0.6839377686500008, 26.297761820880662, 28.766281620541164, 23.343774013451306, -15.488487466824171, 0.897013171905634, 37.941302895314664, 24.414776307723375, 22.373284272793352, 25.618118789566694, -9.127294187421432, 34.804267243389674], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542, 1213, 1809, 1733, 1000, 1000, 1267, 1117, 1539, 1000, 1000, 1000, 156, 746, 1492, 1884, 1000, 1000, 716, 1000], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853, -6.660251282774001, 12.91050315568116, 11.984761673015342, -4.994833021592723, 11.279824438188427, -3.6587820114353233, 10.70704669152651, -7.283873030490177, 9.38039162970067, -6.271561439661893, 11.110522641469858, 8.437247012705916, 8.728897172112251, 8.252004543879714, 9.815518937418636, 11.31551583114322, -4.295583177315908, -4.324502784065705, 9.497297364748194, -8.649120273257797, 10.933209041520417, 8.00668118550423, -5.192834847381596, -2.1299085694726356, 13.875389906288977, 12.422371914591638, 14.971830334114072, 13.794451286427158, 16.42294999819064, 6.920824015260627, -6.662695670093742, -8.825791796730428, 3.269437524578274, -2.372424352672648, 6.936094661805679, 22.94033648613103, 8.064871747377914, -8.238884349472102, 17.642727568887942, 4.099784811955448, 10.911148276352217, 10.033557856591916, 12.339726416201444, 9.777045476421103, 15.841073313145609, -4.051016771185636, 0.09927974902510783, -5.175557165260891, 12.09224119228355, 22.712026051106108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3903570809563387, "mean_inference_ms": 0.5983172342124657, "mean_action_processing_ms": 0.19377408466922247, "mean_env_wait_ms": 1.256472305892823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004305010256559953, "StateBufferConnector_ms": 0.0033803608106530232, "ViewRequirementAgentConnector_ms": 0.09533477866131326}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 137251, "num_agent_steps_trained": 137251, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 357.88294389861915, "num_env_steps_trained_throughput_per_sec": 357.88294389861915, "timesteps_total": 60000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 137251, "timers": {"training_iteration_time_ms": 5215.834, "sample_time_ms": 4960.926, "load_time_ms": 3.668, "load_throughput": 545206.908, "learn_time_ms": 249.484, "learn_throughput": 8016.555, "synch_weights_time_ms": 1.408}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 137251, "num_agent_steps_trained": 137251}, "done": false, "episodes_total": 46, "training_iteration": 30, "trial_id": "3f391_00000", "date": "2023-12-26_23-23-04", "timestamp": 1703604184, "time_this_iter_s": 5.595776319503784, "time_total_s": 160.4516978263855, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 160.4516978263855, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 15.175, "ram_util_percent": 60.1}, "success": 0.0, "crash": 0.03623188405797101, "out": 0.3706521739130434, "max_step": 0.5931159420289854, "length": 1294.5869565217392, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 17.240154360342896}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.035460992907801414, "crash_rate_min": 0.0, "crash_rate_max": 1.0, "out_of_road_rate_mean": 0.3787234042553191, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 1.0, "max_step_rate_mean": 0.5858156028368794, "max_step_rate_min": 0.0, "max_step_rate_max": 1.0, "velocity_mean": 0.233870084583799, "velocity_min": 0.1931768426294123, "velocity_max": 0.31834091771364775, "steering_mean": 0.015253939984308488, "steering_min": -0.09470507073235679, "steering_max": 0.1239347741446423, "step_reward_mean": 0.013668763875369656, "step_reward_min": 0.00823634063339666, "step_reward_max": 0.023470633957415905, "acceleration_mean": -0.02127595974190206, "acceleration_min": -0.15862792446925952, "acceleration_max": 0.1347554800669094, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 783.8514184397162, "episode_length_min": 155.0, "episode_length_max": 999.0, "episode_reward_mean": 10.611501657992203, "episode_reward_min": 2.2557562665879147, "episode_reward_max": 19.277214023690938, "num_neighbours_mean": 0.1992062927302898, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.021276595744681, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 31.31769545534974, "environment_reward_total_min": 4.5115125331758295, "environment_reward_total_max": 58.52174819608146}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.106787109375, "cur_lr": 0.0003, "total_loss": 3.2293390691280366, "policy_loss": 0.012270846590399741, "vf_loss": 3.2161180317401885, "vf_explained_var": -0.011154347658157348, "kl": 0.008898415107978508, "entropy": 3.0506546914577486, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1280.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 62000, "num_env_steps_trained": 62000, "num_agent_steps_sampled": 141609, "num_agent_steps_trained": 141609}, "sampler_results": {"episode_reward_max": 37.941302895314664, "episode_reward_min": -15.488487466824171, "episode_reward_mean": 17.29061075533943, "episode_len_mean": 1306.2978723404256, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -8.825791796730428}, "policy_reward_max": {"default": 22.94033648613103}, "policy_reward_mean": {"default": 5.7229486302884025}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.035460992907801414, "crash_rate_min": 0.0, "crash_rate_max": 1.0, "out_of_road_rate_mean": 0.3787234042553191, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 1.0, "max_step_rate_mean": 0.5858156028368794, "max_step_rate_min": 0.0, "max_step_rate_max": 1.0, "velocity_mean": 0.233870084583799, "velocity_min": 0.1931768426294123, "velocity_max": 0.31834091771364775, "steering_mean": 0.015253939984308488, "steering_min": -0.09470507073235679, "steering_max": 0.1239347741446423, "step_reward_mean": 0.013668763875369656, "step_reward_min": 0.00823634063339666, "step_reward_max": 0.023470633957415905, "acceleration_mean": -0.02127595974190206, "acceleration_min": -0.15862792446925952, "acceleration_max": 0.1347554800669094, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 783.8514184397162, "episode_length_min": 155.0, "episode_length_max": 999.0, "episode_reward_mean": 10.611501657992203, "episode_reward_min": 2.2557562665879147, "episode_reward_max": 19.277214023690938, "num_neighbours_mean": 0.1992062927302898, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.021276595744681, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 31.31769545534974, "environment_reward_total_min": 4.5115125331758295, "environment_reward_total_max": 58.52174819608146}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236, 18.23501354592249, 13.33325609668692, 6.935479801018442, 17.16614418481819, 18.067523481298345, 2.6954298697616377, 11.781386133010816, 0.6839377686500008, 26.297761820880662, 28.766281620541164, 23.343774013451306, -15.488487466824171, 0.897013171905634, 37.941302895314664, 24.414776307723375, 22.373284272793352, 25.618118789566694, -9.127294187421432, 34.804267243389674, 19.61160492517992], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542, 1213, 1809, 1733, 1000, 1000, 1267, 1117, 1539, 1000, 1000, 1000, 156, 746, 1492, 1884, 1000, 1000, 716, 1000, 1845], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853, -6.660251282774001, 12.91050315568116, 11.984761673015342, -4.994833021592723, 11.279824438188427, -3.6587820114353233, 10.70704669152651, -7.283873030490177, 9.38039162970067, -6.271561439661893, 11.110522641469858, 8.437247012705916, 8.728897172112251, 8.252004543879714, 9.815518937418636, 11.31551583114322, -4.295583177315908, -4.324502784065705, 9.497297364748194, -8.649120273257797, 10.933209041520417, 8.00668118550423, -5.192834847381596, -2.1299085694726356, 13.875389906288977, 12.422371914591638, 14.971830334114072, 13.794451286427158, 16.42294999819064, 6.920824015260627, -6.662695670093742, -8.825791796730428, 3.269437524578274, -2.372424352672648, 6.936094661805679, 22.94033648613103, 8.064871747377914, -8.238884349472102, 17.642727568887942, 4.099784811955448, 10.911148276352217, 10.033557856591916, 12.339726416201444, 9.777045476421103, 15.841073313145609, -4.051016771185636, 0.09927974902510783, -5.175557165260891, 12.09224119228355, 22.712026051106108, 1.0597905214738628, 20.187805508633474, -4.628336474582635, 2.992345369655254]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.390321959801003, "mean_inference_ms": 0.5982563044894129, "mean_action_processing_ms": 0.19374552295314124, "mean_env_wait_ms": 1.2564884330235646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00428493986738489, "StateBufferConnector_ms": 0.0033708328896380484, "ViewRequirementAgentConnector_ms": 0.09481247435224817}}, "episode_reward_max": 37.941302895314664, "episode_reward_min": -15.488487466824171, "episode_reward_mean": 5.7229486302884025, "episode_len_mean": 1306.2978723404256, "episodes_this_iter": 1, "policy_reward_min": {"default": -8.825791796730428}, "policy_reward_max": {"default": 22.94033648613103}, "policy_reward_mean": {"default": 5.7229486302884025}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236, 18.23501354592249, 13.33325609668692, 6.935479801018442, 17.16614418481819, 18.067523481298345, 2.6954298697616377, 11.781386133010816, 0.6839377686500008, 26.297761820880662, 28.766281620541164, 23.343774013451306, -15.488487466824171, 0.897013171905634, 37.941302895314664, 24.414776307723375, 22.373284272793352, 25.618118789566694, -9.127294187421432, 34.804267243389674, 19.61160492517992], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542, 1213, 1809, 1733, 1000, 1000, 1267, 1117, 1539, 1000, 1000, 1000, 156, 746, 1492, 1884, 1000, 1000, 716, 1000, 1845], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853, -6.660251282774001, 12.91050315568116, 11.984761673015342, -4.994833021592723, 11.279824438188427, -3.6587820114353233, 10.70704669152651, -7.283873030490177, 9.38039162970067, -6.271561439661893, 11.110522641469858, 8.437247012705916, 8.728897172112251, 8.252004543879714, 9.815518937418636, 11.31551583114322, -4.295583177315908, -4.324502784065705, 9.497297364748194, -8.649120273257797, 10.933209041520417, 8.00668118550423, -5.192834847381596, -2.1299085694726356, 13.875389906288977, 12.422371914591638, 14.971830334114072, 13.794451286427158, 16.42294999819064, 6.920824015260627, -6.662695670093742, -8.825791796730428, 3.269437524578274, -2.372424352672648, 6.936094661805679, 22.94033648613103, 8.064871747377914, -8.238884349472102, 17.642727568887942, 4.099784811955448, 10.911148276352217, 10.033557856591916, 12.339726416201444, 9.777045476421103, 15.841073313145609, -4.051016771185636, 0.09927974902510783, -5.175557165260891, 12.09224119228355, 22.712026051106108, 1.0597905214738628, 20.187805508633474, -4.628336474582635, 2.992345369655254]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.390321959801003, "mean_inference_ms": 0.5982563044894129, "mean_action_processing_ms": 0.19374552295314124, "mean_env_wait_ms": 1.2564884330235646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00428493986738489, "StateBufferConnector_ms": 0.0033708328896380484, "ViewRequirementAgentConnector_ms": 0.09481247435224817}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 141609, "num_agent_steps_trained": 141609, "num_env_steps_sampled": 62000, "num_env_steps_trained": 62000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 417.7707014458311, "num_env_steps_trained_throughput_per_sec": 417.7707014458311, "timesteps_total": 62000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 141609, "timers": {"training_iteration_time_ms": 5217.142, "sample_time_ms": 4965.814, "load_time_ms": 3.611, "load_throughput": 553937.505, "learn_time_ms": 245.952, "learn_throughput": 8131.668, "synch_weights_time_ms": 1.411}, "counters": {"num_env_steps_sampled": 62000, "num_env_steps_trained": 62000, "num_agent_steps_sampled": 141609, "num_agent_steps_trained": 141609}, "done": false, "episodes_total": 47, "training_iteration": 31, "trial_id": "3f391_00000", "date": "2023-12-26_23-23-09", "timestamp": 1703604189, "time_this_iter_s": 4.794951438903809, "time_total_s": 165.2466492652893, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 165.2466492652893, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 16.785714285714285, "ram_util_percent": 60.10000000000001}, "success": 0.0, "crash": 0.035460992907801414, "out": 0.3787234042553191, "max_step": 0.5858156028368794, "length": 1306.2978723404256, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 17.29061075533943}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.03472222222222222, "crash_rate_min": 0.0, "crash_rate_max": 1.0, "out_of_road_rate_mean": 0.38749999999999996, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 1.0, "max_step_rate_mean": 0.5777777777777778, "max_step_rate_min": 0.0, "max_step_rate_max": 1.0, "velocity_mean": 0.2338979499670307, "velocity_min": 0.1931768426294123, "velocity_max": 0.31834091771364775, "steering_mean": 0.013260484483344083, "steering_min": -0.09470507073235679, "steering_max": 0.1239347741446423, "step_reward_mean": 0.013654340537839519, "step_reward_min": 0.00823634063339666, "step_reward_max": 0.023470633957415905, "acceleration_mean": -0.02218693115801777, "acceleration_min": -0.15862792446925952, "acceleration_max": 0.1347554800669094, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 780.6170138888889, "episode_length_min": 155.0, "episode_length_max": 999.0, "episode_reward_mean": 10.560366050397118, "episode_reward_min": 2.2557562665879147, "episode_reward_max": 19.277214023690938, "num_neighbours_mean": 0.1950561616317421, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0625, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 31.51493018476205, "environment_reward_total_min": 4.5115125331758295, "environment_reward_total_max": 58.52174819608146}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10678710937500002, "cur_lr": 0.0003, "total_loss": 2.9342993990145625, "policy_loss": -0.023292394801974297, "vf_loss": 2.955969255566597, "vf_explained_var": -0.022312177419662474, "kl": 0.015194111543241889, "entropy": 2.9646817016601563, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1325.5, "diff_num_grad_updates_vs_sampler_policy": 24.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 146866, "num_agent_steps_trained": 146866}, "sampler_results": {"episode_reward_max": 37.941302895314664, "episode_reward_min": -15.488487466824171, "episode_reward_mean": 16.94666939295213, "episode_len_mean": 1318.6458333333333, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -8.825791796730428}, "policy_reward_max": {"default": 22.94033648613103}, "policy_reward_mean": {"default": 5.533606332392534}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.03472222222222222, "crash_rate_min": 0.0, "crash_rate_max": 1.0, "out_of_road_rate_mean": 0.38749999999999996, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 1.0, "max_step_rate_mean": 0.5777777777777778, "max_step_rate_min": 0.0, "max_step_rate_max": 1.0, "velocity_mean": 0.2338979499670307, "velocity_min": 0.1931768426294123, "velocity_max": 0.31834091771364775, "steering_mean": 0.013260484483344083, "steering_min": -0.09470507073235679, "steering_max": 0.1239347741446423, "step_reward_mean": 0.013654340537839519, "step_reward_min": 0.00823634063339666, "step_reward_max": 0.023470633957415905, "acceleration_mean": -0.02218693115801777, "acceleration_min": -0.15862792446925952, "acceleration_max": 0.1347554800669094, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 780.6170138888889, "episode_length_min": 155.0, "episode_length_max": 999.0, "episode_reward_mean": 10.560366050397118, "episode_reward_min": 2.2557562665879147, "episode_reward_max": 19.277214023690938, "num_neighbours_mean": 0.1950561616317421, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0625, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 31.51493018476205, "environment_reward_total_min": 4.5115125331758295, "environment_reward_total_max": 58.52174819608146}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236, 18.23501354592249, 13.33325609668692, 6.935479801018442, 17.16614418481819, 18.067523481298345, 2.6954298697616377, 11.781386133010816, 0.6839377686500008, 26.297761820880662, 28.766281620541164, 23.343774013451306, -15.488487466824171, 0.897013171905634, 37.941302895314664, 24.414776307723375, 22.373284272793352, 25.618118789566694, -9.127294187421432, 34.804267243389674, 19.61160492517992, 0.7814253607492159], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542, 1213, 1809, 1733, 1000, 1000, 1267, 1117, 1539, 1000, 1000, 1000, 156, 746, 1492, 1884, 1000, 1000, 716, 1000, 1845, 1899], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853, -6.660251282774001, 12.91050315568116, 11.984761673015342, -4.994833021592723, 11.279824438188427, -3.6587820114353233, 10.70704669152651, -7.283873030490177, 9.38039162970067, -6.271561439661893, 11.110522641469858, 8.437247012705916, 8.728897172112251, 8.252004543879714, 9.815518937418636, 11.31551583114322, -4.295583177315908, -4.324502784065705, 9.497297364748194, -8.649120273257797, 10.933209041520417, 8.00668118550423, -5.192834847381596, -2.1299085694726356, 13.875389906288977, 12.422371914591638, 14.971830334114072, 13.794451286427158, 16.42294999819064, 6.920824015260627, -6.662695670093742, -8.825791796730428, 3.269437524578274, -2.372424352672648, 6.936094661805679, 22.94033648613103, 8.064871747377914, -8.238884349472102, 17.642727568887942, 4.099784811955448, 10.911148276352217, 10.033557856591916, 12.339726416201444, 9.777045476421103, 15.841073313145609, -4.051016771185636, 0.09927974902510783, -5.175557165260891, 12.09224119228355, 22.712026051106108, 1.0597905214738628, 20.187805508633474, -4.628336474582635, 2.992345369655254, -6.381042560904422, -7.41345561756716, -4.7948605604355325, 8.826318203848814, 10.544465895807502]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39028577115841406, "mean_inference_ms": 0.5981910908737121, "mean_action_processing_ms": 0.1937150890929714, "mean_env_wait_ms": 1.2564692385656124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042820970217386884, "StateBufferConnector_ms": 0.003360708554585775, "ViewRequirementAgentConnector_ms": 0.09446392456690471}}, "episode_reward_max": 37.941302895314664, "episode_reward_min": -15.488487466824171, "episode_reward_mean": 5.533606332392534, "episode_len_mean": 1318.6458333333333, "episodes_this_iter": 1, "policy_reward_min": {"default": -8.825791796730428}, "policy_reward_max": {"default": 22.94033648613103}, "policy_reward_mean": {"default": 5.533606332392534}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236, 18.23501354592249, 13.33325609668692, 6.935479801018442, 17.16614418481819, 18.067523481298345, 2.6954298697616377, 11.781386133010816, 0.6839377686500008, 26.297761820880662, 28.766281620541164, 23.343774013451306, -15.488487466824171, 0.897013171905634, 37.941302895314664, 24.414776307723375, 22.373284272793352, 25.618118789566694, -9.127294187421432, 34.804267243389674, 19.61160492517992, 0.7814253607492159], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542, 1213, 1809, 1733, 1000, 1000, 1267, 1117, 1539, 1000, 1000, 1000, 156, 746, 1492, 1884, 1000, 1000, 716, 1000, 1845, 1899], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853, -6.660251282774001, 12.91050315568116, 11.984761673015342, -4.994833021592723, 11.279824438188427, -3.6587820114353233, 10.70704669152651, -7.283873030490177, 9.38039162970067, -6.271561439661893, 11.110522641469858, 8.437247012705916, 8.728897172112251, 8.252004543879714, 9.815518937418636, 11.31551583114322, -4.295583177315908, -4.324502784065705, 9.497297364748194, -8.649120273257797, 10.933209041520417, 8.00668118550423, -5.192834847381596, -2.1299085694726356, 13.875389906288977, 12.422371914591638, 14.971830334114072, 13.794451286427158, 16.42294999819064, 6.920824015260627, -6.662695670093742, -8.825791796730428, 3.269437524578274, -2.372424352672648, 6.936094661805679, 22.94033648613103, 8.064871747377914, -8.238884349472102, 17.642727568887942, 4.099784811955448, 10.911148276352217, 10.033557856591916, 12.339726416201444, 9.777045476421103, 15.841073313145609, -4.051016771185636, 0.09927974902510783, -5.175557165260891, 12.09224119228355, 22.712026051106108, 1.0597905214738628, 20.187805508633474, -4.628336474582635, 2.992345369655254, -6.381042560904422, -7.41345561756716, -4.7948605604355325, 8.826318203848814, 10.544465895807502]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39028577115841406, "mean_inference_ms": 0.5981910908737121, "mean_action_processing_ms": 0.1937150890929714, "mean_env_wait_ms": 1.2564692385656124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042820970217386884, "StateBufferConnector_ms": 0.003360708554585775, "ViewRequirementAgentConnector_ms": 0.09446392456690471}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 146866, "num_agent_steps_trained": 146866, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 384.60222619399724, "num_env_steps_trained_throughput_per_sec": 384.60222619399724, "timesteps_total": 64000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 146866, "timers": {"training_iteration_time_ms": 5241.048, "sample_time_ms": 4978.485, "load_time_ms": 3.629, "load_throughput": 551149.656, "learn_time_ms": 257.192, "learn_throughput": 7776.298, "synch_weights_time_ms": 1.391}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 146866, "num_agent_steps_trained": 146866}, "done": false, "episodes_total": 48, "training_iteration": 32, "trial_id": "3f391_00000", "date": "2023-12-26_23-23-14", "timestamp": 1703604194, "time_this_iter_s": 5.208435535430908, "time_total_s": 170.45508480072021, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 170.45508480072021, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 15.662499999999998, "ram_util_percent": 60.1}, "success": 0.0, "crash": 0.03472222222222222, "out": 0.38749999999999996, "max_step": 0.5777777777777778, "length": 1318.6458333333333, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 16.94666939295213}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.03401360544217687, "crash_rate_min": 0.0, "crash_rate_max": 1.0, "out_of_road_rate_mean": 0.3863945578231292, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 1.0, "max_step_rate_mean": 0.5795918367346939, "max_step_rate_min": 0.0, "max_step_rate_max": 1.0, "velocity_mean": 0.234185973625467, "velocity_min": 0.1931768426294123, "velocity_max": 0.31834091771364775, "steering_mean": 0.01141236648869337, "steering_min": -0.09470507073235679, "steering_max": 0.1239347741446423, "step_reward_mean": 0.01366803908486271, "step_reward_min": 0.00823634063339666, "step_reward_max": 0.023470633957415905, "acceleration_mean": -0.022189545619743848, "acceleration_min": -0.15862792446925952, "acceleration_max": 0.1347554800669094, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 782.7812925170068, "episode_length_min": 155.0, "episode_length_max": 999.0, "episode_reward_mean": 10.604072963992115, "episode_reward_min": 2.2557562665879147, "episode_reward_max": 19.277214023690938, "num_neighbours_mean": 0.19107542363925759, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.061224489795918, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 31.649442108535396, "environment_reward_total_min": 4.5115125331758295, "environment_reward_total_max": 58.52174819608146}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10678710937500004, "cur_lr": 0.0003, "total_loss": 1.7447175237867567, "policy_loss": -0.0049061292575465305, "vf_loss": 1.747985996140374, "vf_explained_var": -0.0020627498626708983, "kl": 0.015335638608990444, "entropy": 3.1681262652079263, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1373.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 66000, "num_env_steps_trained": 66000, "num_agent_steps_sampled": 151659, "num_agent_steps_trained": 151659}, "sampler_results": {"episode_reward_max": 37.941302895314664, "episode_reward_min": -15.488487466824171, "episode_reward_mean": 17.17429031116039, "episode_len_mean": 1326.1836734693877, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"default": -8.825791796730428}, "policy_reward_max": {"default": 22.94033648613103}, "policy_reward_mean": {"default": 5.610268168312396}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.03401360544217687, "crash_rate_min": 0.0, "crash_rate_max": 1.0, "out_of_road_rate_mean": 0.3863945578231292, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 1.0, "max_step_rate_mean": 0.5795918367346939, "max_step_rate_min": 0.0, "max_step_rate_max": 1.0, "velocity_mean": 0.234185973625467, "velocity_min": 0.1931768426294123, "velocity_max": 0.31834091771364775, "steering_mean": 0.01141236648869337, "steering_min": -0.09470507073235679, "steering_max": 0.1239347741446423, "step_reward_mean": 0.01366803908486271, "step_reward_min": 0.00823634063339666, "step_reward_max": 0.023470633957415905, "acceleration_mean": -0.022189545619743848, "acceleration_min": -0.15862792446925952, "acceleration_max": 0.1347554800669094, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 782.7812925170068, "episode_length_min": 155.0, "episode_length_max": 999.0, "episode_reward_mean": 10.604072963992115, "episode_reward_min": 2.2557562665879147, "episode_reward_max": 19.277214023690938, "num_neighbours_mean": 0.19107542363925759, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.061224489795918, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 31.649442108535396, "environment_reward_total_min": 4.5115125331758295, "environment_reward_total_max": 58.52174819608146}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236, 18.23501354592249, 13.33325609668692, 6.935479801018442, 17.16614418481819, 18.067523481298345, 2.6954298697616377, 11.781386133010816, 0.6839377686500008, 26.297761820880662, 28.766281620541164, 23.343774013451306, -15.488487466824171, 0.897013171905634, 37.941302895314664, 24.414776307723375, 22.373284272793352, 25.618118789566694, -9.127294187421432, 34.804267243389674, 19.61160492517992, 0.7814253607492159, 28.100094385156858], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542, 1213, 1809, 1733, 1000, 1000, 1267, 1117, 1539, 1000, 1000, 1000, 156, 746, 1492, 1884, 1000, 1000, 716, 1000, 1845, 1899, 1688], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853, -6.660251282774001, 12.91050315568116, 11.984761673015342, -4.994833021592723, 11.279824438188427, -3.6587820114353233, 10.70704669152651, -7.283873030490177, 9.38039162970067, -6.271561439661893, 11.110522641469858, 8.437247012705916, 8.728897172112251, 8.252004543879714, 9.815518937418636, 11.31551583114322, -4.295583177315908, -4.324502784065705, 9.497297364748194, -8.649120273257797, 10.933209041520417, 8.00668118550423, -5.192834847381596, -2.1299085694726356, 13.875389906288977, 12.422371914591638, 14.971830334114072, 13.794451286427158, 16.42294999819064, 6.920824015260627, -6.662695670093742, -8.825791796730428, 3.269437524578274, -2.372424352672648, 6.936094661805679, 22.94033648613103, 8.064871747377914, -8.238884349472102, 17.642727568887942, 4.099784811955448, 10.911148276352217, 10.033557856591916, 12.339726416201444, 9.777045476421103, 15.841073313145609, -4.051016771185636, 0.09927974902510783, -5.175557165260891, 12.09224119228355, 22.712026051106108, 1.0597905214738628, 20.187805508633474, -4.628336474582635, 2.992345369655254, -6.381042560904422, -7.41345561756716, -4.7948605604355325, 8.826318203848814, 10.544465895807502, 8.319509452684125, -0.2775785834376201, 20.05816351591032]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39023373644533804, "mean_inference_ms": 0.5981175162789285, "mean_action_processing_ms": 0.19367834032893472, "mean_env_wait_ms": 1.256388137451756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004262340312101403, "StateBufferConnector_ms": 0.0033509974576988997, "ViewRequirementAgentConnector_ms": 0.09400893230827487}}, "episode_reward_max": 37.941302895314664, "episode_reward_min": -15.488487466824171, "episode_reward_mean": 5.610268168312396, "episode_len_mean": 1326.1836734693877, "episodes_this_iter": 1, "policy_reward_min": {"default": -8.825791796730428}, "policy_reward_max": {"default": 22.94033648613103}, "policy_reward_mean": {"default": 5.610268168312396}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236, 18.23501354592249, 13.33325609668692, 6.935479801018442, 17.16614418481819, 18.067523481298345, 2.6954298697616377, 11.781386133010816, 0.6839377686500008, 26.297761820880662, 28.766281620541164, 23.343774013451306, -15.488487466824171, 0.897013171905634, 37.941302895314664, 24.414776307723375, 22.373284272793352, 25.618118789566694, -9.127294187421432, 34.804267243389674, 19.61160492517992, 0.7814253607492159, 28.100094385156858], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542, 1213, 1809, 1733, 1000, 1000, 1267, 1117, 1539, 1000, 1000, 1000, 156, 746, 1492, 1884, 1000, 1000, 716, 1000, 1845, 1899, 1688], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853, -6.660251282774001, 12.91050315568116, 11.984761673015342, -4.994833021592723, 11.279824438188427, -3.6587820114353233, 10.70704669152651, -7.283873030490177, 9.38039162970067, -6.271561439661893, 11.110522641469858, 8.437247012705916, 8.728897172112251, 8.252004543879714, 9.815518937418636, 11.31551583114322, -4.295583177315908, -4.324502784065705, 9.497297364748194, -8.649120273257797, 10.933209041520417, 8.00668118550423, -5.192834847381596, -2.1299085694726356, 13.875389906288977, 12.422371914591638, 14.971830334114072, 13.794451286427158, 16.42294999819064, 6.920824015260627, -6.662695670093742, -8.825791796730428, 3.269437524578274, -2.372424352672648, 6.936094661805679, 22.94033648613103, 8.064871747377914, -8.238884349472102, 17.642727568887942, 4.099784811955448, 10.911148276352217, 10.033557856591916, 12.339726416201444, 9.777045476421103, 15.841073313145609, -4.051016771185636, 0.09927974902510783, -5.175557165260891, 12.09224119228355, 22.712026051106108, 1.0597905214738628, 20.187805508633474, -4.628336474582635, 2.992345369655254, -6.381042560904422, -7.41345561756716, -4.7948605604355325, 8.826318203848814, 10.544465895807502, 8.319509452684125, -0.2775785834376201, 20.05816351591032]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39023373644533804, "mean_inference_ms": 0.5981175162789285, "mean_action_processing_ms": 0.19367834032893472, "mean_env_wait_ms": 1.256388137451756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004262340312101403, "StateBufferConnector_ms": 0.0033509974576988997, "ViewRequirementAgentConnector_ms": 0.09400893230827487}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 151659, "num_agent_steps_trained": 151659, "num_env_steps_sampled": 66000, "num_env_steps_trained": 66000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 401.7947639514293, "num_env_steps_trained_throughput_per_sec": 401.7947639514293, "timesteps_total": 66000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 151659, "timers": {"training_iteration_time_ms": 5217.017, "sample_time_ms": 4947.31, "load_time_ms": 3.661, "load_throughput": 546357.425, "learn_time_ms": 264.319, "learn_throughput": 7566.602, "synch_weights_time_ms": 1.382}, "counters": {"num_env_steps_sampled": 66000, "num_env_steps_trained": 66000, "num_agent_steps_sampled": 151659, "num_agent_steps_trained": 151659}, "done": false, "episodes_total": 49, "training_iteration": 33, "trial_id": "3f391_00000", "date": "2023-12-26_23-23-20", "timestamp": 1703604200, "time_this_iter_s": 4.985668182373047, "time_total_s": 175.44075298309326, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 175.44075298309326, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 16.085714285714285, "ram_util_percent": 60.10000000000001}, "success": 0.0, "crash": 0.03401360544217687, "out": 0.3863945578231292, "max_step": 0.5795918367346939, "length": 1326.1836734693877, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 17.17429031116039}
{"custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0326797385620915, "crash_rate_min": 0.0, "crash_rate_max": 1.0, "out_of_road_rate_mean": 0.3859477124183006, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 1.0, "max_step_rate_mean": 0.5813725490196079, "max_step_rate_min": 0.0, "max_step_rate_max": 1.0, "velocity_mean": 0.23398003483136948, "velocity_min": 0.1931768426294123, "velocity_max": 0.31834091771364775, "steering_mean": 0.007197001841271022, "steering_min": -0.10020804467859927, "steering_max": 0.1239347741446423, "step_reward_mean": 0.013628872561276465, "step_reward_min": 0.00823634063339666, "step_reward_max": 0.023470633957415905, "acceleration_mean": -0.022579382434283517, "acceleration_min": -0.15862792446925952, "acceleration_max": 0.1347554800669094, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 783.1084967320261, "episode_length_min": 155.0, "episode_length_max": 999.0, "episode_reward_mean": 10.582716499646304, "episode_reward_min": 2.2557562665879147, "episode_reward_max": 19.277214023690938, "num_neighbours_mean": 0.2031901129083063, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0588235294117645, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 31.483030717891644, "environment_reward_total_min": 4.5115125331758295, "environment_reward_total_max": 58.52174819608146}, "episode_media": {}, "info": {"learner": {"default": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.106787109375, "cur_lr": 0.0003, "total_loss": 0.9131819548085331, "policy_loss": -0.0002649463713169098, "vf_loss": 0.9123758573783561, "vf_explained_var": 0.041453251242637636, "kl": 0.010029673750977963, "entropy": 2.9751907706260683, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1415.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 156143, "num_agent_steps_trained": 156143}, "sampler_results": {"episode_reward_max": 37.941302895314664, "episode_reward_min": -15.488487466824171, "episode_reward_mean": 16.987720685276557, "episode_len_mean": 1317.921568627451, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"default": -8.825791796730428}, "policy_reward_max": {"default": 22.94033648613103}, "policy_reward_mean": {"default": 5.553677916340415}, "custom_metrics": {"track_length_mean": -1.0, "track_length_min": -1.0, "track_length_max": -1.0, "current_distance_mean": -1.0, "current_distance_min": -1.0, "current_distance_max": -1.0, "route_completion_mean": -1.0, "route_completion_min": -1.0, "route_completion_max": -1.0, "success_rate_mean": 0.0, "success_rate_min": 0.0, "success_rate_max": 0.0, "crash_rate_mean": 0.0326797385620915, "crash_rate_min": 0.0, "crash_rate_max": 1.0, "out_of_road_rate_mean": 0.3859477124183006, "out_of_road_rate_min": 0.0, "out_of_road_rate_max": 1.0, "max_step_rate_mean": 0.5813725490196079, "max_step_rate_min": 0.0, "max_step_rate_max": 1.0, "velocity_mean": 0.23398003483136948, "velocity_min": 0.1931768426294123, "velocity_max": 0.31834091771364775, "steering_mean": 0.007197001841271022, "steering_min": -0.10020804467859927, "steering_max": 0.1239347741446423, "step_reward_mean": 0.013628872561276465, "step_reward_min": 0.00823634063339666, "step_reward_max": 0.023470633957415905, "acceleration_mean": -0.022579382434283517, "acceleration_min": -0.15862792446925952, "acceleration_max": 0.1347554800669094, "cost_mean": 0.0, "cost_min": 0.0, "cost_max": 0.0, "episode_length_mean": 783.1084967320261, "episode_length_min": 155.0, "episode_length_max": 999.0, "episode_reward_mean": 10.582716499646304, "episode_reward_min": 2.2557562665879147, "episode_reward_max": 19.277214023690938, "num_neighbours_mean": 0.2031901129083063, "num_neighbours_min": 0.0, "num_neighbours_max": 1.0, "episode_cost_mean": 0.0, "episode_cost_min": 0.0, "episode_cost_max": 0.0, "episode_cost_worst_agent_mean": 0.0, "episode_cost_worst_agent_min": 0, "episode_cost_worst_agent_max": 0, "episode_cost_best_agent_mean": 0.0, "episode_cost_best_agent_min": 0, "episode_cost_best_agent_max": 0, "environment_cost_total_mean": 0.0, "environment_cost_total_min": 0, "environment_cost_total_max": 0, "num_active_agents_mean": 3.0588235294117645, "num_active_agents_min": 2, "num_active_agents_max": 6, "environment_reward_total_mean": 31.483030717891644, "environment_reward_total_min": 4.5115125331758295, "environment_reward_total_max": 58.52174819608146}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236, 18.23501354592249, 13.33325609668692, 6.935479801018442, 17.16614418481819, 18.067523481298345, 2.6954298697616377, 11.781386133010816, 0.6839377686500008, 26.297761820880662, 28.766281620541164, 23.343774013451306, -15.488487466824171, 0.897013171905634, 37.941302895314664, 24.414776307723375, 22.373284272793352, 25.618118789566694, -9.127294187421432, 34.804267243389674, 19.61160492517992, 0.7814253607492159, 28.100094385156858, -0.8270607732922777, 25.660590475537525], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542, 1213, 1809, 1733, 1000, 1000, 1267, 1117, 1539, 1000, 1000, 1000, 156, 746, 1492, 1884, 1000, 1000, 716, 1000, 1845, 1899, 1688, 1231, 1000], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853, -6.660251282774001, 12.91050315568116, 11.984761673015342, -4.994833021592723, 11.279824438188427, -3.6587820114353233, 10.70704669152651, -7.283873030490177, 9.38039162970067, -6.271561439661893, 11.110522641469858, 8.437247012705916, 8.728897172112251, 8.252004543879714, 9.815518937418636, 11.31551583114322, -4.295583177315908, -4.324502784065705, 9.497297364748194, -8.649120273257797, 10.933209041520417, 8.00668118550423, -5.192834847381596, -2.1299085694726356, 13.875389906288977, 12.422371914591638, 14.971830334114072, 13.794451286427158, 16.42294999819064, 6.920824015260627, -6.662695670093742, -8.825791796730428, 3.269437524578274, -2.372424352672648, 6.936094661805679, 22.94033648613103, 8.064871747377914, -8.238884349472102, 17.642727568887942, 4.099784811955448, 10.911148276352217, 10.033557856591916, 12.339726416201444, 9.777045476421103, 15.841073313145609, -4.051016771185636, 0.09927974902510783, -5.175557165260891, 12.09224119228355, 22.712026051106108, 1.0597905214738628, 20.187805508633474, -4.628336474582635, 2.992345369655254, -6.381042560904422, -7.41345561756716, -4.7948605604355325, 8.826318203848814, 10.544465895807502, 8.319509452684125, -0.2775785834376201, 20.05816351591032, 4.421195780477655, -6.878629754234937, 8.383036877378835, -6.7526636769138335, 10.297345769625878, 15.363244705911697]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3901966462048641, "mean_inference_ms": 0.5980774898152709, "mean_action_processing_ms": 0.19365090949239352, "mean_env_wait_ms": 1.2566089534740263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004263017691817938, "StateBufferConnector_ms": 0.0033560921164119944, "ViewRequirementAgentConnector_ms": 0.0944689208385991}}, "episode_reward_max": 37.941302895314664, "episode_reward_min": -15.488487466824171, "episode_reward_mean": 5.553677916340415, "episode_len_mean": 1317.921568627451, "episodes_this_iter": 2, "policy_reward_min": {"default": -8.825791796730428}, "policy_reward_max": {"default": 22.94033648613103}, "policy_reward_mean": {"default": 5.553677916340415}, "hist_stats": {"episode_reward": [26.380314769721366, 11.259232501383961, 9.442897069674476, 15.872372321721155, 17.470958981881118, 14.259135731725879, 20.938435663001183, 23.204356976460094, 20.616628360273143, 13.594741395760819, 22.532585347237074, 24.297635189409863, 27.56203973161316, 13.839929152315708, 17.484008795969718, 28.81252676068306, 21.500988468065668, 30.018049864673408, 18.799471803220136, 28.517408462499255, 18.02744344598808, -3.8213334200070115, 9.264955826591454, 31.900555185665503, 0.8211661630162831, 13.075945347402557, 28.635681317338236, 18.23501354592249, 13.33325609668692, 6.935479801018442, 17.16614418481819, 18.067523481298345, 2.6954298697616377, 11.781386133010816, 0.6839377686500008, 26.297761820880662, 28.766281620541164, 23.343774013451306, -15.488487466824171, 0.897013171905634, 37.941302895314664, 24.414776307723375, 22.373284272793352, 25.618118789566694, -9.127294187421432, 34.804267243389674, 19.61160492517992, 0.7814253607492159, 28.100094385156858, -0.8270607732922777, 25.660590475537525], "episode_lengths": [1000, 1514, 1173, 1291, 1236, 1592, 1000, 1566, 1615, 1809, 1394, 1271, 1614, 1188, 1589, 1000, 1315, 1000, 1259, 1969, 1811, 1000, 1550, 1818, 1396, 1367, 1542, 1213, 1809, 1733, 1000, 1000, 1267, 1117, 1539, 1000, 1000, 1000, 156, 746, 1492, 1884, 1000, 1000, 716, 1000, 1845, 1899, 1688, 1231, 1000], "policy_default_reward": [14.212589162106731, 12.167725607614678, -5.616990260934378, 12.590860608329509, -7.696558404176836, 11.981920558165685, -5.657836566882515, 13.291352662157326, 1.8093809743996232, 11.882222823822119, -5.323198439494271, 9.313347937393303, -7.038527070827888, 11.402860260600171, 13.106625792108844, -3.5321048415421528, -7.023012002607235, 14.049464969747323, 10.764787606127937, 9.606782216434832, 11.331653446566312, -3.692121789918458, 12.452473872711495, 14.44400489366709, -1.9665855225367075, 11.706939919379797, 10.876273963430119, -6.5114617857796935, 11.175510525511031, -4.839353473332397, 13.770046129361873, 15.95668745966219, -5.698094480028019, 12.273992367602881, -6.371132646078132, 12.97582584345162, 17.692941992036356, -2.5952951147485894, 14.5805176226973, 15.576817223664436, 14.651589222268866, 6.1638494691053225, -6.975509539058436, -1.7781916159921156, 5.932515329271952, 13.329685082689815, 13.963716142066108, 14.84881061861691, -6.061719828130944, 12.978380988347206, 14.58432730784942, 11.80992042149963, 18.20812944317377, -6.608522007250885, 11.82932707888049, 13.578666731590546, -3.901038813543291, 10.308356110395344, 0.09741556327053047, 22.01267560237666, -8.288700573004, 2.75257662927509, -6.279286627640143, 14.289620118071067, -6.110305525584888, 21.663539424870972, -7.130161873742999, 12.570983081992887, -6.771114111032056, -2.491040517224853, 1.022169474264203, -5.834816788287217, 13.522201609271313, 0.5554015313431613, 16.065474241657206, 2.4690528302734602, 13.366028113734934, -4.603655573886537, -4.143749307897225, 19.120102822378218, -7.139409419171384, -2.4121223584067426, -5.060595959319625, 5.57648579847284, 12.560055508249329, -1.2547341259564284, 16.973767275134822, 12.916648168159853, -6.660251282774001, 12.91050315568116, 11.984761673015342, -4.994833021592723, 11.279824438188427, -3.6587820114353233, 10.70704669152651, -7.283873030490177, 9.38039162970067, -6.271561439661893, 11.110522641469858, 8.437247012705916, 8.728897172112251, 8.252004543879714, 9.815518937418636, 11.31551583114322, -4.295583177315908, -4.324502784065705, 9.497297364748194, -8.649120273257797, 10.933209041520417, 8.00668118550423, -5.192834847381596, -2.1299085694726356, 13.875389906288977, 12.422371914591638, 14.971830334114072, 13.794451286427158, 16.42294999819064, 6.920824015260627, -6.662695670093742, -8.825791796730428, 3.269437524578274, -2.372424352672648, 6.936094661805679, 22.94033648613103, 8.064871747377914, -8.238884349472102, 17.642727568887942, 4.099784811955448, 10.911148276352217, 10.033557856591916, 12.339726416201444, 9.777045476421103, 15.841073313145609, -4.051016771185636, 0.09927974902510783, -5.175557165260891, 12.09224119228355, 22.712026051106108, 1.0597905214738628, 20.187805508633474, -4.628336474582635, 2.992345369655254, -6.381042560904422, -7.41345561756716, -4.7948605604355325, 8.826318203848814, 10.544465895807502, 8.319509452684125, -0.2775785834376201, 20.05816351591032, 4.421195780477655, -6.878629754234937, 8.383036877378835, -6.7526636769138335, 10.297345769625878, 15.363244705911697]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3901966462048641, "mean_inference_ms": 0.5980774898152709, "mean_action_processing_ms": 0.19365090949239352, "mean_env_wait_ms": 1.2566089534740263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004263017691817938, "StateBufferConnector_ms": 0.0033560921164119944, "ViewRequirementAgentConnector_ms": 0.0944689208385991}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156143, "num_agent_steps_trained": 156143, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 311.60738828934444, "num_env_steps_trained_throughput_per_sec": 311.60738828934444, "timesteps_total": 68000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 156143, "timers": {"training_iteration_time_ms": 5337.486, "sample_time_ms": 5059.522, "load_time_ms": 3.719, "load_throughput": 537814.023, "learn_time_ms": 272.518, "learn_throughput": 7338.953, "synch_weights_time_ms": 1.378}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 156143, "num_agent_steps_trained": 156143}, "done": false, "episodes_total": 51, "training_iteration": 34, "trial_id": "3f391_00000", "date": "2023-12-26_23-23-26", "timestamp": 1703604206, "time_this_iter_s": 6.426721096038818, "time_total_s": 181.86747407913208, "pid": 70489, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.117.73", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "MultiAgentIntersectionEnv", "env_config": {"num_agents": 2}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "cc_model", "custom_model_config": {"fuse_mode": "mf", "counterfactual": true, "num_neighbours": 4}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping at 0x7f3b12ac8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 100, "vf_share_layers": -1, "old_value_loss": true, "counterfactual": true, "num_neighbours": 4, "fuse_mode": "mf", "mf_nei_distance": 10, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default": [null, "Box(-0.0, 1.0, (91,), float32)", "Box(-1.0, 1.0, (2,), float32)", {}]}, "callbacks": "<class 'marlray.utils.callbacks.MultiAgentDrivingCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 181.86747407913208, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 25.822222222222223, "ram_util_percent": 60.166666666666664}, "success": 0.0, "crash": 0.0326797385620915, "out": 0.3859477124183006, "max_step": 0.5813725490196079, "length": 1317.921568627451, "rc": -1.0, "cost": 0.0, "raw_episode_reward_mean": 16.987720685276557}
